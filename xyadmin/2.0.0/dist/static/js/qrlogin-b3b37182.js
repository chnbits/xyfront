import{_ as e}from"./_plugin-vue_export-helper-1b428a4d.js";const t={props:{apiSeed:{type:String,default:"/v1/qrlogin/qrlogin/getSeed"},qrurlPrefix:{type:String,default:""},qrloginShow:!1},data:()=>({seed:"",qrurl:"",timer:null,timeout:!1}),created:function(){this.loadData()},watch:{qrloginShow(e){e?this.qrurl&&(this.timer=setInterval(this.getLogin,2e3)):clearInterval(this.timer)}},beforeDestroy(){clearInterval(this.timer)},methods:{async loadData(){let e=await this.$xyutil.request({url:this.apiSeed,data:{qrurlPrefix:this.qrurlPrefix},method:"get"});200==e.code?(this.seed=e.data.seed,this.qrurl=e.data.qrurl,this.timeout=!1,clearInterval(this.timer),this.timer=setInterval(this.getLogin,2e3)):this.$xyutil.showToast({title:e.msg,icon:"loading",duration:3e3})},async getLogin(){let e=await this.$xyutil.request({url:"/v1/qrlogin/qrlogin/getLogin?seed="+this.seed,method:"get"});200==e.code&&(e.data.timeout?(this.timeout=!0,clearInterval(this.timer)):(clearInterval(this.timer),this.$store.commit("user/setToken",e.data.token),this.$store.commit("user/setUserInfo",e.data.userInfo),this.$xyutil.showToast({title:e.msg,icon:"success",duration:2e3}),this.$xyutil.switchTab({url:"/"})))}}},i=window.Vue.resolveComponent,o=window.Vue.normalizeStyle,r=window.Vue.openBlock,s=window.Vue.createBlock,a=window.Vue.createCommentVNode,l=window.Vue.createElementBlock,n=window.Vue.createElementVNode;window.Vue.pushScopeId,window.Vue.popScopeId;const u={key:1,class:"xyicon xyicon-history"};const d=e(t,[["render",function(e,t,d,c,h,m){const w=i("xy-qrcode");return r(),l("div",{class:"qr-box",onClick:t[0]||(t[0]=(...e)=>m.loadData&&m.loadData(...e))},[n("div",null,[h.qrurl?(r(),s(w,{key:0,class:"qrcode",style:o({opacity:h.timeout?.3:1}),value:h.qrurl,options:{width:258}},null,8,["style","value"])):a("",!0),h.timeout?(r(),l("span",u)):a("",!0)])])}],["__scopeId","data-v-ef0c7c13"]]);export{d as default};
