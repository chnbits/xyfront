(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7f202548"],{"1b4e":function(t,e,a){},"985e":function(t,e,a){"use strict";var n=a("1b4e"),r=a.n(n);r.a},bea2:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"xy-builder-comp xy-builder-wrap-col"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"col-box"},[a("el-row",{attrs:{gutter:25}},[a("el-col",{staticClass:"left",attrs:{xs:24,sm:24,md:6,lg:5}},[a("el-tree",{staticClass:"m-b-md",attrs:{data:t.colData.dataList,"node-key":"id","default-expand-all":"","highlight-current":"",draggable:"","expand-on-click-node":!1},on:{"node-drop":t.handleDrop},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.node,r=e.data;return a("div",{staticClass:"custom-tree-node flex flex-1 flex-alignCenter"},[a("div",{staticClass:"flex-1 ts-14 tw5",on:{click:function(e){return t.edit(n,r)}}},[t._v(" "+t._s(r.title)+" ")]),a("div",{staticClass:"actions ts-13"},[a("el-link",{staticClass:"m-r-xs",attrs:{type:"text"},on:{click:function(){return t.append(n,r)}}},[t._v(" 添加子项 ")]),a("el-link",{attrs:{type:"danger"},on:{click:function(){return t.remove(n,r)}}},[t._v(" 删除 ")])],1)])}}])})],1),a("el-col",{staticClass:"right",attrs:{xs:24,sm:24,md:18,lg:19}},[a("XyBuilderForm",{ref:"rightForm",attrs:{api:t.currentEditApi,show:!0,header:t.header},on:{close:function(e){return t.closeModel(e)}}})],1)],1)],1)])},r=[],i=(a("c740"),a("4160"),a("a434"),a("b0c0"),a("d3b7"),a("159b"),a("5530")),o=a("b85c"),s=(a("96cf"),a("1da1")),u=a("4328"),c=a.n(u),d=a("6df9"),l={components:{"xy-title":d["a"]},name:"XyBuilderCol",props:{api:"",header:{type:Object,default:function(){return{cloudId:0,eid:0}}},pitem:{type:Object,default:function(){return{}}},show:!1,predata:""},data:function(){return{ready:!1,loading:!1,colData:{dataList:[]},currentEditApi:""}},watch:{show:function(t){this.stackData={},1==t&&this.loadData()}},beforeCreate:function(){this.$options.components.XyBuilderList=function(){return Promise.resolve().then(a.bind(null,"114b"))},this.$options.components.XyBuilderForm=function(){return Promise.resolve().then(a.bind(null,"4d99"))},this.$options.components.XyBuilderInfo=function(){return a.e("chunk-b045c552").then(a.bind(null,"5d93"))},this.$options.components.XyBuilderTab=function(){return a.e("chunk-2d0b32fa").then(a.bind(null,"26ff"))}},created:function(){this.predata?this.readyProcess(this.predata):this.loadData()},methods:{closeModel:function(){},handleDrop:function(t,e,a,n){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var i,o,s,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r.colData.rightButtonList.forEach((function(t){"edit"==t.name&&(i=t)})),o="",s=0,n.t0=a,n.next="inner"===n.t0?8:"before"===n.t0?10:"after"===n.t0?13:16;break;case 8:return o=e.data.uniqeId,n.abrupt("break",16);case 10:return o=e.data.puniqeId,s=e.data.sortnum-1,n.abrupt("break",16);case 13:return o=e.data.puniqeId,s=e.data.sortnum+1,n.abrupt("break",16);case 16:return n.next=18,r.util.request({url:i.pageData.api+"/"+t.data.id,method:"put",data:{puniqeId:o,sortnum:s},header:{CloudId:r.header.cloudId,Eid:r.header.eid}});case 18:u=n.sent,"200"==u.code?r.util.showToast({title:u.msg,icon:"success",duration:1e3}):r.util.showToast({title:u.msg,icon:"error",duration:3e3});case 20:case"end":return n.stop()}}),n)})))()},edit:function(t,e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=a,a.colData.rightButtonList.forEach((function(t){if("edit"==t.name){var a=t,r="",i=new Object;if(a.pageData.apiSuffix){var s,u=a.pageData.apiSuffix,d=Object(o["a"])(u);try{for(d.s();!(s=d.n()).done;){var l=s.value;r=r+"/"+e[l]}}catch(m){d.e(m)}finally{d.f()}}else r="/"+e.id;if(a.pageData.querySuffix){var f,p=a.pageData.querySuffix,h=Object(o["a"])(p);try{for(h.s();!(f=h.n()).done;){var g=f.value;1==g[2]?i[g[0]]=g[1]:i[g[0]]=e[g[1]]}}catch(m){h.e(m)}finally{h.f()}}if(""!=c.a.stringify(i)?n.currentEditApi=a.pageData.api+r+"?"+c.a.stringify(i):n.currentEditApi=a.pageData.api+r,!n.currentEditApi)return!1;n.$refs.rightForm.loadData()}}));case 2:case"end":return t.stop()}}),t)})))()},append:function(t,e){var a=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n="",a.colData.rightButtonList.forEach((function(t){"addChild"==t.name&&(n=t.pageData.api)})),n){t.next=4;break}return t.abrupt("return",!1);case 4:a.$prompt("请输入标题","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=r.value,t.next=3,a.util.request({url:n,method:"post",data:{bookId:e.bookId,puniqeId:e.uniqeId,title:i},header:{CloudId:a.header.cloudId,Eid:a.header.eid}});case 3:o=t.sent,"200"==o.code?(a.util.showToast({title:o.msg,icon:"success",duration:1e3}),e.children||a.$set(e,"children",[]),e.children.push(o.data.info)):a.util.showToast({title:o.msg,icon:"error",duration:3e3});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){a.$message({type:"info",message:"取消输入"})}));case 5:case"end":return t.stop()}}),t)})))()},remove:function(t,e){var a=this,n=this,r="";if(this.colData.rightButtonList.forEach((function(t){"delete"==t.name&&(r=t)})),!r.pageData.api)return!1;var i="",u=new Object;if(r.pageData.apiSuffix){var d,l=r.pageData.apiSuffix,f=Object(o["a"])(l);try{for(f.s();!(d=f.n()).done;){var p=d.value;i=i+"/"+e[p]}}catch(b){f.e(b)}finally{f.f()}}else i="/"+e.id;if(r.pageData.querySuffix){var h,g=r.pageData.querySuffix,m=Object(o["a"])(g);try{for(m.s();!(h=m.n()).done;){var v=h.value;1==v[2]?u[v[0]]=v[1]:u[v[0]]=e[v[1]]}}catch(b){m.e(b)}finally{m.f()}}this.$confirm(r.pageData.content,r.pageData.title,{confirmButtonText:r.pageData.okText,cancelButtonText:r.pageData.cancelText,dangerouslyUseHTMLString:!0,type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function o(){var s,d,l,f,p,h;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return s=r.pageData.api+i,""!=c.a.stringify(u)&&(s=s+"?"+c.a.stringify(u)),o.next=4,n.util.request({url:s,method:r.pageData.formMethod,header:n.header});case 4:d=o.sent,"200"==d.code?(l=t.parent,f=l.data.children||l.data,p=f.findIndex((function(t){return t.id===e.id})),f.splice(p,1),n.util.showToast({title:d.msg,icon:"success",duration:1e3}),a.$store.state.app.uiAudio&&(h=new Audio,h.src="https://cdn.jsdelivr.net/gh/starideas/xyfront/audio/delete.mp3",h.play())):n.util.showToast({title:d.msg,icon:"loading",duration:3e3});case 6:case"end":return o.stop()}}),o)})))).catch((function(){if(a.$store.state.app.uiAudio){var t=new Audio;t.src=Object({NODE_ENV:"production",VUE_APP_BASE_DOMAIN:"https://jiangruyi.com",VUE_APP_I18N_FALLBACK_LOCALE:"zh",VUE_APP_I18N_LOCALE:"zh",VUE_APP_IS_DEMO:"false",BASE_URL:"https://cdn.jsdelivr.net/gh/starideas/xyfront/vue/vue-starter/dist/"}).VUE_APP_AUDIO_CLOSE,t.play()}}))},readyProcess:function(t){var e=this.util.builderutil.readyList({listData:t},this.$store.state.app.apiInfo);this.colData=Object(i["a"])({},e.listData),this.ready=!0},loadData:function(){var t=arguments,e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,r,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t.length>0&&void 0!==t[0]?t[0]:"",""!=n&&(e.api=n),e.loading=!0,!e.api){a.next=8;break}return a.next=6,e.util.request({url:e.api,method:"get",header:{CloudId:null===(r=e.header)||void 0===r?void 0:r.cloudId,Eid:null===(i=e.header)||void 0===i?void 0:i.eid}});case 6:o=a.sent,"200"==o.code?(e.readyProcess(o.data.listData),e.loading=!1):e.util.showToast({title:o.msg,icon:"loading",duration:3e3});case 8:e.loading=!1;case 9:case"end":return a.stop()}}),a)})))()}}},f=l,p=(a("985e"),a("2877")),h=Object(p["a"])(f,n,r,!1,null,"4d667a5d",null);e["default"]=h.exports}}]);