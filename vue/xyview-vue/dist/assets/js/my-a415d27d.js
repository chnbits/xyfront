import{_ as S}from"../index-726dc959.js";const E=window.Vue.defineComponent,N=E({setup(){return{}},data(){return{actionLoading:!1,tabCurrentIndex:0,navList:[{state:"all",title:"\u5168\u90E8",loadingType:"more",loaded:!1,orderList:[],dataPage:{page:1,limit:10,total:0}},{state:"waitpay",title:"\u5F85\u4ED8\u6B3E",loadingType:"more",loaded:!1,orderList:[],dataPage:{page:1,limit:10,total:0}},{state:"waitdeliver,waitpick,waitconfirm",title:"\u5F85\u6536\u8D27",loadingType:"more",loaded:!1,orderList:[],dataPage:{page:1,limit:10,total:0}},{state:"waitcomment",title:"\u5F85\u8BC4\u4EF7",loadingType:"more",loaded:!1,orderList:[],dataPage:{page:1,limit:10,total:0}},{state:"return,service",title:"\u9000\u6B3E/\u552E\u540E",loadingType:"more",loaded:!1,orderList:[],dataPage:{page:1,limit:10,total:0}}]}},created:function(){var a,e,c,i;(e=(a=this.$router)==null?void 0:a.query)!=null&&e.tab&&(this.tabCurrentIndex=parseInt((i=(c=this.$router)==null?void 0:c.query)==null?void 0:i.tab)),this.loadData()},watch:{tabCurrentIndex(){this.loadData("tabChange")}},methods:{handleSizeChange(a){this.navList[this.tabCurrentIndex].dataPage.page=1,this.loadData()},handleCurrentChange(a){this.loadData()},async loadData(a=""){let e=this.navList[this.tabCurrentIndex];if(a==="tabChange"&&e.loaded===!0||e.loadingType==="loading")return;e.loadingType="loading";let c=await this.$xyutil.request({url:"/v1/ishop/order/my",method:"get",data:{state:e.state,page:e.dataPage.page,limit:e.dataPage.limit}});c.code==200&&(e.orderList=c.data.dataList,e.dataPage=c.data.dataPage,e.loaded=!0,e.loadingType="done")},resetLoaded(){let a=this.navList;for(var e=0;e<a.length;e++)a[e].loaded=!1},navTo(a){this.$router.push({path:a})},async doAction(a,e,c){this.actionLoading=!0;var i={};switch(a){case"\u5220\u9664\u8BA2\u5355":uni.showModal({content:"\u786E\u5B9A\u8981\u5220\u9664\u8BA2\u5355\uFF1F",success:async g=>{g.confirm&&(i=await this.$xyutil.request({url:"/v1/ishop/order/delete/"+e,method:"DELETE"}),i.code==200?(this.$xyutil.showToast({title:i.msg,icon:"success",duration:1e3}),this.loadData(),this.resetLoaded()):this.$xyutil.showToast({title:i.msg,icon:"loading",duration:1500}))}});break;case"\u53D6\u6D88\u8BA2\u5355":uni.showModal({content:"\u786E\u5B9A\u8981\u53D6\u6D88\u8BA2\u5355\uFF1F",success:async g=>{g.confirm&&(i=await this.$xyutil.request({url:"/v1/ishop/order/cancel",method:"PUT",data:{orderNo:e}}),i.code==200?(this.$xyutil.showToast({title:i.msg,icon:"success",duration:1e3}),this.loadData(),this.resetLoaded()):this.$xyutil.showToast({title:i.msg,icon:"loading",duration:1500}))}});break;case"\u7ACB\u5373\u4ED8\u6B3E":this.navTo("/ishop/order/info?orderNos="+e);break;case"\u786E\u8BA4\u6536\u8D27":uni.showModal({content:"\u786E\u5B9A\u8981\u786E\u8BA4\u6536\u8D27\uFF1F",success:async g=>{g.confirm&&(i=await this.$xyutil.request({url:"/v1/ishop/order/confirm",method:"PUT",data:{orderNo:e}}),i.code==200?(this.$xyutil.showToast({title:i.msg,icon:"success",duration:1e3}),this.loadData(),this.resetLoaded()):this.$xyutil.showToast({title:i.msg,icon:"loading",duration:1500}))}});break;case"\u8BC4\u4EF7":uni.setStorageSync("ishopCommmentCurrent",c),this.navTo("/ishop/comment/add?orderNo="+e);break;case"\u9000\u8D27":this.navTo("/ishop/order_return/apply?orderNo="+e);break}this.actionLoading=!1}}}),m=window.Vue.createTextVNode,p=window.Vue.resolveComponent,u=window.Vue.withCtx,_=window.Vue.createVNode,o=window.Vue.createElementVNode,f=window.Vue.renderList,w=window.Vue.Fragment,s=window.Vue.openBlock,l=window.Vue.createElementBlock,y=window.Vue.createBlock,h=window.Vue.createCommentVNode,d=window.Vue.toDisplayString,F=window.Vue.vShow,U=window.Vue.withDirectives,j=window.Vue.withModifiers,q=window.Vue.normalizeClass;window.Vue.pushScopeId;window.Vue.popScopeId;const B={class:"container bg-white p-b"},M={class:"p-t"},A=m("\u4E2A\u4EBA\u4E2D\u5FC3"),Y=m("\u6211\u7684\u8BA2\u5355"),G={class:"i-top bg-gray-100 px-2 py-2 ts-13"},H={class:"title"},J={class:"m-r"},K={class:"m-r"},O={class:"m-r"},Q={class:"state ts-13"},R=["src"],W=["src"],X={class:"right flex-1 flex flex-col"},Z={class:"flex"},I={class:"title clamp flex-1"},ee={class:"flex-1 flex justify-end"},te={key:0,class:"text-error font-sm",type:"default",size:"small"},oe={key:1,class:"text-error font-sm",type:"default",size:"small"},ae={class:"attr-box"},se={class:"spec"},ie={class:"amount"},ne={class:"deliver-info flex",style:{color:"#909399","font-size":"12px"}},le=m("\u8D27\u5230\u4ED8\u6B3E"),re={class:"price-total flex justify-end"},de={key:0,class:"action-box b-t m-b-xs m-r"},ce=["onClick"],pe={class:"summary"},ue=m(" \u5171 "),he={class:"num"},me=m(" \u4EF6\u5546\u54C1 \u5B9E\u4ED8\u6B3E "),ge={class:"price"},_e={key:0,class:"flex flex-start"};function xe(a,e,c,i,g,fe){const v=p("el-breadcrumb-item"),C=p("el-breadcrumb"),T=p("el-empty"),V=p("scroll-view"),b=p("el-tag"),L=p("el-skeleton"),z=p("el-pagination"),$=p("el-tab-pane"),P=p("el-tabs");return s(),l("div",B,[o("div",M,[_(C,{"separator-class":"el-icon-arrow-right",class:"p-l m-b"},{default:u(()=>[_(v,{to:{path:"/user/center"}},{default:u(()=>[A]),_:1}),_(v,null,{default:u(()=>[Y]),_:1})]),_:1})]),_(P,{modelValue:a.tabCurrentIndex,"onUpdate:modelValue":e[0]||(e[0]=r=>a.tabCurrentIndex=r),type:"card","tab-position":"top"},{default:u(()=>[(s(!0),l(w,null,f(a.navList,(r,k)=>(s(),y($,{key:k,label:r.title,name:k},{default:u(()=>[_(L,{loading:r.loadingType=="loading",animated:"",rows:8},{default:u(()=>[r.orderList.length==0?(s(),y(T,{key:0,description:"\u6682\u65E0\u6570\u636E"})):h("",!0),(s(!0),l(w,null,f(r.orderList,(t,D)=>(s(),l("div",{key:D,class:"order-item"},[o("div",G,[o("text",H,[o("span",J,d(t.storeInfo.title),1),o("span",K,d(a.$xyutil.timeFormat(t.createTime)),1),o("span",O,"\u8BA2\u5355\u53F7\uFF1A"+d(t.orderNo),1)]),o("text",Q,d(t.stateFormat.title),1)]),t.listType&&t.listType=="o2o"?(s(),y(V,{key:0,class:"goods-box","scroll-x":""},{default:u(()=>[(s(!0),l(w,null,f(t.skuList,(n,x)=>(s(),l("div",{key:x,class:"goods-item"},[U(o("img",{width:"60",class:"goods-img",src:n.cover,mode:"aspectFill"},null,8,R),[[F,n.cover]])]))),128))]),_:2},1024)):h("",!0),(s(!0),l(w,null,f(t.skuList,(n,x)=>(s(),l("div",{class:"goods-box-single flex p-t-sm",key:x},[o("img",{width:"80",class:"goods-img",src:n.cover,mode:"aspectFill"},null,8,W),o("div",X,[o("div",Z,[o("div",I,[t.promoteType?(s(),y(b,{key:0,class:"m-r-xs",plain:!0,shape:"circle",size:"small"},{default:u(()=>[m(d(t.promoteTypeFormat.title),1)]),_:2},1024)):h("",!0),m(" "+d(n.title),1)]),o("div",ee,[n.state==1?(s(),l("text",te,"\u9000\u8D27\u4E2D")):h("",!0),n.state==2?(s(),l("text",oe,"\u5DF2\u9000\u8D27")):h("",!0)])]),o("div",ae,[o("div",se,d(n.spec),1),o("div",ie,[o("span",null,d(n.price),1),m(" x "+d(n.amount),1)])])])]))),128)),o("div",ne,[t.deliverPay?(s(),y(b,{key:0,class:"m-r-xs",plain:!0,size:"small"},{default:u(()=>[le]),_:1})):h("",!0)]),o("div",re,[t.stateExtend.actionTitle&&t.stateExtend.actionTitle.length>0?(s(),l("div",de,[(s(!0),l(w,null,f(t.stateExtend.actionTitle,(n,x)=>(s(),l("text",{key:x,size:"small",text:"",bg:"",class:q(["action-btn m-r text-primary",n=="\u7ACB\u5373\u4ED8\u6B3E"||n=="\u786E\u8BA4\u6536\u8D27"||n=="\u8BC4\u4EF7"?"active":""]),onClick:j(we=>a.doAction(n,t.orderNo,t),["stop"])},d(n),11,ce))),128))])):h("",!0),o("div",pe,[ue,o("text",he,d(t.skuAmountAll),1),me,o("text",ge,d(t.realMoney),1)])])]))),128))]),_:2},1032,["loading"]),r.orderList.length!=0?(s(),l("div",_e,[_(z,{class:"m-t-md",size:"default",onSizeChange:a.handleSizeChange,onCurrentChange:a.handleCurrentChange,"current-page":r.dataPage.page,"onUpdate:current-page":t=>r.dataPage.page=t,background:"","page-sizes":[10,20,30,50],"page-size":r.dataPage.limit,"onUpdate:page-size":t=>r.dataPage.limit=t,layout:"total, sizes, prev, pager, next, jumper",total:r.dataPage.total},null,8,["onSizeChange","onCurrentChange","current-page","onUpdate:current-page","page-size","onUpdate:page-size","total"])])):h("",!0)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])])}var ve=S(N,[["render",xe],["__scopeId","data-v-7872dc20"]]);export{ve as default};
