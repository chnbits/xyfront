/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function d(r,e,t,s){function i(n){return n instanceof t?n:new t(function(o){o(n)})}return new(t||(t=Promise))(function(n,o){function a(l){try{h(s.next(l))}catch(S){o(S)}}function u(l){try{h(s.throw(l))}catch(S){o(S)}}function h(l){l.done?n(l.value):i(l.value).then(a,u)}h((s=s.apply(r,e||[])).next())})}var p;(function(r){r.GET="GET",r.PATCH="PATCH",r.POST="POST",r.PUT="PUT",r.DELETE="DELETE"})(p||(p={}));class A{constructor(e){if(this.requests=new Map,typeof e!="undefined"){const t=A.requestLimit;if(e.length>t){const s=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw s.name="Limit Exceeded Error",s}for(const s of e)this.addRequest(s)}}static validateDependencies(e){const t=n=>{const o=n.entries();let a=o.next();for(;!a.done;){const u=a.value[1];if(u.dependsOn!==void 0&&u.dependsOn.length>0)return!1;a=o.next()}return!0},s=n=>{const o=n.entries();let a=o.next();const u=a.value[1];if(u.dependsOn!==void 0&&u.dependsOn.length>0)return!1;let h=a;for(a=o.next();!a.done;){const l=a.value[1];if(l.dependsOn===void 0||l.dependsOn.length!==1||l.dependsOn[0]!==h.value[1].id)return!1;h=a,a=o.next()}return!0},i=n=>{const o=n.entries();let a=o.next();const u=a.value[1];let h;if(u.dependsOn===void 0||u.dependsOn.length===0)h=u.id;else if(u.dependsOn.length===1){const l=u.dependsOn[0];if(l!==u.id&&n.has(l))h=l;else return!1}else return!1;for(a=o.next();!a.done;){const l=a.value[1];if((l.dependsOn===void 0||l.dependsOn.length===0)&&h!==l.id||l.dependsOn!==void 0&&l.dependsOn.length!==0&&(l.dependsOn.length===1&&(l.id===h||l.dependsOn[0]!==h)||l.dependsOn.length>1))return!1;a=o.next()}return!0};if(e.size===0){const n=new Error("Empty requests map, Please provide at least one request.");throw n.name="Empty Requests Error",n}return t(e)||s(e)||i(e)}static getRequestData(e){return d(this,void 0,void 0,function*(){const t={url:""},s=new RegExp("^https?://");t.url=s.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const i={};return e.headers.forEach((n,o)=>{i[o]=n}),Object.keys(i).length&&(t.headers=i),(e.method===p.PATCH||e.method===p.POST||e.method===p.PUT)&&(t.body=yield A.getRequestBody(e)),t})}static getRequestBody(e){return d(this,void 0,void 0,function*(){let t=!1,s;try{s=yield e.clone().json(),t=!0}catch{}if(!t)try{if(typeof Blob!="undefined"){const i=yield e.blob(),n=new FileReader;s=yield new Promise(o=>{n.addEventListener("load",()=>{const a=n.result,h=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(a);o(h[4])},!1),n.readAsDataURL(i)})}else typeof Buffer!="undefined"&&(s=(yield e.buffer()).toString("base64"));t=!0}catch{}return s})}addRequest(e){const t=A.requestLimit;if(e.id===""){const s=new Error("Id for a request is empty, Please provide an unique id");throw s.name="Empty Id For Request",s}if(this.requests.size===t){const s=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw s.name="Limit Exceeded Error",s}if(this.requests.has(e.id)){const s=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw s.name="Duplicate RequestId Error",s}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),s=this.requests.entries();let i=s.next();for(;!i.done;){const n=i.value[1].dependsOn;if(typeof n!="undefined"){const o=n.indexOf(e);o!==-1&&n.splice(o,1),n.length===0&&delete i.value[1].dependsOn}i=s.next()}return t}getContent(){return d(this,void 0,void 0,function*(){const e=[],t={requests:e},s=this.requests.entries();let i=s.next();if(i.done){const n=new Error("No requests added yet, Please add at least one request.");throw n.name="Empty Payload",n}if(!A.validateDependencies(this.requests)){const n=new Error(`Invalid dependency found, Dependency should be:
1. Parallel - no individual request states a dependency in the dependsOn property.
2. Serial - all individual requests depend on the previous individual request.
3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.`);throw n.name="Invalid Dependency",n}for(;!i.done;){const n=i.value[1],o=yield A.getRequestData(n.request);if(o.body!==void 0&&(o.headers===void 0||o.headers["content-type"]===void 0)){const a=new Error(`Content-type header is not mentioned for request #${n.id}, For request having body, Content-type header should be mentioned`);throw a.name="Invalid Content-type header",a}o.id=n.id,n.dependsOn!==void 0&&n.dependsOn.length>0&&(o.dependsOn=n.dependsOn),e.push(o),i=s.next()}return t.requests=e,t})}addDependency(e,t){if(!this.requests.has(e)){const s=new Error(`Dependent ${e} does not exists, Please check the id`);throw s.name="Invalid Dependent",s}if(typeof t!="undefined"&&!this.requests.has(t)){const s=new Error(`Dependency ${t} does not exists, Please check the id`);throw s.name="Invalid Dependency",s}if(typeof t!="undefined"){const s=this.requests.get(e);if(s.dependsOn===void 0&&(s.dependsOn=[]),s.dependsOn.indexOf(t)!==-1){const i=new Error(`Dependency ${t} is already added for the request ${e}`);throw i.name="Duplicate Dependency",i}s.dependsOn.push(t)}else{const s=this.requests.entries();let i,n=s.next();for(;!n.done&&n.value[1].id!==e;)i=n,n=s.next();if(typeof i!="undefined"){const o=i.value[0];if(n.value[1].dependsOn===void 0&&(n.value[1].dependsOn=[]),n.value[1].dependsOn.indexOf(o)!==-1){const a=new Error(`Dependency ${o} is already added for the request ${e}`);throw a.name="Duplicate Dependency",a}n.value[1].dependsOn.push(o)}else{const o=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw o.name="Invalid Dependency Addition",o}}}removeDependency(e,t){const s=this.requests.get(e);if(typeof s=="undefined"||s.dependsOn===void 0||s.dependsOn.length===0)return!1;if(typeof t!="undefined"){const i=s.dependsOn.indexOf(t);return i===-1?!1:(s.dependsOn.splice(i,1),!0)}else return delete s.dependsOn,!0}}A.requestLimit=20;class ge{constructor(e){this.responses=new Map,this.update(e)}createResponseObject(e){const t=e.body,s={};if(s.status=e.status,e.statusText!==void 0&&(s.statusText=e.statusText),s.headers=e.headers,s.headers!==void 0&&s.headers["Content-Type"]!==void 0&&s.headers["Content-Type"].split(";")[0]==="application/json"){const i=JSON.stringify(t);return new Response(i,s)}return new Response(t,s)}update(e){this.nextLink=e["@odata.nextLink"];const t=e.responses;for(let s=0,i=t.length;s<i;s++)this.responses.set(t[s].id,this.createResponseObject(t[s]))}getResponseById(e){return this.responses.get(e)}getResponses(){return this.responses}*getResponsesIterator(){const e=this.responses.entries();let t=e.next();for(;!t.done;)yield t.value,t=e.next()}}const Z="v1.0",K="https://graph.microsoft.com/",J=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class f extends Error{constructor(e){super(e),Object.setPrototypeOf(this,f.prototype)}static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new f,t.customError=e),t}}const ee=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],te=r=>{const e=n=>n.replace(/\/+$/,""),t=n=>n.replace(/^\/+/,""),s=(n,o)=>[e(n),t(o)].join("/");return Array.prototype.slice.call(r).reduce(s)},N=r=>{const e=r&&r.constructor&&r.constructor.name;if(e==="Buffer"||e==="Blob"||e==="File"||e==="FormData"||typeof r=="string")return r;if(e==="ArrayBuffer")r=Buffer.from(r);else if(e==="Int8Array"||e==="Int16Array"||e==="Int32Array"||e==="Uint8Array"||e==="Uint16Array"||e==="Uint32Array"||e==="Uint8ClampedArray"||e==="Float32Array"||e==="Float64Array"||e==="DataView")r=Buffer.from(r.buffer);else try{r=JSON.stringify(r)}catch{throw new Error("Unable to stringify the content")}return r},B=r=>V(r),$=(r,e)=>(e.forEach(t=>se(t)),V(r,e)),V=(r,e=J)=>{if(r=r.toLowerCase(),r.indexOf("https://")!==-1){r=r.replace("https://","");const t=r.indexOf(":"),s=r.indexOf("/");let i="";if(s!==-1)return t!==-1&&t<s?(i=r.substring(0,t),e.has(i)):(i=r.substring(0,s),e.has(i))}return!1},se=r=>{if(r.indexOf("/")!==-1)throw new f("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class v{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const s=t.constructor;this.middlewareOptions.set(s,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const j=()=>{let r="";for(let e=0;e<32;e++)(e===8||e===12||e===16||e===20)&&(r+="-"),r+=Math.floor(Math.random()*16).toString(16);return r},k=(r,e,t)=>{let s=null;if(typeof Request!="undefined"&&r instanceof Request)s=r.headers.get(t);else if(typeof e!="undefined"&&e.headers!==void 0)if(typeof Headers!="undefined"&&e.headers instanceof Headers)s=e.headers.get(t);else if(e.headers instanceof Array){const i=e.headers;for(let n=0,o=i.length;n<o;n++)if(i[n][0]===t){s=i[n][1];break}}else e.headers[t]!==void 0&&(s=e.headers[t]);return s},Q=(r,e,t,s)=>{if(typeof Request!="undefined"&&r instanceof Request)r.headers.set(t,s);else if(typeof e!="undefined")if(e.headers===void 0)e.headers=new Headers({[t]:s});else if(typeof Headers!="undefined"&&e.headers instanceof Headers)e.headers.set(t,s);else if(e.headers instanceof Array){let i=0;const n=e.headers.length;for(;i<n;i++){const o=e.headers[i];if(o[0]===t){o[1]=s;break}}i===n&&e.headers.push([t,s])}else Object.assign(e.headers,{[t]:s})},X=(r,e,t,s)=>{typeof Request!="undefined"&&r instanceof Request?r.headers.append(t,s):typeof e!="undefined"&&(e.headers===void 0?e.headers=new Headers({[t]:s}):typeof Headers!="undefined"&&e.headers instanceof Headers?e.headers.append(t,s):e.headers instanceof Array?e.headers.push([t,s]):e.headers===void 0?e.headers={[t]:s}:e.headers[t]===void 0?e.headers[t]=s:e.headers[t]+=`, ${s}`)},ie=(r,e)=>d(void 0,void 0,void 0,function*(){const t=e.headers.get("Content-Type")?yield e.blob():yield Promise.resolve(void 0),{method:s,headers:i,referrer:n,referrerPolicy:o,mode:a,credentials:u,cache:h,redirect:l,integrity:S,keepalive:W,signal:Y}=e;return new Request(r,{method:s,headers:i,body:t,referrer:n,referrerPolicy:o,mode:a,credentials:u,cache:h,redirect:l,integrity:S,keepalive:W,signal:Y})});class ne{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var b;(function(r){r[r.NONE=0]="NONE",r[r.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",r[r.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",r[r.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"})(b||(b={}));class w{constructor(){this.featureUsage=b.NONE}static updateFeatureUsageFlag(e,t){let s;e.middlewareControl instanceof v?s=e.middlewareControl.getMiddlewareOptions(w):e.middlewareControl=new v,typeof s=="undefined"&&(s=new w,e.middlewareControl.setMiddlewareOptions(w,s)),s.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class O{constructor(e){this.authenticationProvider=e}execute(e){return d(this,void 0,void 0,function*(){const t=typeof e.request=="string"?e.request:e.request.url;if(B(t)||e.customHosts&&$(t,e.customHosts)){let s;e.middlewareControl instanceof v&&(s=e.middlewareControl.getMiddlewareOptions(ne));let i,n;s&&(i=s.authenticationProvider,n=s.authenticationProviderOptions),i||(i=this.authenticationProvider);const a=`Bearer ${yield i.getAccessToken(n)}`;X(e.request,e.options,O.AUTHORIZATION_HEADER,a),w.updateFeatureUsageFlag(e,b.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[O.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}O.AUTHORIZATION_HEADER="Authorization";class z{execute(e){return d(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}class c{constructor(e=c.DEFAULT_DELAY,t=c.DEFAULT_MAX_RETRIES,s=c.defaultShouldRetry){if(e>c.MAX_DELAY&&t>c.MAX_MAX_RETRIES){const i=new Error(`Delay and MaxRetries should not be more than ${c.MAX_DELAY} and ${c.MAX_MAX_RETRIES}`);throw i.name="MaxLimitExceeded",i}else if(e>c.MAX_DELAY){const i=new Error(`Delay should not be more than ${c.MAX_DELAY}`);throw i.name="MaxLimitExceeded",i}else if(t>c.MAX_MAX_RETRIES){const i=new Error(`MaxRetries should not be more than ${c.MAX_MAX_RETRIES}`);throw i.name="MaxLimitExceeded",i}else if(e<0&&t<0){const i=new Error("Delay and MaxRetries should not be negative");throw i.name="MinExpectationNotMet",i}else if(e<0){const i=new Error("Delay should not be negative");throw i.name="MinExpectationNotMet",i}else if(t<0){const i=new Error("MaxRetries should not be negative");throw i.name="MinExpectationNotMet",i}this.delay=Math.min(e,c.MAX_DELAY),this.maxRetries=Math.min(t,c.MAX_MAX_RETRIES),this.shouldRetry=s}getMaxDelay(){return c.MAX_DELAY}}c.DEFAULT_DELAY=3;c.DEFAULT_MAX_RETRIES=3;c.MAX_DELAY=180;c.MAX_MAX_RETRIES=10;c.defaultShouldRetry=()=>!0;class R{constructor(e=new c){this.options=e}isRetry(e){return R.RETRY_STATUS_CODES.indexOf(e.status)!==-1}isBuffered(e,t){const s=typeof e=="string"?t.method:e.method;return!((s===p.PUT||s===p.PATCH||s===p.POST)&&k(e,t,"Content-Type")==="application/octet-stream")}getDelay(e,t,s){const i=()=>Number(Math.random().toFixed(3)),n=e.headers!==void 0?e.headers.get(R.RETRY_AFTER_HEADER):null;let o;return n!==null?Number.isNaN(Number(n))?o=Math.round((new Date(n).getTime()-Date.now())/1e3):o=Number(n):o=t>=2?this.getExponentialBackOffTime(t)+s+i():s+i(),Math.min(o,this.options.getMaxDelay()+i())}getExponentialBackOffTime(e){return Math.round(1/2*(Math.pow(2,e)-1))}sleep(e){return d(this,void 0,void 0,function*(){const t=e*1e3;return new Promise(s=>setTimeout(s,t))})}getOptions(e){let t;return e.middlewareControl instanceof v&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),typeof t=="undefined"&&(t=Object.assign(new c,this.options)),t}executeWithRetry(e,t,s){return d(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),t<s.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&s.shouldRetry(s.delay,t,e.request,e.options,e.response)){++t,Q(e.request,e.options,R.RETRY_ATTEMPT_HEADER,t.toString());const i=this.getDelay(e.response,t,s.delay);return yield this.sleep(i),yield this.executeWithRetry(e,t,s)}else return})}execute(e){return d(this,void 0,void 0,function*(){const s=this.getOptions(e);return w.updateFeatureUsageFlag(e,b.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,s)})}setNext(e){this.nextMiddleware=e}}R.RETRY_STATUS_CODES=[429,503,504];R.RETRY_ATTEMPT_HEADER="Retry-Attempt";R.RETRY_AFTER_HEADER="Retry-After";class y{constructor(e=y.DEFAULT_MAX_REDIRECTS,t=y.defaultShouldRedirect){if(e>y.MAX_MAX_REDIRECTS){const s=new Error(`MaxRedirects should not be more than ${y.MAX_MAX_REDIRECTS}`);throw s.name="MaxLimitExceeded",s}if(e<0){const s=new Error("MaxRedirects should not be negative");throw s.name="MinExpectationNotMet",s}this.maxRedirects=e,this.shouldRedirect=t}}y.DEFAULT_MAX_REDIRECTS=5;y.MAX_MAX_REDIRECTS=20;y.defaultShouldRedirect=()=>!0;class E{constructor(e=new y){this.options=e}isRedirect(e){return E.REDIRECT_STATUS_CODES.indexOf(e.status)!==-1}hasLocationHeader(e){return e.headers.has(E.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(E.LOCATION_HEADER)}isRelativeURL(e){return e.indexOf("://")===-1}shouldDropAuthorizationHeader(e,t){const s=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,i=s.exec(e);let n,o;i!==null&&(n=i[0]);const a=s.exec(t);return a!==null&&(o=a[0]),typeof n!="undefined"&&typeof o!="undefined"&&n!==o}updateRequestUrl(e,t){return d(this,void 0,void 0,function*(){t.request=typeof t.request=="string"?e:yield ie(e,t.request)})}getOptions(e){let t;return e.middlewareControl instanceof v&&(t=e.middlewareControl.getMiddlewareOptions(y)),typeof t=="undefined"&&(t=Object.assign(new y,this.options)),t}executeWithRedirect(e,t,s){return d(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(e);const i=e.response;if(t<s.maxRedirects&&this.isRedirect(i)&&this.hasLocationHeader(i)&&s.shouldRedirect(i)){if(++t,i.status===E.STATUS_CODE_SEE_OTHER)e.options.method=p.GET,delete e.options.body;else{const n=this.getLocationHeader(i);!this.isRelativeURL(n)&&this.shouldDropAuthorizationHeader(i.url,n)&&delete e.options.headers[E.AUTHORIZATION_HEADER],yield this.updateRequestUrl(n,e)}yield this.executeWithRedirect(e,t,s)}else return})}execute(e){return d(this,void 0,void 0,function*(){const s=this.getOptions(e);return e.options.redirect=E.MANUAL_REDIRECT,w.updateFeatureUsageFlag(e,b.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,s)})}setNext(e){this.nextMiddleware=e}}E.REDIRECT_STATUS_CODES=[301,302,303,307,308];E.STATUS_CODE_SEE_OTHER=303;E.LOCATION_HEADER="Location";E.AUTHORIZATION_HEADER="Authorization";E.MANUAL_REDIRECT="manual";const re="3.0.2";class m{execute(e){return d(this,void 0,void 0,function*(){const t=typeof e.request=="string"?e.request:e.request.url;if(B(t)||e.customHosts&&$(t,e.customHosts)){let s=k(e.request,e.options,m.CLIENT_REQUEST_ID_HEADER);s||(s=j(),Q(e.request,e.options,m.CLIENT_REQUEST_ID_HEADER,s));let i=`${m.PRODUCT_NAME}/${re}`,n;if(e.middlewareControl instanceof v&&(n=e.middlewareControl.getMiddlewareOptions(w)),n){const o=n.getFeatureUsage();i+=` (${m.FEATURE_USAGE_STRING}=${o})`}X(e.request,e.options,m.SDK_VERSION_HEADER,i)}else delete e.options.headers[m.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[m.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}m.CLIENT_REQUEST_ID_HEADER="client-request-id";m.SDK_VERSION_HEADER="SdkVersion";m.PRODUCT_NAME="graph-js";m.FEATURE_USAGE_STRING="featureUsage";const oe=()=>typeof process=="object"&&typeof require=="function";class Re{static getDefaultMiddlewareChain(e){const t=[],s=new O(e),i=new R(new c),n=new m,o=new z;if(t.push(s),t.push(i),oe()){const a=new E(new y);t.push(a)}return t.push(n),t.push(o),t}}var D;(function(r){r[r.MANUAL=0]="MANUAL",r[r.RANDOM=1]="RANDOM"})(D||(D={}));class I{constructor(e=D.RANDOM,t="Some error Happened",s,i,n,o){if(this.chaosStrategy=e,this.statusCode=s,this.statusMessage=t,this.chaosPercentage=i!==void 0?i:10,this.responseBody=n,this.headers=o,this.chaosPercentage>100)throw new Error("Error Pecentage can not be more than 100")}}const ae={GET:[429,500,502,503,504],POST:[429,500,502,503,504,507],PUT:[429,500,502,503,504,507],PATCH:[429,500,502,503,504],DELETE:[429,500,502,503,504,507]},de={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};class we{constructor(e=new I,t){this.options=e,this.manualMap=t}createResponseHeaders(e,t,s){const i=e.headers?new Headers(e.headers):new Headers;return i.append("Cache-Control","no-store"),i.append("request-id",t),i.append("client-request-id",t),i.append("x-ms-ags-diagnostic",""),i.append("Date",s),i.append("Strict-Transport-Security",""),e.statusCode===429&&i.append("retry-after","3"),i}createResponseBody(e,t,s){if(e.responseBody)return e.responseBody;let i;if(e.statusCode>=400){const n=de[e.statusCode],o=e.statusMessage;i={error:{code:n,message:o,innerError:{"request-id":t,date:s}}}}else i={};return i}createResponse(e,t){const s=t.request,i=j(),n=new Date,o=this.createResponseHeaders(e,i,n.toString()),a=this.createResponseBody(e,i,n.toString()),u={url:s,status:e.statusCode,statusText:e.statusMessage,headers:o};t.response=new Response(typeof a=="string"?a:JSON.stringify(a),u)}sendRequest(e,t){return d(this,void 0,void 0,function*(){this.setStatusCode(e,t.request,t.options.method),e.chaosStrategy===D.MANUAL&&!this.nextMiddleware||Math.floor(Math.random()*100)<e.chaosPercentage?this.createResponse(e,t):this.nextMiddleware&&(yield this.nextMiddleware.execute(t))})}getRandomStatusCode(e){const t=ae[e];return t[Math.floor(Math.random()*t.length)]}getRelativeURL(e){const t=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let s;return t.exec(e)!==null&&(s=t.exec(e)[1]),s}setStatusCode(e,t,s){if(e.chaosStrategy===D.MANUAL){if(e.statusCode===void 0){const i=this.getRelativeURL(t);this.manualMap.get(i)!==void 0?this.manualMap.get(i).get(s)!==void 0&&(e.statusCode=this.manualMap.get(i).get(s)):this.manualMap.forEach((n,o)=>{new RegExp(o+"$").test(i)&&this.manualMap.get(o).get(s)!==void 0&&(e.statusCode=this.manualMap.get(o).get(s))})}}else e.statusCode=this.getRandomStatusCode(s)}getOptions(e){let t;return e.middlewareControl instanceof v&&(t=e.middlewareControl.getMiddlewareOptions(I)),typeof t=="undefined"&&(t=Object.assign(new I,this.options)),t}execute(e){return d(this,void 0,void 0,function*(){const t=this.getOptions(e);return yield this.sendRequest(t,e)})}setNext(e){this.nextMiddleware=e}}var g;(function(r){r.ARRAYBUFFER="arraybuffer",r.BLOB="blob",r.DOCUMENT="document",r.JSON="json",r.RAW="raw",r.STREAM="stream",r.TEXT="text"})(g||(g={}));var _;(function(r){r.TEXT_HTML="text/html",r.TEXT_XML="text/xml",r.APPLICATION_XML="application/xml",r.APPLICATION_XHTML="application/xhtml+xml"})(_||(_={}));var M;(function(r){r.TEXT_PLAIN="text/plain",r.APPLICATION_JSON="application/json"})(M||(M={}));var U;(function(r){r.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",r.IMAGE="^image\\/.+"})(U||(U={}));class P{static parseDocumentResponse(e,t){return typeof DOMParser!="undefined"?new Promise((s,i)=>{e.text().then(n=>{try{const a=new DOMParser().parseFromString(n,t);s(a)}catch(o){i(o)}})}):Promise.resolve(e.body)}static convertResponse(e,t){return d(this,void 0,void 0,function*(){if(e.status===204)return Promise.resolve();let s;const i=e.headers.get("Content-type");switch(t){case g.ARRAYBUFFER:s=yield e.arrayBuffer();break;case g.BLOB:s=yield e.blob();break;case g.DOCUMENT:s=yield P.parseDocumentResponse(e,_.TEXT_XML);break;case g.JSON:s=yield e.json();break;case g.STREAM:s=yield Promise.resolve(e.body);break;case g.TEXT:s=yield e.text();break;default:if(i!==null){const n=i.split(";")[0];new RegExp(U.DOCUMENT).test(n)?s=yield P.parseDocumentResponse(e,n):new RegExp(U.IMAGE).test(n)?s=e.blob():n===M.TEXT_PLAIN?s=yield e.text():n===M.APPLICATION_JSON?s=yield e.json():s=Promise.resolve(e.body)}else s=Promise.resolve(e.body);break}return s})}static getResponse(e,t,s){return d(this,void 0,void 0,function*(){if(t===g.RAW)return Promise.resolve(e);{const i=yield P.convertResponse(e,t);if(e.ok)if(typeof s=="function")s(null,i);else return i;else throw i}})}}class x{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class F{constructor(e,t){this._location=t,this._responseBody=e}get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}static CreateUploadResult(e,t){return new F(e,t.get("location"))}}class le{constructor(e,t,s,i={}){if(this.DEFAULT_FILE_SIZE=5*1024*1024,this.client=e,t.sliceFile)this.file=t;else throw new f("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,i.rangeSize||(i.rangeSize=this.DEFAULT_FILE_SIZE),this.options=i,this.uploadSession=s,this.nextRange=new x(0,this.options.rangeSize-1)}static createUploadSession(e,t,s,i={}){return d(this,void 0,void 0,function*(){const n=yield e.api(t).headers(i).post(s);return{url:n.uploadUrl,expiry:new Date(n.expirationDateTime),isCancelled:!1}})}parseRange(e){const t=e[0];if(typeof t=="undefined"||t==="")return new x;const s=t.split("-"),i=parseInt(s[0],10);let n=parseInt(s[1],10);return Number.isNaN(n)&&(n=this.file.size-1),new x(i,n)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(this.nextRange.minValue===-1)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new x(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new f("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return d(this,void 0,void 0,function*(){const e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const t=this.getNextRange();if(t.maxValue===-1){const a=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw a.name="Invalid Session",a}const s=yield this.file.sliceFile(t),i=yield this.uploadSliceGetRawResponse(s,t,this.file.size);if(!i)throw new f("Something went wrong! Large file upload slice response is null.");const n=yield P.getResponse(i);if(i.status===201||i.status===200&&n.id)return F.CreateUploadResult(n,i.headers);const o={expirationDateTime:n.expirationDateTime||n.ExpirationDateTime,nextExpectedRanges:n.NextExpectedRanges||n.nextExpectedRanges};this.updateTaskStatus(o),e&&e.progress&&e.progress(t,e.extraCallbackParam)}})}uploadSlice(e,t,s){return d(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${t.maxValue-t.minValue+1}`,"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${s}`,"Content-Type":"application/octet-stream"}).put(e)})}uploadSliceGetRawResponse(e,t,s){return d(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${t.maxValue-t.minValue+1}`,"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${s}`,"Content-Type":"application/octet-stream"}).responseType(g.RAW).put(e)})}cancel(){return d(this,void 0,void 0,function*(){const e=yield this.client.api(this.uploadSession.url).responseType(g.RAW).delete();return e.status===204&&(this.uploadSession.isCancelled=!0),e})}getStatus(){return d(this,void 0,void 0,function*(){const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e})}resume(){return d(this,void 0,void 0,function*(){return yield this.getStatus(),yield this.upload()})}getUploadSession(){return this.uploadSession}}class ue{constructor(e,t,s){if(this.content=e,this.name=t,this.size=s,!e||!t||!s)throw new f("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}const ce=5*1024*1024,he=r=>(r>320*1024&&(r=Math.floor(r/(320*1024))*320*1024),r),fe=(r=ce)=>(r>62914560&&(r=62914560),he(r));class T extends le{constructor(e,t,s,i){super(e,t,s,i)}static constructCreateSessionUrl(e,t=T.DEFAULT_UPLOAD_PATH){return e=e.trim(),t=t.trim(),t===""&&(t="/"),t[0]!=="/"&&(t=`/${t}`),t[t.length-1]!=="/"&&(t=`${t}/`),`/me/drive/root:${t.split("/").map(s=>encodeURIComponent(s)).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let s,i;if(typeof Blob!="undefined"&&e instanceof Blob)s=new File([e],t),i=s.size;else if(typeof File!="undefined"&&e instanceof File)s=e,i=s.size;else if(typeof Uint8Array!="undefined"&&e instanceof Uint8Array){const n=e;i=n.byteLength,s=n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}return{content:s,size:i}}static create(e,t,s){return d(this,void 0,void 0,function*(){if(!e||!t||!s)throw new f("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const i=s.fileName,n=T.getFileInfo(t,i),o=new ue(n.content,i,n.size);return this.createTaskWithFileObject(e,o,s)})}static createTaskWithFileObject(e,t,s){return d(this,void 0,void 0,function*(){if(!e||!t||!s)throw new f("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const i=T.constructCreateSessionUrl(s.fileName,s.path),n={fileName:s.fileName,fileDescription:s.fileDescription,conflictBehavior:s.conflictBehavior},o=yield T.createUploadSession(e,i,n),a=fe(s.rangeSize);return new T(e,t,o,{rangeSize:a,uploadEventHandlers:s.uploadEventHandlers})})}static createUploadSession(e,t,s){const i=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return d(this,void 0,void 0,function*(){const n={item:{"@microsoft.graph.conflictBehavior":(s==null?void 0:s.conflictBehavior)||"rename",name:s==null?void 0:s.fileName,description:s==null?void 0:s.fileDescription}};return i.createUploadSession.call(this,e,t,n)})}commit(e,t="rename"){return d(this,void 0,void 0,function*(){const s={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(s)})}}T.DEFAULT_UPLOAD_PATH="/";class ve{constructor(e,t,s){if(this.content=e,this.name=t,this.size=s,!e||!t||!s)throw new f("Please provide the Readable Stream content, name of the file and size of the file")}sliceFile(e){return d(this,void 0,void 0,function*(){let t=e.maxValue-e.minValue+1;const s=[];if(this.previousSlice){if(e.minValue<this.previousSlice.range.minValue)throw new f("An error occurred while uploading the stream. Please restart the stream upload from the first byte of the file.");if(e.minValue<this.previousSlice.range.maxValue){const n=this.previousSlice.range.minValue,o=this.previousSlice.range.maxValue;if(e.minValue===n&&e.maxValue===o)return this.previousSlice.fileSlice;if(e.maxValue===o)return this.previousSlice.fileSlice.slice(e.minValue,e.maxValue+1);s.push(this.previousSlice.fileSlice.slice(e.minValue,o+1)),t=e.maxValue-o}}if(this.content&&this.content.readable)this.content.readableLength>=t?s.push(this.content.read(t)):s.push(yield this.readNBytesFromStream(t));else throw new f("Stream is not readable.");const i=Buffer.concat(s);return this.previousSlice={fileSlice:i,range:e},i})}readNBytesFromStream(e){return new Promise((t,s)=>{const i=[];let n=e,o=0;this.content.on("end",()=>{if(n>0)return s(new f("Stream ended before reading required range size"))}),this.content.on("readable",()=>{let a;for(;o<e&&(a=this.content.read(n))!==null;)o+=a.length,i.push(a),n>0&&(n=e-o);if(o===e)return t(Buffer.concat(i));if(!this.content||!this.content.readable)return s(new f("Error encountered while reading the stream during the upload"))})})}}class Ae{constructor(e,t,s,i){this.client=e,this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"],this.callback=s,this.complete=!1,this.requestOptions=i}iterationHelper(){if(this.collection===void 0)return!1;let e=!0;for(;e&&this.collection.length!==0;){const t=this.collection.shift();e=this.callback(t)}return e}fetchAndUpdateNextPageData(){return d(this,void 0,void 0,function*(){let e=this.client.api(this.nextLink);this.requestOptions&&(this.requestOptions.headers&&(e=e.headers(this.requestOptions.headers)),this.requestOptions.middlewareOptions&&(e=e.middlewareOptions(this.requestOptions.middlewareOptions)),this.requestOptions.options&&(e=e.options(this.requestOptions.options)));const t=yield e.get();this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"]})}getDeltaLink(){return this.deltaLink}iterate(){return d(this,void 0,void 0,function*(){let e=this.iterationHelper();for(;e;)this.nextLink!==void 0?(yield this.fetchAndUpdateNextPageData(),e=this.iterationHelper()):e=!1;this.nextLink===void 0&&this.collection.length===0&&(this.complete=!0)})}resume(){return d(this,void 0,void 0,function*(){return this.iterate()})}isComplete(){return this.complete}}class pe{constructor(e){this.provider=e}getAccessToken(){return d(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((s,i)=>d(this,void 0,void 0,function*(){if(i)e(i);else{if(!s){const o="Access token is undefined or empty.						Please provide a valid token.						For more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md";s=new f(o)}const n=yield f.setGraphClientError(s);t(n)}}))})})}}class C extends Error{constructor(e=-1,t,s){super(t||s&&s.message),Object.setPrototypeOf(this,C.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=s?s.stack:this.stack}}class L{static constructError(e,t){const s=new C(t,"",e);return e.name!==void 0&&(s.code=e.name),s.body=e.toString(),s.date=new Date,s}static constructErrorFromResponse(e,t){const s=e.error,i=new C(t,s.message);return i.code=s.code,s.innerError!==void 0&&(i.requestId=s.innerError["request-id"],i.date=new Date(s.innerError.date)),i.body=JSON.stringify(s),i}static getError(e=null,t=-1,s){return d(this,void 0,void 0,function*(){let i;if(e&&e.error?i=L.constructErrorFromResponse(e,t):e instanceof Error?i=L.constructError(e,t):(i=new C(t),i.body=e),typeof s=="function")s(i,null);else return i})}}class me{constructor(e,t,s){this.parsePath=i=>{if(i.indexOf("https://")!==-1){i=i.replace("https://","");const o=i.indexOf("/");o!==-1&&(this.urlComponents.host="https://"+i.substring(0,o),i=i.substring(o+1,i.length));const a=i.indexOf("/");a!==-1&&(this.urlComponents.version=i.substring(0,a),i=i.substring(a+1,i.length))}i.charAt(0)==="/"&&(i=i.substr(1));const n=i.indexOf("?");if(n===-1)this.urlComponents.path=i;else{this.urlComponents.path=i.substr(0,n);const o=i.substring(n+1,i.length).split("&");for(const a of o)this.parseQueryParameter(a)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(s)}addCsvQueryParameter(e,t,s){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let i=[];s.length>1&&typeof t=="string"?i=Array.prototype.slice.call(s):typeof t=="string"?i.push(t):i=i.concat(t),this.urlComponents.oDataQueryParams[e]+=i.join(",")}buildFullUrl(){const e=te([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(Object.keys(e.oDataQueryParams).length!==0)for(const s in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,s)&&t.push(s+"="+e.oDataQueryParams[s]);if(Object.keys(e.otherURLQueryParams).length!==0)for(const s in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,s)&&t.push(s+"="+e.otherURLQueryParams[s]);if(e.otherURLQueryOptions.length!==0)for(const s of e.otherURLQueryOptions)t.push(s);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if(typeof e=="string")if(e.charAt(0)==="?"&&(e=e.substring(1)),e.indexOf("&")!==-1){const t=e.split("&");for(const s of t)this.parseQueryParamenterString(s)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),s=e.substring(0,t),i=e.substring(t+1);this.setURLComponentsQueryParamater(s,i)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(ee.indexOf(e)!==-1){const s=this.urlComponents.oDataQueryParams[e],i=s&&(e==="$expand"||e==="$select"||e==="$orderby");this.urlComponents.oDataQueryParams[e]=i?s+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return!(t===-1||e.indexOf("(")!==-1&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(this.config.fetchOptions!==void 0){const s=Object.assign({},this.config.fetchOptions);Object.assign(e,s),typeof this.config.fetchOptions.headers!==void 0&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),e.headers!==void 0&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,s){var i;return d(this,void 0,void 0,function*(){let n;const o=new v(this._middlewareOptions);this.updateRequestOptions(t);const a=(i=this.config)===null||i===void 0?void 0:i.customHosts;try{return n=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:o,customHosts:a})).response,yield P.getResponse(n,this._responseType,s)}catch(u){if(u instanceof f)throw u;let h;throw n&&(h=n.status),yield L.getError(u,h,s)}})}setHeaderContentType(){if(!this._headers){this.header("Content-Type","application/json");return}const e=Object.keys(this._headers);for(const t of e)if(t.toLowerCase()==="content-type")return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return d(this,void 0,void 0,function*(){const t=this.buildFullUrl(),s={method:p.GET};return yield this.send(t,s,e)})}post(e,t){return d(this,void 0,void 0,function*(){const s=this.buildFullUrl(),i={method:p.POST,body:N(e)};return(e&&e.constructor&&e.constructor.name)==="FormData"?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers),yield this.send(s,i,t)})}create(e,t){return d(this,void 0,void 0,function*(){return yield this.post(e,t)})}put(e,t){return d(this,void 0,void 0,function*(){const s=this.buildFullUrl();this.setHeaderContentType();const i={method:p.PUT,body:N(e)};return yield this.send(s,i,t)})}patch(e,t){return d(this,void 0,void 0,function*(){const s=this.buildFullUrl();this.setHeaderContentType();const i={method:p.PATCH,body:N(e)};return yield this.send(s,i,t)})}update(e,t){return d(this,void 0,void 0,function*(){return yield this.patch(e,t)})}delete(e){return d(this,void 0,void 0,function*(){const t=this.buildFullUrl(),s={method:p.DELETE};return yield this.send(t,s,e)})}del(e){return d(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(e){return d(this,void 0,void 0,function*(){const t=this.buildFullUrl(),s={method:p.GET};return this.responseType(g.STREAM),yield this.send(t,s,e)})}putStream(e,t){return d(this,void 0,void 0,function*(){const s=this.buildFullUrl(),i={method:p.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(s,i,t)})}}class G{constructor(...e){if(!e||!e.length){const t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Please provide a default middleware chain or custom middleware chain",t}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((t,s)=>{s<e.length-1&&t.setNext(e[s+1])}),this.middleware=e[0]}sendRequest(e){return d(this,void 0,void 0,function*(){if(typeof e.request=="string"&&e.options===void 0){const t=new Error;throw t.name="InvalidRequestOptions",t.message="Unable to execute the middleware, Please provide valid options for a request",t}return yield this.middleware.execute(e),e})}}const Ee=()=>typeof process=="object"&&typeof require=="function";class H{static createWithAuthenticationProvider(e){const t=new O(e),s=new R(new c),i=new m,n=new z;if(t.setNext(s),Ee()){const o=new E(new y);s.setNext(o),o.setNext(i)}else s.setNext(i);return i.setNext(n),H.createWithMiddleware(t)}static createWithMiddleware(...e){return new G(...e)}}const ye=()=>{if(typeof Promise=="undefined"&&typeof fetch=="undefined"){const r=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw r.name="PolyFillNotAvailable",r}else if(typeof Promise=="undefined"){const r=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}else if(typeof fetch=="undefined"){const r=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw r.name="PolyFillNotAvailable",r}return!0};class q{constructor(e){this.config={baseUrl:K,debugLogging:!1,defaultVersion:Z},ye();for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(this.config[s]=e[s]);let t;if(e.authProvider!==void 0&&e.middleware!==void 0){const s=new Error;throw s.name="AmbiguityInInitialization",s.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",s}else if(e.authProvider!==void 0)t=H.createWithAuthenticationProvider(e.authProvider);else if(e.middleware!==void 0)t=new G(...[].concat(e.middleware));else{const s=new Error;throw s.name="InvalidMiddlewareChain",s.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",s}this.httpClient=t}static init(e){const t={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=s==="authProvider"?new pe(e[s]):e[s]);return q.initWithMiddleware(t)}static initWithMiddleware(e){return new q(e)}api(e){return new me(this.httpClient,this.config,e)}}export{O as AuthenticationHandler,ne as AuthenticationHandlerOptions,A as BatchRequestContent,ge as BatchResponseContent,we as ChaosHandler,I as ChaosHandlerOptions,D as ChaosStrategy,q as Client,pe as CustomAuthenticationProvider,b as FeatureUsageFlag,ue as FileUpload,f as GraphClientError,C as GraphError,me as GraphRequest,z as HTTPMessageHandler,le as LargeFileUploadTask,Re as MiddlewareFactory,T as OneDriveLargeFileUploadTask,Ae as PageIterator,x as Range,E as RedirectHandler,y as RedirectHandlerOptions,g as ResponseType,R as RetryHandler,c as RetryHandlerOptions,ve as StreamUpload,m as TelemetryHandler,w as TelemetryHandlerOptions,F as UploadResult,fe as getValidRangeSize};
