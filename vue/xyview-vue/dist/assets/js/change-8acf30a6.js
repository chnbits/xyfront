import{a as z,v as C}from"../index-91ea30ae.js";const N={mixins:[C],data(){return{active:1,verifyList:[],loading:!1,formVerfyEmail:{email:this.$store.state.user.userInfo.email.identifier,verify:"",token:""},form:{email:"",password:"",verify:"",token:"",mobile:"",mobileVerify:"",mobileToken:"",gauth:""},rule:{email:[{required:!0,message:"\u8BF7\u586B\u5199\u65B0\u90AE\u7BB1",trigger:"blur"}],verify:[{required:!0,message:"\u8BF7\u586B\u5199\u9A8C\u8BC1\u7801",trigger:"blur"}],token:[{required:!0,message:"\u8BF7\u53D1\u9001\u9A8C\u8BC1\u7801",trigger:"blur"}]}}},created:function(){this.loadData()},methods:{async verifyPassword(){(await this.doVerifyPassword()).code=="200"&&this.active++},getVerifyTokenVerfyEmail(s){this.formVerfyEmail.token=s.token},async verifyEmail(){this.loading=!0;let s=this;setTimeout(function(){s.loading=!1},5e3);let t=await this.$util.request({url:"/v1/reg_email/user/verify",data:this.formVerfyEmail,method:"post"});t.code=="200"?(this.$util.showToast({title:t.msg,icon:"success",duration:2e3}),this.active++):this.$util.showToast({title:t.msg,icon:"loading",duration:3e3}),this.loading=!1},getVerifyToken(s){this.form.token=s.token},getMobileVerifyToken(s){this.form.mobileToken=s.token},async loadData(){let s=await this.$util.request({url:"/v1/reg_email/user/change",method:"get"});s.code=="200"?this.verifyList=s.data.dataList:this.$util.showToast({title:s.msg,icon:"loading",duration:3e3})},async handleSubmit(){this.loading=!0;let s=this;setTimeout(function(){s.loading=!1},5e3);let t=await this.$util.request({url:"/v1/reg_email/user/change",data:this.form,method:"put"});t.code=="200"?(this.$util.showToast({title:t.msg,icon:"success",duration:2e3}),this.active++):this.$util.showToast({title:t.msg,icon:"loading",duration:3e3}),this.loading=!1}}},a=window.Vue.createTextVNode,n=window.Vue.resolveComponent,l=window.Vue.withCtx,e=window.Vue.createVNode,i=window.Vue.createElementVNode,c=window.Vue.openBlock,_=window.Vue.createBlock,m=window.Vue.createCommentVNode,w=window.Vue.createElementBlock,U=window.Vue.pushScopeId,B=window.Vue.popScopeId,y=s=>(U("data-v-315c5947"),s=s(),B(),s),I={class:"box"},S={class:"p-t"},q=a("\u4E2A\u4EBA\u8BBE\u7F6E"),L=a("\u4FEE\u6539\u90AE\u7BB1"),P={class:"content p-t-md"},A={class:"step-tabs"},O=y(()=>i("div",{class:"m-b-md ts-18 tw4"},"\u8BF7\u8F93\u5165\u60A8\u7684\u767B\u5F55\u5BC6\u7801",-1)),D={class:"m-t-lg"},M=a(" \u4E0B\u4E00\u6B65 "),j=a("\u53D6\u6D88\u64CD\u4F5C"),F=y(()=>i("div",{class:"m-b-md ts-12 tw4",style:{color:"#2A2B2E"}},"\u4E3A\u786E\u8BA4\u60A8\u672C\u4EBA\u64CD\u4F5C\uFF0C\u9700\u8981\u60A8\u8FDB\u884C\u90AE\u7BB1\u9A8C\u8BC1\u7801\u9A8C\u8BC1\u8EAB\u4EFD\u3002",-1)),G={class:"flex"},H=y(()=>i("div",{class:"text-gray m-l-md"}," \u90AE\u7BB1\u4E0D\u53EF\u7528\uFF1F\u8BF7\u8054\u7CFB\u5BA2\u670D\u3002 ",-1)),J={class:"flex"},K={class:"m-t-lg"},Q=a(" \u4E0B\u4E00\u6B65 "),R=a("\u8FD4\u56DE\u4E0A\u4E00\u6B65"),W={class:"flex"},X={class:"m-t-lg"},Y=a(" \u786E\u5B9A "),Z=a("\u8FD4\u56DE\u4E0A\u4E00\u6B65"),$={key:3},ee=y(()=>i("div",null,[i("i",{class:"xyicon xyicon-check3 ts-30 m-r-sm",style:{color:"#4AC711"}}),i("span",{class:"ts-20 tw4",style:{color:"#2A2B2E"}},"\u6362\u7ED1\u90AE\u7BB1\u6210\u529F\u3002")],-1)),te={class:"m-t-lg"},oe=a("\u91CD\u65B0\u767B\u5F55"),le=y(()=>i("span",{slot:"title",class:"ts-14"},[i("i",{class:"xyicon xyicon-help-o m-r-xs text-primary"}),i("span",null,"\u6CA1\u6536\u5230\u90AE\u7BB1\u9A8C\u8BC1\u7801\uFF1F")],-1)),ie=y(()=>i("div",{class:"lh-2 ts-12 p-l-xs"},[a(" 1\u3001\u90AE\u7BB1\u5730\u5740\u662F\u5426\u586B\u5199\u6B63\u786E\uFF1F\u586B\u5199\u6B63\u786E\u7684\u90AE\u7BB1\u5730\u5740\uFF0C\u624D\u80FD\u6536\u5230\u9A8C\u8BC1\u7801\u90AE\u4EF6\u3002"),i("br"),a(" 2\u3001\u8BF7\u6838\u5B9E\u90AE\u7BB1\u90AE\u4EF6\u662F\u5426\u88AB\u62E6\u622A\uFF0C\u68C0\u67E5\u90AE\u7BB1\u5783\u573E\u7BB1\u3002"),i("br"),a(" 3\u3001\u5982\u679C\u90AE\u7BB1\u5DF2\u7ECF\u505C\u7528\uFF0C \u8BF7\u9009\u62E9\u5176\u4ED6\u9A8C\u8BC1\u65B9\u5F0F \u3002"),i("br")],-1));function se(s,t,re,ne,o,f){const g=n("el-breadcrumb-item"),x=n("el-breadcrumb"),v=n("el-step"),k=n("el-steps"),d=n("el-input"),u=n("el-form-item"),p=n("el-button"),h=n("el-link"),V=n("el-form"),b=n("xy-send-verify"),E=n("router-link"),T=n("el-alert");return c(),w("div",null,[i("div",I,[i("div",S,[e(x,{"separator-class":"el-icon-arrow-right",class:"p-l m-b"},{default:l(()=>[e(g,{to:{path:"/user/center"}},{default:l(()=>[q]),_:1}),e(g,null,{default:l(()=>[L]),_:1})]),_:1})]),i("div",P,[e(k,{active:o.active,simple:"","align-left":""},{default:l(()=>[e(v,{title:"\u9A8C\u8BC1\u767B\u5F55\u5BC6\u7801",description:""}),e(v,{title:"\u9A8C\u8BC1\u65E7\u90AE\u7BB1",description:""}),e(v,{title:"\u9A8C\u8BC1\u65B0\u90AE\u7BB1",description:""}),e(v,{title:"\u4FEE\u6539\u6210\u529F",description:""})]),_:1},8,["active"]),i("div",A,[o.active==1?(c(),_(V,{key:0,ref:"formVerifyPassword","label-position":"left","label-width":"0px"},{default:l(()=>[O,e(u,{prop:"password"},{default:l(()=>[e(d,{size:"default",type:"password",prefix:"ios-lock-outline",modelValue:s.password,"onUpdate:modelValue":t[0]||(t[0]=r=>s.password=r),placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),i("div",D,[e(p,{class:"submit-btn primary-linear m-r",size:"default",loading:o.loading,type:"primary",onClick:f.verifyPassword},{default:l(()=>[M]),_:1},8,["loading","onClick"]),e(h,{class:"back ts-14",onClick:t[1]||(t[1]=r=>s.$router.back())},{default:l(()=>[j]),_:1})])]),_:1},512)):m("",!0),o.active==2?(c(),_(V,{key:1,ref:"formVerfyEmail","label-position":"left","label-width":"140px",model:o.formVerfyEmail},{default:l(()=>[F,e(u,{prop:"mobile",label:"\u8BF7\u8F93\u5165\u65E7\u90AE\u7BB1"},{default:l(()=>[i("div",G,[e(d,{size:"default",type:"text",prefix:"ios-at-outline",disabled:"",modelValue:o.formVerfyEmail.email,"onUpdate:modelValue":t[2]||(t[2]=r=>o.formVerfyEmail.email=r),placeholder:"\u8BF7\u8F93\u5165\u65E7\u90AE\u7BB1"},null,8,["modelValue"]),H])]),_:1}),e(u,{prop:"verify",label:"\u9A8C\u8BC1\u7801"},{default:l(()=>[i("div",J,[e(d,{class:"m-r",size:"default",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:o.formVerfyEmail.verify,"onUpdate:modelValue":t[3]||(t[3]=r=>o.formVerfyEmail.verify=r),placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),e(p,{type:"primary",size:"default"},{default:l(()=>[e(b,{onVerifysuccess:f.getVerifyTokenVerfyEmail,url:"/v1/email/verify/send",type:"\u90AE\u7BB1",account:o.formVerfyEmail.email,title:"\u624B\u673A\u6362\u7ED1"},null,8,["onVerifysuccess","account"])]),_:1})])]),_:1}),i("div",K,[e(p,{class:"submit-btn primary-linear m-r",size:"default",loading:o.loading,type:"primary",onClick:t[4]||(t[4]=r=>f.verifyEmail())},{default:l(()=>[Q]),_:1},8,["loading"]),e(h,{class:"back ts-14",onClick:t[5]||(t[5]=r=>o.active--)},{default:l(()=>[R]),_:1})])]),_:1},8,["model"])):m("",!0),o.active==3?(c(),_(V,{key:2,ref:"form","label-position":"left","label-width":"140px",model:o.form,rules:o.rule},{default:l(()=>[e(u,{prop:"email",label:"\u8BF7\u8F93\u5165\u65B0\u90AE\u7BB1\u53F7"},{default:l(()=>[e(d,{size:"default",type:"text",prefix:"ios-at-outline",modelValue:o.form.email,"onUpdate:modelValue":t[6]||(t[6]=r=>o.form.email=r),placeholder:"\u8BF7\u8F93\u5165\u65B0\u90AE\u7BB1\u53F7"},null,8,["modelValue"])]),_:1}),e(u,{prop:"verify",label:"\u9A8C\u8BC1\u7801"},{default:l(()=>[i("div",W,[e(d,{class:"m-r",size:"default",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:o.form.verify,"onUpdate:modelValue":t[7]||(t[7]=r=>o.form.verify=r),placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),e(p,{type:"primary",size:"default"},{default:l(()=>[e(b,{onVerifysuccess:f.getVerifyToken,url:"/v1/email/verify/send",type:"\u90AE\u7BB1",verifyUser:1,account:o.form.email,title:"\u90AE\u7BB1\u6362\u7ED1"},null,8,["onVerifysuccess","account"])]),_:1})])]),_:1}),o.verifyList.indexOf("mobile")>=0?(c(),_(u,{key:0,prop:"mobileVerify"},{default:l(()=>[e(d,{size:"large",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:o.form.mobileVerify,"onUpdate:modelValue":t[8]||(t[8]=r=>o.form.mobileVerify=r),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u9A8C\u8BC1\u7801"},{default:l(()=>[e(b,{slot:"append",onVerifysuccess:f.getMobileVerifyToken,url:"/v1/sms/verify/send",type:"\u624B\u673A\u53F7",noNeedAccount:!0,title:"\u90AE\u7BB1\u6362\u7ED1"},null,8,["onVerifysuccess"])]),_:1},8,["modelValue"])]),_:1})):m("",!0),o.verifyList.indexOf("gauth")>=0?(c(),_(u,{key:1,prop:"gauth"},{default:l(()=>[e(d,{size:"large",type:"password",prefix:"ios-lock-outline",modelValue:o.form.gauth,"onUpdate:modelValue":t[9]||(t[9]=r=>o.form.gauth=r),placeholder:"\u8BF7\u8F93\u5165\u8C37\u6B4C\u9A8C\u8BC1\u7801"},null,8,["modelValue"])]),_:1})):m("",!0),o.verifyList.indexOf("password")>=0?(c(),_(u,{key:2,prop:"password"},{default:l(()=>[e(d,{size:"large",type:"password",prefix:"ios-lock-outline",modelValue:o.form.password,"onUpdate:modelValue":t[10]||(t[10]=r=>o.form.password=r),placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"},null,8,["modelValue"])]),_:1})):m("",!0),i("div",X,[e(p,{class:"submit-btn primary-linear m-r",size:"default",loading:o.loading,type:"primary",onClick:t[11]||(t[11]=r=>f.handleSubmit("form"))},{default:l(()=>[Y]),_:1},8,["loading"]),e(h,{class:"back ts-14",onClick:t[12]||(t[12]=r=>o.active--)},{default:l(()=>[Z]),_:1})])]),_:1},8,["model","rules"])):m("",!0),o.active==4?(c(),w("div",$,[ee,i("div",te,[e(E,{to:"/user/login"},{default:l(()=>[e(p,{class:"primary-linear",size:"small",type:"primary",round:""},{default:l(()=>[oe]),_:1})]),_:1})])])):m("",!0)])]),e(T,{class:"p-l-md p-b",type:"primary"},{default:l(()=>[le,ie]),_:1})])])}var de=z(N,[["render",se],["__scopeId","data-v-315c5947"]]);export{de as default};
