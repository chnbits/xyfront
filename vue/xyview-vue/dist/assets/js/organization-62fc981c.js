import{_ as P}from"../index-726dc959.js";const D={name:"productcer",components:{},data(){var o,e,a,d,s;return{loading:!1,regionInit:{showInput:!1,labelField:"name",valueField:"name",deep:1,maxLevel:3,nodeKey:"id",lazy:!0,action:"/v1/region/region/lists"},certTypeList:[{title:"\u8425\u4E1A\u6267\u7167",value:5},{title:"\u7EC4\u7EC7\u673A\u6784\u8BC1\u4E66",value:6},{title:"\u5176\u5B83\u8BC1\u7167",value:9}],sizeLimit:2,options:{type:"image",drag:!0,driver:this.$store.state.app.uploadDriver,signUrl:"",icon:"",placeholder:"",action:"",format:"jpg,png",maxSize:1024*this.sizeLimit,hasUploadModule:!0},change:(e=(o=this.$route)==null?void 0:o.query)!=null&&e.change?this.$route.query.change:"",countryCode:(a=this.$store.state.user.userInfo.mobile)==null?void 0:a.identityGroup,mobile:(d=this.$store.state.user.userInfo.mobile)==null?void 0:d.identifier,email:(s=this.$store.state.user.userInfo.email)==null?void 0:s.identifier,mobileVerify:{countryCode:"+86",mobile:"",verify:"",token:""},emailVerify:{email:"",verify:"",token:""},form:{country:"86",certCate:2,certType:5,realName:"",certNo:"",certPhoto:"",city:[],address:""},mobileHelpUpload:!1,mobileHelpUploadId:"",mobileHelpUploadUrl:"",mobileHelpUploadTimer:null}},created(){this.mobile&&(this.mobileVerify.countryCode=this.countryCode,this.mobileVerify.mobile=this.mobile),this.email&&(this.emailVerify.email=this.email),this.loadData();var o=new Date;this.mobileHelpUploadId=o.getTime(),this.mobileHelpUploadUrl=this.$util.baseDomain()+"/user_cert/cert/mobileUpload?cate=2&id="+this.mobileHelpUploadId},watch:{"form.certPhoto":{handler(o){this.getOcrInfo("FRONT",o)},deep:!0,immediate:!1}},methods:{async getOcrInfo(o,e){if(!e)return;let a={};switch(this.form.certCate){case 1:a.side=o,a.url=e;break;case 2:a.url=e;break}let d=await this.$util.request({url:"/v1/user_cert/cert/getOcrInfo",data:{certCate:this.form.certCate,...a},method:"post"});d.code==200&&(this.form.realName=d.data.realName,this.form.certNo=d.data.certNo)},onCountrySelect({name:o,iso2:e,dialCode:a}){this.mobileVerify.countryCode="+"+a},getMobileVerifyToken(o){this.mobileVerify.token=o.token},getEmailVerifyToken(o){this.emailVerify.token=o.token},mobileUpload(){this.mobileHelpUpload=!0,this.mobileHelpUploadTimer=setInterval(this.syncMobileUploadStatue,3e3)},async syncMobileUploadStatue(){let o=await this.$util.request({url:"/v1/core/index/cache",data:{id:this.mobileHelpUploadId},method:"get"});o.code==200&&o.data.info&&(this.form.certPhoto=o.data.info.certPhotoOrg)},async loadData(){if(this.change)return;this.loading=!0;let o=await this.$util.request({url:"/v1/user_cert/cert/my",data:{},method:"get"});o.code==200?o.data.info&&o.data.info.certCate==this.form.certCate&&(this.form=o.data.info):this.$util.showToast({title:o.msg,icon:"loading",duration:3e3}),this.loading=!1},cofirm(){this.$confirm('\u786E\u5B9A\u4F7F\u7528\u8BE5\u4FE1\u606F\uFF08<span style="color: var(--primary-color)">'+this.form.realName+"  "+this.form.certNo+'</span>\uFF09\u8FDB\u884C\u5B9E\u540D\uFF1F\u8BF7\u786E\u4FDD\u60A8\u5177\u6709\u8BE5\u7EC4\u7EC7\u673A\u6784<span style="color: var(--primary-color)">\u94F6\u884C\u8D26\u6237\u8D22\u52A1\u6743\u9650</span>\uFF0C\u5426\u5219\u4E0B\u4E00\u6B65\u53EF\u80FD\u65E0\u6CD5\u8FDB\u884C\u9A8C\u8BC1',"\u786E\u5B9A\u8981\u4F7F\u7528\u8BE5\u4FE1\u606F\u8FDB\u884C\u8BA4\u8BC1\u7801\uFF1F",{distinguishCancelAndClose:!0,confirmButtonText:"\u6211\u5F88\u786E\u5B9A",cancelButtonText:"\u8FD4\u56DE\u4FEE\u6539",dangerouslyUseHTMLString:!0}).then(()=>{this.handleSubmit()}).catch(o=>{})},async handleSubmit(){var a,d;this.form.change=this.change,!this.email&&this.$xyutil.hasExt("reg_email")&&(this.form.emailVerify=this.emailVerify),!this.mobile&&this.$xyutil.hasExt("reg_mobile")&&(this.form.mobileVerify=this.mobileVerify),this.loading=!0;let o=this;setTimeout(function(){o.loading=!1},5e3);let e=await this.$util.request({url:((a=this.form)==null?void 0:a.id)&&!this.change?"/v1/user_cert/cert/edit":"/v1/user_cert/cert/add",data:this.form,method:((d=this.form)==null?void 0:d.id)&&!this.change?"put":"post"});e.code=="200"?(this.$util.showToast({title:e.msg,icon:"success",duration:2e3}),window.location.href="/user_cert/faceid/organization"):this.$util.showToast({title:e.msg,icon:"loading",duration:3e3}),this.loading=!1}}},u=window.Vue.createTextVNode,n=window.Vue.resolveComponent,i=window.Vue.withCtx,l=window.Vue.createVNode,t=window.Vue.createElementVNode,b=window.Vue.toDisplayString,f=window.Vue.openBlock,g=window.Vue.createBlock,h=window.Vue.createCommentVNode,U=window.Vue.Fragment,x=window.Vue.createElementBlock,L=window.Vue.pushScopeId,M=window.Vue.popScopeId,c=o=>(L("data-v-40e7bcfc"),o=o(),M(),o),O={class:"bg-white p-t p-b"},F=u("\u4E2A\u4EBA\u8BBE\u7F6E"),j=u("\u7EC4\u7EC7\u5B9E\u540D\u8BA4\u8BC1"),G={class:"content p-a-md m-t-lg"},A=c(()=>t("h3",{class:"m-b-md ts-22 text-center"},"\u8BF7\u586B\u5199\u7EC4\u7EC7\u4FE1\u606F",-1)),J=c(()=>t("div",{class:"m-b-lg text-666 text-left flex space-center"},[t("p",{class:"lh-1-6 ts-14",style:{"max-width":"500px"}},[u(" \u9002\u7528\u4F01\u4E1A\u3001\u653F\u5E9C\u3001\u4E8B\u4E1A\u5355\u4F4D\u3001\u5B66\u6821\u3001\u7EC4\u7EC7\u7B49\uFF0C\u8D26\u53F7\u5F52\u5C5E\u4E8E\u4F01\u4E1A\u3002\u4F01\u4E1A\u8BA4\u8BC1\u540E\uFF0C\u4EA7\u751F\u6D88\u8D39\u65F6\uFF0C\u652F\u6301\u5F00\u5177"),t("span",null,"\u666E\u7968\u548C\u4E13\u7968")])],-1)),K=u(" \u8BC1\u4EF6\u7C7B\u578B "),R=c(()=>t("i",{class:"xyicon xyicon-help-o ts-14 cursor-pointer"},null,-1)),Q={class:"p-t p-b p-l p-r flex space-between flex-alignCenter"},W={class:"ts-14"},X=c(()=>t("p",null,null,-1)),Y={class:"flex justify-between w-full"},Z=u(" \u8BC1\u4EF6\u7167\u7247 "),$=c(()=>t("i",{class:"xyicon xyicon-help-o ts-14 cursor-pointer"},null,-1)),ee={class:"flex flex-alignCenter flex-center",style:{width:"120px",height:"120px",background:"#05B9CF"}},te=c(()=>t("span",null,null,-1)),oe=c(()=>t("i",{class:"xyicon xyicon-plus",style:{"font-size":"48px",color:"#E1E1E1","margin-top":"18px","margin-bottom":"20px"}},null,-1)),le=c(()=>t("span",null,"\u4E0A\u4F20\u8425\u4E1A\u6267\u7167/\u7EC4\u7EC7\u673A\u6784\u7167\u7247",-1)),ie={class:"tips lh-1-6 m-t-xs"},se={class:"text-error ts-12"},re=u(" \u8BC1\u7167\u4EE3\u7801 "),ne=c(()=>t("i",{class:"xyicon xyicon-help-o ts-14 cursor-pointer"},null,-1)),ae=u("\u4FEE\u6539\u624B\u673A\u53F7"),ce={class:"flex"},de=u("\u4FEE\u6539\u90AE\u7BB1"),me={class:"flex"},ue={class:"m-t-lg flex space-between"},pe={class:"m-r"},fe=u("\u4E0A\u4E00\u6B65"),_e=u(" \u4E0B\u4E00\u6B65 "),he={class:"help p-l-lg p-r-lg p-t-md"},ye={class:"lh-1-6 ts-14"},be=c(()=>t("li",null,"1. \u56E0\u7EC4\u7EC7\u6CA1\u6709\u624B\u673A\u53F7\uFF0C\u624B\u673A\u53F7\u7801\u7684\u5B9E\u540D\u4FE1\u606F\u5E94\u5F53\u4E3A\u4F01\u4E1A\u5B9E\u9645\u6388\u6743\u7684\u5458\u5DE5\uFF1B ",-1)),ge=c(()=>t("li",null,"3. \u9700\u8981\u5BF9\u8BC1\u4EF6\u73B0\u573A\u62CD\u7167\uFF0C\u4E14\u4FDD\u8BC1\u6587\u5B57\u548C\u56FE\u7247\u3001\u4EBA\u50CF\u56E2\u7B49\u62CD\u6444\u6E05\u6670\u53EF\u89C1",-1));function Ve(o,e,a,d,s,_){const v=n("el-breadcrumb-item"),C=n("el-breadcrumb"),V=n("el-tooltip"),T=n("xy-choose"),m=n("el-form-item"),N=n("xy-qrcode"),I=n("el-popover"),z=n("xy-upload"),p=n("el-input"),S=n("xy-cascader"),q=n("xy-country-select"),w=n("router-link"),k=n("xy-send-verify"),y=n("el-button"),E=n("el-form"),H=n("el-col"),B=n("el-row");return f(),x("div",O,[l(C,{"separator-class":"el-icon-arrow-right",class:"p-l m-b"},{default:i(()=>[l(v,{to:{path:"/user/center"}},{default:i(()=>[F]),_:1}),l(v,null,{default:i(()=>[j]),_:1})]),_:1}),t("div",G,[A,J,l(B,{type:"flex",justify:"center",align:"middle"},{default:i(()=>[l(H,{xs:22,sm:12,md:10,lg:10,class:"login-box bg-white"},{default:i(()=>[l(E,{ref:"form",model:s.form,"label-position":"top"},{default:i(()=>[l(m,{prop:"certType",label:"",required:""},{label:i(()=>[K,l(V,{class:"item",effect:"dark",content:"\u975E\u8425\u4E1A\u6267\u7167\u6307\u7684\u662F\u7EC4\u7EC7\u673A\u6784\u8BC1\u7B49\u975E\u8425\u4E1A\u6267\u7167\u7C7B\u578B\u7684\u7EC4\u7EC7\u8BC1\u7167\u3002",placement:"top","popper-class":"bottomStartTooltop"},{default:i(()=>[R]),_:1})]),default:i(()=>[l(T,{options:s.certTypeList,modelValue:s.form.certType,"onUpdate:modelValue":e[0]||(e[0]=r=>s.form.certType=r)},{default:i(r=>[t("div",Q,[t("div",null,[t("h5",W,b(r.title),1),X])])]),_:1},8,["options","modelValue"])]),_:1}),l(m,{prop:"certPhoto",label:"",required:""},{default:i(()=>[t("div",Y,[t("span",null,[Z,l(V,{class:"item",effect:"dark",content:"\u8BC1\u4EF6\u7167\u7247\u4E00\u822C\u4E3A\u8425\u4E1A\u6267\u7167\u3001\u7EC4\u7EC7\u673A\u6784\u8BC1\u7B49\u7B49",placement:"top","popper-class":"bottomStartTooltop"},{default:i(()=>[$]),_:1})]),l(I,{placement:"top-start",title:"\u624B\u673A\u8F85\u52A9\u4E0A\u4F20",width:"120px",trigger:"click"},{reference:i(()=>[t("span",{onClick:e[1]||(e[1]=(...r)=>_.mobileUpload&&_.mobileUpload(...r)),class:"cursor-pointer ts-14 m-l-lg hidden"},"\u624B\u673A\u8F85\u52A9\u4E0A\u4F20")]),default:i(()=>[t("div",ee,[l(N,{class:"qrcode",style:{opacity:1},value:s.mobileHelpUploadUrl,options:{width:120}},null,8,["value"])])]),_:1})]),t("div",null,[l(z,{options:s.options,header:{},modelValue:s.form.certPhoto,"onUpdate:modelValue":e[2]||(e[2]=r=>s.form.certPhoto=r)},{drag:i(()=>[te,oe,le]),_:1},8,["options","modelValue"])]),t("div",ie,[t("p",null,[t("span",se,"(\u4E0A\u4F20\u8425\u4E1A\u6267\u7167\u540E\uFF0C\u7CFB\u7EDF\u53EF\u80FD\u4F1A\u53D1\u9001\u8BC1\u7167\u7ED9\u7B2C\u4E09\u65B9\u63A5\u53E3\u7528\u4E8E\u81EA\u52A8\u8BC6\u522B\u586B\u5199\u4F01\u4E1A\u540D\u79F0\u548C\u673A\u6784\u4EE3\u7801) \u53EF\u4EE5\u6DFB\u52A0\u6C34\u5370\uFF0C\u5982\uFF1A\u4EC5\u9650"+b(o.$store.state.app.siteInfo.title)+"\u5B9E\u540D\u8BA4\u8BC1\u4F7F\u7528\uFF0C\u6CE8\u610F\u4E0D\u8981\u906E\u6321\u6587\u5B57\u548C\u56FE\u6848\u3002 ",1)])])]),_:1}),l(m,{prop:"realName",label:"\u7EC4\u7EC7\u540D\u79F0",required:""},{default:i(()=>[l(p,{size:"large",type:"text",prefix:"ios-lock-outline",modelValue:s.form.realName,"onUpdate:modelValue":e[3]||(e[3]=r=>s.form.realName=r),placeholder:"\u8BF7\u8F93\u5165\u8BC1\u4EF6\u4E0A\u7684\u771F\u5B9E\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(m,{prop:"certNo",label:"",required:""},{label:i(()=>[re,l(V,{class:"item",effect:"dark",content:"\u8BC1\u7167\u4EE3\u7801\u6307\u7684\u662F\u8425\u4E1A\u6267\u7167\u7684\u7EDF\u4E00\u4FE1\u7528\u4EE3\u7801\u6216\u8005\u7EC4\u7EC7\u673A\u6784\u4EE3\u7801\u7B49\u8BC1\u7167\u4E0A\u7684\u552F\u4E00\u4EE3\u7801\u3002",placement:"top","popper-class":"bottomStartTooltop"},{default:i(()=>[ne]),_:1})]),default:i(()=>[l(p,{size:"large",type:"text",modelValue:s.form.certNo,"onUpdate:modelValue":e[4]||(e[4]=r=>s.form.certNo=r),placeholder:"\u8BF7\u8F93\u5165\u8BC1\u4EF6\u4E0A\u7684\u7EDF\u4E00\u793E\u4F1A\u4FE1\u7528\u4EE3\u7801\u6216\u7EC4\u7EC7\u673A\u6784\u4EE3\u7801"},null,8,["modelValue"])]),_:1}),l(m,{prop:"city",label:"\u8054\u7CFB\u5730\u5740",required:""},{default:i(()=>[l(S,{init:s.regionInit,modelValue:s.form.city,"onUpdate:modelValue":e[5]||(e[5]=r=>s.form.city=r)},null,8,["init","modelValue"])]),_:1}),l(m,{prop:"address",label:"",required:""},{default:i(()=>[l(p,{size:"large",type:"text",modelValue:s.form.address,"onUpdate:modelValue":e[6]||(e[6]=r=>s.form.address=r),placeholder:"\u8BF7\u8F93\u5165\u8BE6\u7EC6\u7684\u8054\u7CFB\u5730\u5740"},null,8,["modelValue"])]),_:1}),o.$util.hasExt("reg_mobile")?(f(),x(U,{key:0},[l(m,{prop:"mobile",label:"\u624B\u673A\u53F7\u9A8C\u8BC1",required:""},{default:i(()=>[l(p,{size:"large",type:"text",prefix:"ios-person-outline",disabled:!!this.mobile,modelValue:s.mobileVerify.mobile,"onUpdate:modelValue":e[7]||(e[7]=r=>s.mobileVerify.mobile=r),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u624B\u673A\u53F7\u7801"},{prepend:i(()=>[l(q,{defaultCountry:"CN",enabledCountryCode:"",onOnSelect:_.onCountrySelect},null,8,["onOnSelect"])]),_:1},8,["disabled","modelValue"]),t("div",null,[this.mobile?(f(),g(w,{key:0,to:"/reg_mobile/user/change",class:"ts-12"},{default:i(()=>[ae]),_:1})):h("",!0)])]),_:1}),this.mobile?h("",!0):(f(),g(m,{key:0,prop:"verify"},{default:i(()=>[t("div",null,[t("div",ce,[l(p,{size:"large",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:s.mobileVerify.verify,"onUpdate:modelValue":e[8]||(e[8]=r=>s.mobileVerify.verify=r),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),l(y,{type:"primary",size:"large",class:"m-l-md"},{default:i(()=>[l(k,{onVerifysuccess:_.getMobileVerifyToken,url:"/v1/sms/verify/send",type:"\u624B\u673A\u53F7",account:"mobileVerify.mobile",title:"\u624B\u673A\u7ED1\u5B9A"},null,8,["onVerifysuccess"])]),_:1})])])]),_:1}))],64)):h("",!0),o.$util.hasExt("reg_email")?(f(),x(U,{key:1},[l(m,{prop:"email",label:"\u90AE\u7BB1\u9A8C\u8BC1",required:""},{default:i(()=>[l(p,{size:"large",type:"text",prefix:"ios-person-outline",disabled:!!this.email,modelValue:s.emailVerify.email,"onUpdate:modelValue":e[9]||(e[9]=r=>s.emailVerify.email=r),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u8D26\u53F7"},null,8,["disabled","modelValue"]),t("div",null,[this.email?(f(),g(w,{key:0,to:"/reg_email/user/change",class:"ts-12"},{default:i(()=>[de]),_:1})):h("",!0)])]),_:1}),this.email?h("",!0):(f(),g(m,{key:0,prop:"verify"},{default:i(()=>[t("div",null,[t("div",me,[l(p,{size:"large",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:s.mobileVerify.verify,"onUpdate:modelValue":e[10]||(e[10]=r=>s.mobileVerify.verify=r),placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),l(y,{type:"primary",size:"large",class:"m-l-md"},{default:i(()=>[l(k,{onVerifysuccess:_.getEmailVerifyToken,url:"/v1/email/verify/send",type:"\u90AE\u7BB1",account:"emailVerify.mobile",title:"\u90AE\u7BB1\u7ED1\u5B9A"},null,8,["onVerifysuccess"])]),_:1})])])]),_:1}))],64)):h("",!0),t("div",ue,[t("div",pe,[l(y,{class:"full",size:"large",onClick:e[11]||(e[11]=r=>o.$router.back(-1))},{default:i(()=>[fe]),_:1})]),l(y,{class:"full submit-btn m-b-lg",size:"large",loading:s.loading,type:"primary",onClick:e[12]||(e[12]=r=>_.cofirm())},{default:i(()=>[_e]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1}),t("div",he,[t("ul",ye,[be,t("li",null,"2. \u4E0A\u4F20\u5355\u5F20\u7167\u7247\u5927\u5C0F\u4E0D\u8D85\u8FC7"+b(s.sizeLimit)+"MB\uFF0C\u652F\u6301PNG\u3001JPG\u683C\u5F0F\uFF1B",1),ge,t("li",null,"4. \u652F\u6301\u5BF9\u7167\u7247\u6DFB\u52A0\u52A0\u6C34\u5370\uFF0C\u5982\u6DFB\u52A0\u6C34\u5370\u6587\u5B57\uFF1A\u4EC5\u9650"+b(o.$store.state.app.siteInfo.title)+"\u5B9E\u540D\u8BA4\u8BC1\u4F7F\u7528\uFF0C\u6CE8\u610F\u4E0D\u8981\u906E\u6321\u6587\u5B57\u548C\u56FE\u6848\u3002",1)])])])])}var ve=P(D,[["render",Ve],["__scopeId","data-v-40e7bcfc"]]);export{ve as default};
