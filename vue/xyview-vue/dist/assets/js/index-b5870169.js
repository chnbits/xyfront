import{c as commonjsGlobal,e as commonjsRequire}from"../index-91ea30ae.js";function _mergeNamespaces(e,n){return n.forEach(function(t){t&&typeof t!="string"&&!Array.isArray(t)&&Object.keys(t).forEach(function(i){if(i!=="default"&&!(i in e)){var o=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,o.get?o:{enumerable:!0,get:function(){return t[i]}})}})}),Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var md5$1={exports:{}};(function(module){(function(){var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_MD5_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=commonjsGlobal:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&!0&&module.exports,ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}(root.JS_MD5_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(e){return typeof e=="object"&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(e){return function(n,t){return new Md5(!0).update(n,t)[e]()}},createMethod=function(){var e=createOutputMethod("hex");NODE_JS&&(e=nodeWrap(e)),e.getCtx=e.create=function(){return new Md5},e.update=function(i){return e.create().update(i)};for(var n=0;n<OUTPUT_TYPES.length;++n){var t=OUTPUT_TYPES[n];e[t]=createOutputMethod(t)}return e},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if(typeof e=="string")return crypto.createHash("md5").update(e,"utf8").digest("hex");if(e==null)throw ERROR;return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash("md5").update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod};function Md5(e){if(e)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var n=new ArrayBuffer(68);this.buffer8=new Uint8Array(n),this.blocks=new Uint32Array(n)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(e,n){if(!this.finalized){for(var t,i=0,o,r=e.length,s=this.blocks,u=this.buffer8;i<r;){if(this.hashed&&(this.hashed=!1,s[0]=s[16],s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),ARRAY_BUFFER)for(o=this.start;i<r&&o<64;++i)t=e.charCodeAt(i),n||t<128?u[o++]=t:t<2048?(u[o++]=192|t>>6,u[o++]=128|t&63):t<55296||t>=57344?(u[o++]=224|t>>12,u[o++]=128|t>>6&63,u[o++]=128|t&63):(t=65536+((t&1023)<<10|e.charCodeAt(++i)&1023),u[o++]=240|t>>18,u[o++]=128|t>>12&63,u[o++]=128|t>>6&63,u[o++]=128|t&63);else for(o=this.start;i<r&&o<64;++i)t=e.charCodeAt(i),n||t<128?s[o>>2]|=t<<SHIFT[o++&3]:t<2048?(s[o>>2]|=(192|t>>6)<<SHIFT[o++&3],s[o>>2]|=(128|t&63)<<SHIFT[o++&3]):t<55296||t>=57344?(s[o>>2]|=(224|t>>12)<<SHIFT[o++&3],s[o>>2]|=(128|t>>6&63)<<SHIFT[o++&3],s[o>>2]|=(128|t&63)<<SHIFT[o++&3]):(t=65536+((t&1023)<<10|e.charCodeAt(++i)&1023),s[o>>2]|=(240|t>>18)<<SHIFT[o++&3],s[o>>2]|=(128|t>>12&63)<<SHIFT[o++&3],s[o>>2]|=(128|t>>6&63)<<SHIFT[o++&3],s[o>>2]|=(128|t&63)<<SHIFT[o++&3]);this.lastByteIndex=o,this.bytes+=o-this.start,o>=64?(this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,n=this.lastByteIndex;e[n>>2]|=EXTRA[n&3],n>=56&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var e,n,t,i,o,r,s=this.blocks;this.first?(e=s[0]-680876937,e=(e<<7|e>>>25)-271733879<<0,i=(-1732584194^e&2004318071)+s[1]-117830708,i=(i<<12|i>>>20)+e<<0,t=(-271733879^i&(e^-271733879))+s[2]-1126478375,t=(t<<17|t>>>15)+i<<0,n=(e^t&(i^e))+s[3]-1316259209,n=(n<<22|n>>>10)+t<<0):(e=this.h0,n=this.h1,t=this.h2,i=this.h3,e+=(i^n&(t^i))+s[0]-680876936,e=(e<<7|e>>>25)+n<<0,i+=(t^e&(n^t))+s[1]-389564586,i=(i<<12|i>>>20)+e<<0,t+=(n^i&(e^n))+s[2]+606105819,t=(t<<17|t>>>15)+i<<0,n+=(e^t&(i^e))+s[3]-1044525330,n=(n<<22|n>>>10)+t<<0),e+=(i^n&(t^i))+s[4]-176418897,e=(e<<7|e>>>25)+n<<0,i+=(t^e&(n^t))+s[5]+1200080426,i=(i<<12|i>>>20)+e<<0,t+=(n^i&(e^n))+s[6]-1473231341,t=(t<<17|t>>>15)+i<<0,n+=(e^t&(i^e))+s[7]-45705983,n=(n<<22|n>>>10)+t<<0,e+=(i^n&(t^i))+s[8]+1770035416,e=(e<<7|e>>>25)+n<<0,i+=(t^e&(n^t))+s[9]-1958414417,i=(i<<12|i>>>20)+e<<0,t+=(n^i&(e^n))+s[10]-42063,t=(t<<17|t>>>15)+i<<0,n+=(e^t&(i^e))+s[11]-1990404162,n=(n<<22|n>>>10)+t<<0,e+=(i^n&(t^i))+s[12]+1804603682,e=(e<<7|e>>>25)+n<<0,i+=(t^e&(n^t))+s[13]-40341101,i=(i<<12|i>>>20)+e<<0,t+=(n^i&(e^n))+s[14]-1502002290,t=(t<<17|t>>>15)+i<<0,n+=(e^t&(i^e))+s[15]+1236535329,n=(n<<22|n>>>10)+t<<0,e+=(t^i&(n^t))+s[1]-165796510,e=(e<<5|e>>>27)+n<<0,i+=(n^t&(e^n))+s[6]-1069501632,i=(i<<9|i>>>23)+e<<0,t+=(e^n&(i^e))+s[11]+643717713,t=(t<<14|t>>>18)+i<<0,n+=(i^e&(t^i))+s[0]-373897302,n=(n<<20|n>>>12)+t<<0,e+=(t^i&(n^t))+s[5]-701558691,e=(e<<5|e>>>27)+n<<0,i+=(n^t&(e^n))+s[10]+38016083,i=(i<<9|i>>>23)+e<<0,t+=(e^n&(i^e))+s[15]-660478335,t=(t<<14|t>>>18)+i<<0,n+=(i^e&(t^i))+s[4]-405537848,n=(n<<20|n>>>12)+t<<0,e+=(t^i&(n^t))+s[9]+568446438,e=(e<<5|e>>>27)+n<<0,i+=(n^t&(e^n))+s[14]-1019803690,i=(i<<9|i>>>23)+e<<0,t+=(e^n&(i^e))+s[3]-187363961,t=(t<<14|t>>>18)+i<<0,n+=(i^e&(t^i))+s[8]+1163531501,n=(n<<20|n>>>12)+t<<0,e+=(t^i&(n^t))+s[13]-1444681467,e=(e<<5|e>>>27)+n<<0,i+=(n^t&(e^n))+s[2]-51403784,i=(i<<9|i>>>23)+e<<0,t+=(e^n&(i^e))+s[7]+1735328473,t=(t<<14|t>>>18)+i<<0,n+=(i^e&(t^i))+s[12]-1926607734,n=(n<<20|n>>>12)+t<<0,o=n^t,e+=(o^i)+s[5]-378558,e=(e<<4|e>>>28)+n<<0,i+=(o^e)+s[8]-2022574463,i=(i<<11|i>>>21)+e<<0,r=i^e,t+=(r^n)+s[11]+1839030562,t=(t<<16|t>>>16)+i<<0,n+=(r^t)+s[14]-35309556,n=(n<<23|n>>>9)+t<<0,o=n^t,e+=(o^i)+s[1]-1530992060,e=(e<<4|e>>>28)+n<<0,i+=(o^e)+s[4]+1272893353,i=(i<<11|i>>>21)+e<<0,r=i^e,t+=(r^n)+s[7]-155497632,t=(t<<16|t>>>16)+i<<0,n+=(r^t)+s[10]-1094730640,n=(n<<23|n>>>9)+t<<0,o=n^t,e+=(o^i)+s[13]+681279174,e=(e<<4|e>>>28)+n<<0,i+=(o^e)+s[0]-358537222,i=(i<<11|i>>>21)+e<<0,r=i^e,t+=(r^n)+s[3]-722521979,t=(t<<16|t>>>16)+i<<0,n+=(r^t)+s[6]+76029189,n=(n<<23|n>>>9)+t<<0,o=n^t,e+=(o^i)+s[9]-640364487,e=(e<<4|e>>>28)+n<<0,i+=(o^e)+s[12]-421815835,i=(i<<11|i>>>21)+e<<0,r=i^e,t+=(r^n)+s[15]+530742520,t=(t<<16|t>>>16)+i<<0,n+=(r^t)+s[2]-995338651,n=(n<<23|n>>>9)+t<<0,e+=(t^(n|~i))+s[0]-198630844,e=(e<<6|e>>>26)+n<<0,i+=(n^(e|~t))+s[7]+1126891415,i=(i<<10|i>>>22)+e<<0,t+=(e^(i|~n))+s[14]-1416354905,t=(t<<15|t>>>17)+i<<0,n+=(i^(t|~e))+s[5]-57434055,n=(n<<21|n>>>11)+t<<0,e+=(t^(n|~i))+s[12]+1700485571,e=(e<<6|e>>>26)+n<<0,i+=(n^(e|~t))+s[3]-1894986606,i=(i<<10|i>>>22)+e<<0,t+=(e^(i|~n))+s[10]-1051523,t=(t<<15|t>>>17)+i<<0,n+=(i^(t|~e))+s[1]-2054922799,n=(n<<21|n>>>11)+t<<0,e+=(t^(n|~i))+s[8]+1873313359,e=(e<<6|e>>>26)+n<<0,i+=(n^(e|~t))+s[15]-30611744,i=(i<<10|i>>>22)+e<<0,t+=(e^(i|~n))+s[6]-1560198380,t=(t<<15|t>>>17)+i<<0,n+=(i^(t|~e))+s[13]+1309151649,n=(n<<21|n>>>11)+t<<0,e+=(t^(n|~i))+s[4]-145523070,e=(e<<6|e>>>26)+n<<0,i+=(n^(e|~t))+s[11]-1120210379,i=(i<<10|i>>>22)+e<<0,t+=(e^(i|~n))+s[2]+718787259,t=(t<<15|t>>>17)+i<<0,n+=(i^(t|~e))+s[9]-343485551,n=(n<<21|n>>>11)+t<<0,this.first?(this.h0=e+1732584193<<0,this.h1=n-271733879<<0,this.h2=t-1732584194<<0,this.h3=i+271733878<<0,this.first=!1):(this.h0=this.h0+e<<0,this.h1=this.h1+n<<0,this.h2=this.h2+t<<0,this.h3=this.h3+i<<0)},Md5.prototype.hex=function(){this.finalize();var e=this.h0,n=this.h1,t=this.h2,i=this.h3;return HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(e){if(e==="hex")return this.hex();this.finalize();var n=this.h0,t=this.h1,i=this.h2,o=this.h3,r=[n&255,n>>8&255,n>>16&255,n>>24&255,t&255,t>>8&255,t>>16&255,t>>24&255,i&255,i>>8&255,i>>16&255,i>>24&255,o&255,o>>8&255,o>>16&255,o>>24&255];return r},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),n=new Uint32Array(e);return n[0]=this.h0,n[1]=this.h1,n[2]=this.h2,n[3]=this.h3,e},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var e,n,t,i="",o=this.array(),r=0;r<15;)e=o[r++],n=o[r++],t=o[r++],i+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[(e<<4|n>>>4)&63]+BASE64_ENCODE_CHAR[(n<<2|t>>>6)&63]+BASE64_ENCODE_CHAR[t&63];return e=o[r],i+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[e<<4&63]+"==",i};var exports=createMethod();COMMON_JS?module.exports=exports:root.md5=exports})()})(md5$1);var crypto={exports:{}};(function(e){var n=n||function(t,i){var o={},r=o.lib={},s=function(){},u=r.Base={extend:function(g){s.prototype=this;var h=new s;return g&&h.mixIn(g),h.hasOwnProperty("init")||(h.init=function(){h.$super.init.apply(this,arguments)}),h.init.prototype=h,h.$super=this,h},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var h in g)g.hasOwnProperty(h)&&(this[h]=g[h]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}},c=r.WordArray=u.extend({init:function(g,h){g=this.words=g||[],this.sigBytes=h!=i?h:4*g.length},toString:function(g){return(g||d).stringify(this)},concat:function(g){var h=this.words,C=g.words,v=this.sigBytes;if(g=g.sigBytes,this.clamp(),v%4)for(var y=0;y<g;y++)h[v+y>>>2]|=(C[y>>>2]>>>24-8*(y%4)&255)<<24-8*((v+y)%4);else if(65535<C.length)for(y=0;y<g;y+=4)h[v+y>>>2]=C[y>>>2];else h.push.apply(h,C);return this.sigBytes+=g,this},clamp:function(){var g=this.words,h=this.sigBytes;g[h>>>2]&=4294967295<<32-8*(h%4),g.length=t.ceil(h/4)},clone:function(){var g=u.clone.call(this);return g.words=this.words.slice(0),g},random:function(g){for(var h=[],C=0;C<g;C+=4)h.push(4294967296*t.random()|0);return new c.init(h,g)}}),l=o.enc={},d=l.Hex={stringify:function(g){var h=g.words;g=g.sigBytes;for(var C=[],v=0;v<g;v++){var y=h[v>>>2]>>>24-8*(v%4)&255;C.push((y>>>4).toString(16)),C.push((y&15).toString(16))}return C.join("")},parse:function(g){for(var h=g.length,C=[],v=0;v<h;v+=2)C[v>>>3]|=parseInt(g.substr(v,2),16)<<24-4*(v%8);return new c.init(C,h/2)}},a=l.Latin1={stringify:function(g){var h=g.words;g=g.sigBytes;for(var C=[],v=0;v<g;v++)C.push(String.fromCharCode(h[v>>>2]>>>24-8*(v%4)&255));return C.join("")},parse:function(g){for(var h=g.length,C=[],v=0;v<h;v++)C[v>>>2]|=(g.charCodeAt(v)&255)<<24-8*(v%4);return new c.init(C,h)}},f=l.Utf8={stringify:function(g){try{return decodeURIComponent(escape(a.stringify(g)))}catch{throw Error("Malformed UTF-8 data")}},parse:function(g){return a.parse(unescape(encodeURIComponent(g)))}},p=r.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(g){typeof g=="string"&&(g=f.parse(g)),this._data.concat(g),this._nDataBytes+=g.sigBytes},_process:function(g){var h=this._data,C=h.words,v=h.sigBytes,y=this.blockSize,R=v/(4*y),R=g?t.ceil(R):t.max((R|0)-this._minBufferSize,0);if(g=R*y,v=t.min(4*g,v),g){for(var T=0;T<g;T+=y)this._doProcessBlock(C,T);T=C.splice(0,g),h.sigBytes-=v}return new c.init(T,v)},clone:function(){var g=u.clone.call(this);return g._data=this._data.clone(),g},_minBufferSize:0});r.Hasher=p.extend({cfg:u.extend(),init:function(g){this.cfg=this.cfg.extend(g),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(g){return this._append(g),this._process(),this},finalize:function(g){return g&&this._append(g),this._doFinalize()},blockSize:16,_createHelper:function(g){return function(h,C){return new g.init(C).finalize(h)}},_createHmacHelper:function(g){return function(h,C){return new S.HMAC.init(g,C).finalize(h)}}});var S=o.algo={};return o}(Math);(function(){var t=n,s=t.lib,i=s.WordArray,o=s.Hasher,r=[],s=t.algo.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,c){for(var l=this._hash.words,d=l[0],a=l[1],f=l[2],p=l[3],S=l[4],g=0;80>g;g++){if(16>g)r[g]=u[c+g]|0;else{var h=r[g-3]^r[g-8]^r[g-14]^r[g-16];r[g]=h<<1|h>>>31}h=(d<<5|d>>>27)+S+r[g],h=20>g?h+((a&f|~a&p)+1518500249):40>g?h+((a^f^p)+1859775393):60>g?h+((a&f|a&p|f&p)-1894007588):h+((a^f^p)-899497514),S=p,p=f,f=a<<30|a>>>2,a=d,d=h}l[0]=l[0]+d|0,l[1]=l[1]+a|0,l[2]=l[2]+f|0,l[3]=l[3]+p|0,l[4]=l[4]+S|0},_doFinalize:function(){var u=this._data,c=u.words,l=8*this._nDataBytes,d=8*u.sigBytes;return c[d>>>5]|=128<<24-d%32,c[(d+64>>>9<<4)+14]=Math.floor(l/4294967296),c[(d+64>>>9<<4)+15]=l,u.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var u=o.clone.call(this);return u._hash=this._hash.clone(),u}});t.SHA1=o._createHelper(s),t.HmacSHA1=o._createHmacHelper(s)})(),function(){var t=n,i=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(o,r){o=this._hasher=new o.init,typeof r=="string"&&(r=i.parse(r));var s=o.blockSize,u=4*s;r.sigBytes>u&&(r=o.finalize(r)),r.clamp();for(var c=this._oKey=r.clone(),l=this._iKey=r.clone(),d=c.words,a=l.words,f=0;f<s;f++)d[f]^=1549556828,a[f]^=909522486;c.sigBytes=l.sigBytes=u,this.reset()},reset:function(){var o=this._hasher;o.reset(),o.update(this._iKey)},update:function(o){return this._hasher.update(o),this},finalize:function(o){var r=this._hasher;return o=r.finalize(o),r.reset(),r.finalize(this._oKey.clone().concat(o))}})}(),function(){var t=n,i=t.lib,o=i.WordArray,r=t.enc;r.Base64={stringify:function(s){var u=s.words,c=s.sigBytes,l=this._map;s.clamp();for(var d=[],a=0;a<c;a+=3)for(var f=u[a>>>2]>>>24-a%4*8&255,p=u[a+1>>>2]>>>24-(a+1)%4*8&255,S=u[a+2>>>2]>>>24-(a+2)%4*8&255,g=f<<16|p<<8|S,h=0;h<4&&a+h*.75<c;h++)d.push(l.charAt(g>>>6*(3-h)&63));var C=l.charAt(64);if(C)for(;d.length%4;)d.push(C);return d.join("")},parse:function(s){var u=s.length,c=this._map,l=c.charAt(64);if(l){var d=s.indexOf(l);d!=-1&&(u=d)}for(var a=[],f=0,p=0;p<u;p++)if(p%4){var S=c.indexOf(s.charAt(p-1))<<p%4*2,g=c.indexOf(s.charAt(p))>>>6-p%4*2;a[f>>>2]|=(S|g)<<24-f%4*8,f++}return o.create(a,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.exports=n})(crypto);var domParser={},sax={},nameStartChar=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameChar=new RegExp("[\\-\\.0-9"+nameStartChar.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),tagNamePattern=new RegExp("^"+nameStartChar.source+nameChar.source+"*(?::"+nameStartChar.source+nameChar.source+"*)?$"),S_TAG=0,S_ATTR=1,S_ATTR_SPACE=2,S_EQ=3,S_ATTR_NOQUOT_VALUE=4,S_ATTR_END=5,S_TAG_SPACE=6,S_TAG_CLOSE=7;function XMLReader$1(){}XMLReader$1.prototype={parse:function(e,n,t){var i=this.domBuilder;i.startDocument(),_copy(n,n={}),parse(e,n,t,i,this.errorHandler),i.endDocument()}};function parse(e,n,t,i,o){function r(k){if(k>65535){k-=65536;var O=55296+(k>>10),w=56320+(k&1023);return String.fromCharCode(O,w)}else return String.fromCharCode(k)}function s(k){var O=k.slice(1,-1);return O in t?t[O]:O.charAt(0)==="#"?r(parseInt(O.substr(1).replace("x","0x"))):(o.error("entity not found:"+k),k)}function u(k){if(k>g){var O=e.substring(g,k).replace(/&#?\w+;/g,s);f&&c(g),i.characters(O,0,k-g),g=k}}function c(k,O){for(;k>=d&&(O=a.exec(e));)l=O.index,d=l+O[0].length,f.lineNumber++;f.columnNumber=k-l+1}for(var l=0,d=0,a=/.*(?:\r\n?|\n)|.*$/g,f=i.locator,p=[{currentNSMap:n}],S={},g=0;;){try{var h=e.indexOf("<",g);if(h<0){if(!e.substr(g).match(/^\s*$/)){var C=i.doc,v=C.createTextNode(e.substr(g));C.appendChild(v),i.currentElement=v}return}switch(h>g&&u(h),e.charAt(h+1)){case"/":var A=e.indexOf(">",h+3),y=e.substring(h+2,A),R=p.pop();A<0?(y=e.substring(h+2).replace(/[\s<].*/,""),o.error("end tag name: "+y+" is not complete:"+R.tagName),A=h+1+y.length):y.match(/\s</)&&(y=y.replace(/[\s<].*/,""),o.error("end tag name: "+y+" maybe not complete"),A=h+1+y.length);var T=R.localNSMap,E=R.tagName==y,m=E||R.tagName&&R.tagName.toLowerCase()==y.toLowerCase();if(m){if(i.endElement(R.uri,R.localName,y),T)for(var x in T)i.endPrefixMapping(x);E||o.fatalError("end tag name: "+y+" is not match the current start tagName:"+R.tagName)}else p.push(R);A++;break;case"?":f&&c(h),A=parseInstruction(e,h,i);break;case"!":f&&c(h),A=parseDCC(e,h,i,o);break;default:f&&c(h);var _=new ElementAttributes,B=p[p.length-1].currentNSMap,A=parseElementStartPart(e,h,_,B,s,o),D=_.length;if(!_.closed&&fixSelfClosed(e,A,_.tagName,S)&&(_.closed=!0,t.nbsp||o.warning("unclosed xml attribute")),f&&D){for(var N=copyLocator(f,{}),I=0;I<D;I++){var P=_[I];c(P.offset),P.locator=copyLocator(f,{})}i.locator=N,appendElement$1(_,i,B)&&p.push(_),i.locator=f}else appendElement$1(_,i,B)&&p.push(_);_.uri==="http://www.w3.org/1999/xhtml"&&!_.closed?A=parseHtmlSpecialContent(e,A,_.tagName,s,i):A++}}catch(k){o.error("element parse error: "+k),A=-1}A>g?g=A:u(Math.max(h,g)+1)}}function copyLocator(e,n){return n.lineNumber=e.lineNumber,n.columnNumber=e.columnNumber,n}function parseElementStartPart(e,n,t,i,o,r){for(var s,u,c=++n,l=S_TAG;;){var d=e.charAt(c);switch(d){case"=":if(l===S_ATTR)s=e.slice(n,c),l=S_EQ;else if(l===S_ATTR_SPACE)l=S_EQ;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(l===S_EQ||l===S_ATTR)if(l===S_ATTR&&(r.warning('attribute value must after "="'),s=e.slice(n,c)),n=c+1,c=e.indexOf(d,n),c>0)u=e.slice(n,c).replace(/&#?\w+;/g,o),t.add(s,u,n-1),l=S_ATTR_END;else throw new Error("attribute value no end '"+d+"' match");else if(l==S_ATTR_NOQUOT_VALUE)u=e.slice(n,c).replace(/&#?\w+;/g,o),t.add(s,u,n),r.warning('attribute "'+s+'" missed start quot('+d+")!!"),n=c+1,l=S_ATTR_END;else throw new Error('attribute value must after "="');break;case"/":switch(l){case S_TAG:t.setTagName(e.slice(n,c));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:l=S_TAG_CLOSE,t.closed=!0;case S_ATTR_NOQUOT_VALUE:case S_ATTR:case S_ATTR_SPACE:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return r.error("unexpected end of input"),l==S_TAG&&t.setTagName(e.slice(n,c)),c;case">":switch(l){case S_TAG:t.setTagName(e.slice(n,c));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:break;case S_ATTR_NOQUOT_VALUE:case S_ATTR:u=e.slice(n,c),u.slice(-1)==="/"&&(t.closed=!0,u=u.slice(0,-1));case S_ATTR_SPACE:l===S_ATTR_SPACE&&(u=s),l==S_ATTR_NOQUOT_VALUE?(r.warning('attribute "'+u+'" missed quot(")!!'),t.add(s,u.replace(/&#?\w+;/g,o),n)):((i[""]!=="http://www.w3.org/1999/xhtml"||!u.match(/^(?:disabled|checked|selected)$/i))&&r.warning('attribute "'+u+'" missed value!! "'+u+'" instead!!'),t.add(u,u,n));break;case S_EQ:throw new Error("attribute value missed!!")}return c;case"\x80":d=" ";default:if(d<=" ")switch(l){case S_TAG:t.setTagName(e.slice(n,c)),l=S_TAG_SPACE;break;case S_ATTR:s=e.slice(n,c),l=S_ATTR_SPACE;break;case S_ATTR_NOQUOT_VALUE:var u=e.slice(n,c).replace(/&#?\w+;/g,o);r.warning('attribute "'+u+'" missed quot(")!!'),t.add(s,u,n);case S_ATTR_END:l=S_TAG_SPACE;break}else switch(l){case S_ATTR_SPACE:t.tagName,(i[""]!=="http://www.w3.org/1999/xhtml"||!s.match(/^(?:disabled|checked|selected)$/i))&&r.warning('attribute "'+s+'" missed value!! "'+s+'" instead2!!'),t.add(s,s,n),n=c,l=S_ATTR;break;case S_ATTR_END:r.warning('attribute space is required"'+s+'"!!');case S_TAG_SPACE:l=S_ATTR,n=c;break;case S_EQ:l=S_ATTR_NOQUOT_VALUE,n=c;break;case S_TAG_CLOSE:throw new Error("elements closed character '/' and '>' must be connected to")}}c++}}function appendElement$1(e,n,t){for(var i=e.tagName,o=null,a=e.length;a--;){var r=e[a],s=r.qName,u=r.value,f=s.indexOf(":");if(f>0)var c=r.prefix=s.slice(0,f),l=s.slice(f+1),d=c==="xmlns"&&l;else l=s,c=null,d=s==="xmlns"&&"";r.localName=l,d!==!1&&(o==null&&(o={},_copy(t,t={})),t[d]=o[d]=u,r.uri="http://www.w3.org/2000/xmlns/",n.startPrefixMapping(d,u))}for(var a=e.length;a--;){r=e[a];var c=r.prefix;c&&(c==="xml"&&(r.uri="http://www.w3.org/XML/1998/namespace"),c!=="xmlns"&&(r.uri=t[c||""]))}var f=i.indexOf(":");f>0?(c=e.prefix=i.slice(0,f),l=e.localName=i.slice(f+1)):(c=null,l=e.localName=i);var p=e.uri=t[c||""];if(n.startElement(p,l,i,e),e.closed){if(n.endElement(p,l,i),o)for(c in o)n.endPrefixMapping(c)}else return e.currentNSMap=t,e.localNSMap=o,!0}function parseHtmlSpecialContent(e,n,t,i,o){if(/^(?:script|textarea)$/i.test(t)){var r=e.indexOf("</"+t+">",n),s=e.substring(n+1,r);if(/[&<]/.test(s))return/^script$/i.test(t)?(o.characters(s,0,s.length),r):(s=s.replace(/&#?\w+;/g,i),o.characters(s,0,s.length),r)}return n+1}function fixSelfClosed(e,n,t,i){var o=i[t];return o==null&&(o=e.lastIndexOf("</"+t+">"),o<n&&(o=e.lastIndexOf("</"+t)),i[t]=o),o<n}function _copy(e,n){for(var t in e)n[t]=e[t]}function parseDCC(e,n,t,i){var o=e.charAt(n+2);switch(o){case"-":if(e.charAt(n+3)==="-"){var r=e.indexOf("-->",n+4);return r>n?(t.comment(e,n+4,r-n-4),r+3):(i.error("Unclosed comment"),-1)}else return-1;default:if(e.substr(n+3,6)=="CDATA["){var r=e.indexOf("]]>",n+9);return t.startCDATA(),t.characters(e,n+9,r-n-9),t.endCDATA(),r+3}var s=split(e,n),u=s.length;if(u>1&&/!doctype/i.test(s[0][0])){var c=s[1][0],l=u>3&&/^public$/i.test(s[2][0])&&s[3][0],d=u>4&&s[4][0],a=s[u-1];return t.startDTD(c,l&&l.replace(/^(['"])(.*?)\1$/,"$2"),d&&d.replace(/^(['"])(.*?)\1$/,"$2")),t.endDTD(),a.index+a[0].length}}return-1}function parseInstruction(e,n,t){var i=e.indexOf("?>",n);if(i){var o=e.substring(n,i).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return o?(o[0].length,t.processingInstruction(o[1],o[2]),i+2):-1}return-1}function ElementAttributes(e){}ElementAttributes.prototype={setTagName:function(e){if(!tagNamePattern.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,n,t){if(!tagNamePattern.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:n,offset:t}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};function _set_proto_(e,n){return e.__proto__=n,e}_set_proto_({},_set_proto_.prototype)instanceof _set_proto_||(_set_proto_=function(e,n){function t(){}t.prototype=n,t=new t;for(n in e)t[n]=e[n];return t});function split(e,n){var t,i=[],o=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(o.lastIndex=n,o.exec(e);t=o.exec(e);)if(i.push(t),t[1])return i}sax.XMLReader=XMLReader$1;var dom={};function copy(e,n){for(var t in e)n[t]=e[t]}function _extends(e,n){var t=e.prototype;if(Object.create){var i=Object.create(n.prototype);t.__proto__=i}if(!(t instanceof n)){let o=function(){};o.prototype=n.prototype,o=new o,copy(t,o),e.prototype=t=o}t.constructor!=e&&(typeof e!="function"&&console.error("unknow Class:"+e),t.constructor=e)}var htmlns="http://www.w3.org/1999/xhtml",NodeType={},ELEMENT_NODE=NodeType.ELEMENT_NODE=1,ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2,TEXT_NODE=NodeType.TEXT_NODE=3,CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5,ENTITY_NODE=NodeType.ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=NodeType.COMMENT_NODE=8,DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=NodeType.NOTATION_NODE=12,ExceptionCode={},ExceptionMessage={};ExceptionCode.INDEX_SIZE_ERR=(ExceptionMessage[1]="Index size error",1);ExceptionCode.DOMSTRING_SIZE_ERR=(ExceptionMessage[2]="DOMString size error",2);var HIERARCHY_REQUEST_ERR=ExceptionCode.HIERARCHY_REQUEST_ERR=(ExceptionMessage[3]="Hierarchy request error",3);ExceptionCode.WRONG_DOCUMENT_ERR=(ExceptionMessage[4]="Wrong document",4);ExceptionCode.INVALID_CHARACTER_ERR=(ExceptionMessage[5]="Invalid character",5);ExceptionCode.NO_DATA_ALLOWED_ERR=(ExceptionMessage[6]="No data allowed",6);ExceptionCode.NO_MODIFICATION_ALLOWED_ERR=(ExceptionMessage[7]="No modification allowed",7);var NOT_FOUND_ERR=ExceptionCode.NOT_FOUND_ERR=(ExceptionMessage[8]="Not found",8);ExceptionCode.NOT_SUPPORTED_ERR=(ExceptionMessage[9]="Not supported",9);var INUSE_ATTRIBUTE_ERR=ExceptionCode.INUSE_ATTRIBUTE_ERR=(ExceptionMessage[10]="Attribute in use",10);ExceptionCode.INVALID_STATE_ERR=(ExceptionMessage[11]="Invalid state",11);ExceptionCode.SYNTAX_ERR=(ExceptionMessage[12]="Syntax error",12);ExceptionCode.INVALID_MODIFICATION_ERR=(ExceptionMessage[13]="Invalid modification",13);ExceptionCode.NAMESPACE_ERR=(ExceptionMessage[14]="Invalid namespace",14);ExceptionCode.INVALID_ACCESS_ERR=(ExceptionMessage[15]="Invalid access",15);function DOMException(e,n){if(n instanceof Error)var t=n;else t=this,Error.call(this,ExceptionMessage[e]),this.message=ExceptionMessage[e],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return t.code=e,n&&(this.message=this.message+": "+n),t}DOMException.prototype=Error.prototype;copy(ExceptionCode,DOMException);function NodeList(){}NodeList.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,n){for(var t=[],i=0;i<this.length;i++)serializeToString(this[i],t,e,n);return t.join("")}};function LiveNodeList(e,n){this._node=e,this._refresh=n,_updateLiveList(this)}function _updateLiveList(e){var n=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=n){var t=e._refresh(e._node);__set__(e,"length",t.length),copy(t,e),e._inc=n}}LiveNodeList.prototype.item=function(e){return _updateLiveList(this),this[e]};_extends(LiveNodeList,NodeList);function NamedNodeMap(){}function _findNodeIndex(e,n){for(var t=e.length;t--;)if(e[t]===n)return t}function _addNamedNode(e,n,t,i){if(i?n[_findNodeIndex(n,i)]=t:n[n.length++]=t,e){t.ownerElement=e;var o=e.ownerDocument;o&&(i&&_onRemoveAttribute(o,e,i),_onAddAttribute(o,e,t))}}function _removeNamedNode(e,n,t){var i=_findNodeIndex(n,t);if(i>=0){for(var o=n.length-1;i<o;)n[i]=n[++i];if(n.length=o,e){var r=e.ownerDocument;r&&(_onRemoveAttribute(r,e,t),t.ownerElement=null)}}else throw DOMException(NOT_FOUND_ERR,new Error(e.tagName+"@"+t))}NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(e){for(var n=this.length;n--;){var t=this[n];if(t.nodeName==e)return t}},setNamedItem:function(e){var n=e.ownerElement;if(n&&n!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);var t=this.getNamedItem(e.nodeName);return _addNamedNode(this._ownerElement,this,e,t),t},setNamedItemNS:function(e){var n=e.ownerElement,t;if(n&&n!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);return t=this.getNamedItemNS(e.namespaceURI,e.localName),_addNamedNode(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var n=this.getNamedItem(e);return _removeNamedNode(this._ownerElement,this,n),n},removeNamedItemNS:function(e,n){var t=this.getNamedItemNS(e,n);return _removeNamedNode(this._ownerElement,this,t),t},getNamedItemNS:function(e,n){for(var t=this.length;t--;){var i=this[t];if(i.localName==n&&i.namespaceURI==e)return i}return null}};function DOMImplementation$1(e){if(this._features={},e)for(var n in e)this._features=e[n]}DOMImplementation$1.prototype={hasFeature:function(e,n){var t=this._features[e.toLowerCase()];return!!(t&&(!n||n in t))},createDocument:function(e,n,t){var i=new Document;if(i.implementation=this,i.childNodes=new NodeList,i.doctype=t,t&&i.appendChild(t),n){var o=i.createElementNS(e,n);i.appendChild(o)}return i},createDocumentType:function(e,n,t){var i=new DocumentType;return i.name=e,i.nodeName=e,i.publicId=n,i.systemId=t,i}};function Node(){}Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,n){return _insertBefore(this,e,n)},replaceChild:function(e,n){this.insertBefore(e,n),n&&this.removeChild(n)},removeChild:function(e){return _removeChild(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(e){return cloneNode(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var n=e.nextSibling;n&&n.nodeType==TEXT_NODE&&e.nodeType==TEXT_NODE?(this.removeChild(n),e.appendData(n.data)):(e.normalize(),e=n)}},isSupported:function(e,n){return this.ownerDocument.implementation.hasFeature(e,n)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var n=this;n;){var t=n._nsMap;if(t){for(var i in t)if(t[i]==e)return i}n=n.nodeType==ATTRIBUTE_NODE?n.ownerDocument:n.parentNode}return null},lookupNamespaceURI:function(e){for(var n=this;n;){var t=n._nsMap;if(t&&e in t)return t[e];n=n.nodeType==ATTRIBUTE_NODE?n.ownerDocument:n.parentNode}return null},isDefaultNamespace:function(e){var n=this.lookupPrefix(e);return n==null}};function _xmlEncoder(e){return e=="<"&&"&lt;"||e==">"&&"&gt;"||e=="&"&&"&amp;"||e=='"'&&"&quot;"||"&#"+e.charCodeAt()+";"}copy(NodeType,Node);copy(NodeType,Node.prototype);function _visitNode(e,n){if(n(e))return!0;if(e=e.firstChild)do if(_visitNode(e,n))return!0;while(e=e.nextSibling)}function Document(){}function _onAddAttribute(e,n,t){e&&e._inc++;var i=t.namespaceURI;i=="http://www.w3.org/2000/xmlns/"&&(n._nsMap[t.prefix?t.localName:""]=t.value)}function _onRemoveAttribute(e,n,t,i){e&&e._inc++;var o=t.namespaceURI;o=="http://www.w3.org/2000/xmlns/"&&delete n._nsMap[t.prefix?t.localName:""]}function _onUpdateChild(e,n,t){if(e&&e._inc){e._inc++;var i=n.childNodes;if(t)i[i.length++]=t;else{for(var o=n.firstChild,r=0;o;)i[r++]=o,o=o.nextSibling;i.length=r}}}function _removeChild(e,n){var t=n.previousSibling,i=n.nextSibling;return t?t.nextSibling=i:e.firstChild=i,i?i.previousSibling=t:e.lastChild=t,_onUpdateChild(e.ownerDocument,e),n}function _insertBefore(e,n,t){var i=n.parentNode;if(i&&i.removeChild(n),n.nodeType===DOCUMENT_FRAGMENT_NODE){var o=n.firstChild;if(o==null)return n;var r=n.lastChild}else o=r=n;var s=t?t.previousSibling:e.lastChild;o.previousSibling=s,r.nextSibling=t,s?s.nextSibling=o:e.firstChild=o,t==null?e.lastChild=r:t.previousSibling=r;do o.parentNode=e;while(o!==r&&(o=o.nextSibling));return _onUpdateChild(e.ownerDocument||e,e),n.nodeType==DOCUMENT_FRAGMENT_NODE&&(n.firstChild=n.lastChild=null),n}function _appendSingleChild(e,n){var t=n.parentNode;if(t){var i=e.lastChild;t.removeChild(n);var i=e.lastChild}var i=e.lastChild;return n.parentNode=e,n.previousSibling=i,n.nextSibling=null,i?i.nextSibling=n:e.firstChild=n,e.lastChild=n,_onUpdateChild(e.ownerDocument,e,n),n}Document.prototype={nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,n){if(e.nodeType==DOCUMENT_FRAGMENT_NODE){for(var t=e.firstChild;t;){var i=t.nextSibling;this.insertBefore(t,n),t=i}return e}return this.documentElement==null&&e.nodeType==ELEMENT_NODE&&(this.documentElement=e),_insertBefore(this,e,n),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),_removeChild(this,e)},importNode:function(e,n){return importNode(this,e,n)},getElementById:function(e){var n=null;return _visitNode(this.documentElement,function(t){if(t.nodeType==ELEMENT_NODE&&t.getAttribute("id")==e)return n=t,!0}),n},createElement:function(e){var n=new Element;n.ownerDocument=this,n.nodeName=e,n.tagName=e,n.childNodes=new NodeList;var t=n.attributes=new NamedNodeMap;return t._ownerElement=n,n},createDocumentFragment:function(){var e=new DocumentFragment;return e.ownerDocument=this,e.childNodes=new NodeList,e},createTextNode:function(e){var n=new Text;return n.ownerDocument=this,n.appendData(e),n},createComment:function(e){var n=new Comment;return n.ownerDocument=this,n.appendData(e),n},createCDATASection:function(e){var n=new CDATASection;return n.ownerDocument=this,n.appendData(e),n},createProcessingInstruction:function(e,n){var t=new ProcessingInstruction;return t.ownerDocument=this,t.tagName=t.target=e,t.nodeValue=t.data=n,t},createAttribute:function(e){var n=new Attr;return n.ownerDocument=this,n.name=e,n.nodeName=e,n.localName=e,n.specified=!0,n},createEntityReference:function(e){var n=new EntityReference;return n.ownerDocument=this,n.nodeName=e,n},createElementNS:function(e,n){var t=new Element,i=n.split(":"),o=t.attributes=new NamedNodeMap;return t.childNodes=new NodeList,t.ownerDocument=this,t.nodeName=n,t.tagName=n,t.namespaceURI=e,i.length==2?(t.prefix=i[0],t.localName=i[1]):t.localName=n,o._ownerElement=t,t},createAttributeNS:function(e,n){var t=new Attr,i=n.split(":");return t.ownerDocument=this,t.nodeName=n,t.name=n,t.namespaceURI=e,t.specified=!0,i.length==2?(t.prefix=i[0],t.localName=i[1]):t.localName=n,t}};_extends(Document,Node);function Element(){this._nsMap={}}Element.prototype={nodeType:ELEMENT_NODE,hasAttribute:function(e){return this.getAttributeNode(e)!=null},getAttribute:function(e){var n=this.getAttributeNode(e);return n&&n.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,n){var t=this.ownerDocument.createAttribute(e);t.value=t.nodeValue=""+n,this.setAttributeNode(t)},removeAttribute:function(e){var n=this.getAttributeNode(e);n&&this.removeAttributeNode(n)},appendChild:function(e){return e.nodeType===DOCUMENT_FRAGMENT_NODE?this.insertBefore(e,null):_appendSingleChild(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,n){var t=this.getAttributeNodeNS(e,n);t&&this.removeAttributeNode(t)},hasAttributeNS:function(e,n){return this.getAttributeNodeNS(e,n)!=null},getAttributeNS:function(e,n){var t=this.getAttributeNodeNS(e,n);return t&&t.value||""},setAttributeNS:function(e,n,t){var i=this.ownerDocument.createAttributeNS(e,n);i.value=i.nodeValue=""+t,this.setAttributeNode(i)},getAttributeNodeNS:function(e,n){return this.attributes.getNamedItemNS(e,n)},getElementsByTagName:function(e){return new LiveNodeList(this,function(n){var t=[];return _visitNode(n,function(i){i!==n&&i.nodeType==ELEMENT_NODE&&(e==="*"||i.tagName==e)&&t.push(i)}),t})},getElementsByTagNameNS:function(e,n){return new LiveNodeList(this,function(t){var i=[];return _visitNode(t,function(o){o!==t&&o.nodeType===ELEMENT_NODE&&(e==="*"||o.namespaceURI===e)&&(n==="*"||o.localName==n)&&i.push(o)}),i})}};Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName;Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS;_extends(Element,Node);function Attr(){}Attr.prototype.nodeType=ATTRIBUTE_NODE;_extends(Attr,Node);function CharacterData(){}CharacterData.prototype={data:"",substringData:function(e,n){return this.data.substring(e,e+n)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,n){this.replaceData(e,0,n)},appendChild:function(e){throw new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])},deleteData:function(e,n){this.replaceData(e,n,"")},replaceData:function(e,n,t){var i=this.data.substring(0,e),o=this.data.substring(e+n);t=i+t+o,this.nodeValue=this.data=t,this.length=t.length}};_extends(CharacterData,Node);function Text(){}Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(e){var n=this.data,t=n.substring(e);n=n.substring(0,e),this.data=this.nodeValue=n,this.length=n.length;var i=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}};_extends(Text,CharacterData);function Comment(){}Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE};_extends(Comment,CharacterData);function CDATASection(){}CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE};_extends(CDATASection,CharacterData);function DocumentType(){}DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE;_extends(DocumentType,Node);function Notation(){}Notation.prototype.nodeType=NOTATION_NODE;_extends(Notation,Node);function Entity(){}Entity.prototype.nodeType=ENTITY_NODE;_extends(Entity,Node);function EntityReference(){}EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE;_extends(EntityReference,Node);function DocumentFragment(){}DocumentFragment.prototype.nodeName="#document-fragment";DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE;_extends(DocumentFragment,Node);function ProcessingInstruction(){}ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE;_extends(ProcessingInstruction,Node);function XMLSerializer$1(){}XMLSerializer$1.prototype.serializeToString=function(e,n,t){return nodeSerializeToString.call(e,n,t)};Node.prototype.toString=nodeSerializeToString;function nodeSerializeToString(e,n){var t=[],i=this.nodeType==9?this.documentElement:this,o=i.prefix,r=i.namespaceURI;if(r&&o==null){var o=i.lookupPrefix(r);if(o==null)var s=[{namespace:r,prefix:null}]}return serializeToString(this,t,e,n,s),t.join("")}function needNamespaceDefine(e,n,t){var i=e.prefix||"",o=e.namespaceURI;if(!i&&!o||i==="xml"&&o==="http://www.w3.org/XML/1998/namespace"||o=="http://www.w3.org/2000/xmlns/")return!1;for(var r=t.length;r--;){var s=t[r];if(s.prefix==i)return s.namespace!=o}return!0}function serializeToString(e,n,t,i,o){if(i)if(e=i(e),e){if(typeof e=="string"){n.push(e);return}}else return;switch(e.nodeType){case ELEMENT_NODE:o||(o=[]),o.length;var r=e.attributes,s=r.length,p=e.firstChild,u=e.tagName;t=htmlns===e.namespaceURI||t,n.push("<",u);for(var c=0;c<s;c++){var l=r.item(c);l.prefix=="xmlns"?o.push({prefix:l.localName,namespace:l.value}):l.nodeName=="xmlns"&&o.push({prefix:"",namespace:l.value})}for(var c=0;c<s;c++){var l=r.item(c);if(needNamespaceDefine(l,t,o)){var d=l.prefix||"",a=l.namespaceURI,f=d?" xmlns:"+d:" xmlns";n.push(f,'="',a,'"'),o.push({prefix:d,namespace:a})}serializeToString(l,n,t,i,o)}if(needNamespaceDefine(e,t,o)){var d=e.prefix||"",a=e.namespaceURI,f=d?" xmlns:"+d:" xmlns";n.push(f,'="',a,'"'),o.push({prefix:d,namespace:a})}if(p||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(n.push(">"),t&&/^script$/i.test(u))for(;p;)p.data?n.push(p.data):serializeToString(p,n,t,i,o),p=p.nextSibling;else for(;p;)serializeToString(p,n,t,i,o),p=p.nextSibling;n.push("</",u,">")}else n.push("/>");return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(var p=e.firstChild;p;)serializeToString(p,n,t,i,o),p=p.nextSibling;return;case ATTRIBUTE_NODE:return n.push(" ",e.name,'="',e.value.replace(/[<&"]/g,_xmlEncoder),'"');case TEXT_NODE:return n.push(e.data.replace(/[<&]/g,_xmlEncoder));case CDATA_SECTION_NODE:return n.push("<![CDATA[",e.data,"]]>");case COMMENT_NODE:return n.push("<!--",e.data,"-->");case DOCUMENT_TYPE_NODE:var S=e.publicId,g=e.systemId;if(n.push("<!DOCTYPE ",e.name),S)n.push(' PUBLIC "',S),g&&g!="."&&n.push('" "',g),n.push('">');else if(g&&g!=".")n.push(' SYSTEM "',g,'">');else{var h=e.internalSubset;h&&n.push(" [",h,"]"),n.push(">")}return;case PROCESSING_INSTRUCTION_NODE:return n.push("<?",e.target," ",e.data,"?>");case ENTITY_REFERENCE_NODE:return n.push("&",e.nodeName,";");default:n.push("??",e.nodeName)}}function importNode(e,n,t){var i;switch(n.nodeType){case ELEMENT_NODE:i=n.cloneNode(!1),i.ownerDocument=e;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:t=!0;break}if(i||(i=n.cloneNode(!1)),i.ownerDocument=e,i.parentNode=null,t)for(var o=n.firstChild;o;)i.appendChild(importNode(e,o,t)),o=o.nextSibling;return i}function cloneNode(e,n,t){var i=new n.constructor;for(var o in n){var r=n[o];typeof r!="object"&&r!=i[o]&&(i[o]=r)}switch(n.childNodes&&(i.childNodes=new NodeList),i.ownerDocument=e,i.nodeType){case ELEMENT_NODE:var s=n.attributes,u=i.attributes=new NamedNodeMap,c=s.length;u._ownerElement=i;for(var l=0;l<c;l++)i.setAttributeNode(cloneNode(e,s.item(l),!0));break;case ATTRIBUTE_NODE:t=!0}if(t)for(var d=n.firstChild;d;)i.appendChild(cloneNode(e,d,t)),d=d.nextSibling;return i}function __set__(e,n,t){e[n]=t}try{if(Object.defineProperty){let e=function(n){switch(n.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:var t=[];for(n=n.firstChild;n;)n.nodeType!==7&&n.nodeType!==8&&t.push(e(n)),n=n.nextSibling;return t.join("");default:return n.nodeValue}};Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{get:function(){return e(this)},set:function(n){switch(this.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(;this.firstChild;)this.removeChild(this.firstChild);(n||String(n))&&this.appendChild(this.ownerDocument.createTextNode(n));break;default:this.data=n,this.value=n,this.nodeValue=n}}}),__set__=function(n,t,i){n["$$"+t]=i}}}catch(e){}dom.DOMImplementation=DOMImplementation$1;dom.XMLSerializer=XMLSerializer$1;function DOMParser$1(e){this.options=e||{locator:{}}}DOMParser$1.prototype.parseFromString=function(e,n){var t=this.options,i=new XMLReader,o=t.domBuilder||new DOMHandler,r=t.errorHandler,s=t.locator,u=t.xmlns||{},c={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return s&&o.setDocumentLocator(s),i.errorHandler=buildErrorHandler(r,o,s),i.domBuilder=t.domBuilder||o,/\/x?html?$/.test(n)&&(c.nbsp="\xA0",c.copy="\xA9",u[""]="http://www.w3.org/1999/xhtml"),u.xml=u.xml||"http://www.w3.org/XML/1998/namespace",e?i.parse(e,u,c):i.errorHandler.error("invalid doc source"),o.doc};function buildErrorHandler(e,n,t){if(!e){if(n instanceof DOMHandler)return n;e=n}var i={},o=e instanceof Function;t=t||{};function r(s){var u=e[s];!u&&o&&(u=e.length==2?function(c){e(s,c)}:e),i[s]=u&&function(c){u("[xmldom "+s+"]	"+c+_locator(t))}||function(){}}return r("warning"),r("error"),r("fatalError"),i}function DOMHandler(){this.cdata=!1}function position(e,n){n.lineNumber=e.lineNumber,n.columnNumber=e.columnNumber}DOMHandler.prototype={startDocument:function(){this.doc=new DOMImplementation().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,n,t,i){var o=this.doc,r=o.createElementNS(e,t||n),s=i.length;appendElement(this,r),this.currentElement=r,this.locator&&position(this.locator,r);for(var u=0;u<s;u++){var e=i.getURI(u),c=i.getValue(u),t=i.getQName(u),l=o.createAttributeNS(e,t);this.locator&&position(i.getLocator(u),l),l.value=l.nodeValue=c,r.setAttributeNode(l)}},endElement:function(e,n,t){var i=this.currentElement;i.tagName,this.currentElement=i.parentNode},startPrefixMapping:function(e,n){},endPrefixMapping:function(e){},processingInstruction:function(e,n){var t=this.doc.createProcessingInstruction(e,n);this.locator&&position(this.locator,t),appendElement(this,t)},ignorableWhitespace:function(e,n,t){},characters:function(e,n,t){if(e=_toString.apply(this,arguments),e){if(this.cdata)var i=this.doc.createCDATASection(e);else var i=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(i):/^\s*$/.test(e)&&this.doc.appendChild(i),this.locator&&position(this.locator,i)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,n,t){e=_toString.apply(this,arguments);var i=this.doc.createComment(e);this.locator&&position(this.locator,i),appendElement(this,i)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,n,t){var i=this.doc.implementation;if(i&&i.createDocumentType){var o=i.createDocumentType(e,n,t);this.locator&&position(this.locator,o),appendElement(this,o)}},warning:function(e){console.warn("[xmldom warning]	"+e,_locator(this.locator))},error:function(e){console.error("[xmldom error]	"+e,_locator(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]	"+e,_locator(this.locator)),e}};function _locator(e){if(e)return`
@`+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function _toString(e,n,t){return typeof e=="string"?e.substr(n,t):e.length>=n+t||n?new java.lang.String(e,n,t)+"":e}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){DOMHandler.prototype[e]=function(){return null}});function appendElement(e,n){e.currentElement?e.currentElement.appendChild(n):e.doc.appendChild(n)}var XMLReader=sax.XMLReader,DOMImplementation=domParser.DOMImplementation=dom.DOMImplementation;domParser.XMLSerializer=dom.XMLSerializer;domParser.DOMParser=DOMParser$1;var DOMParser=domParser.DOMParser,xmlToJSON=function(){this.version="1.3.5";var e={mergeCDATA:!0,normalize:!0,stripElemPrefix:!0},n=new RegExp(/(?!xmlns)^.*:/);return this.grokType=function(t){return/^\s*$/.test(t)?null:/^(?:true|false)$/i.test(t)?t.toLowerCase()==="true":isFinite(t)?parseFloat(t):t},this.parseString=function(t,i){if(t){var o=this.stringToXML(t);return o.getElementsByTagName("parsererror").length?null:this.parseXML(o,i)}else return null},this.parseXML=function(t,i){for(var o in i)e[o]=i[o];var r={},s=0,u="",c=t.childNodes.length;if(c)for(var l,d,a,f=0;f<t.childNodes.length;f++)l=t.childNodes.item(f),l.nodeType===4?e.mergeCDATA&&(u+=l.nodeValue):l.nodeType===3?u+=l.nodeValue:l.nodeType===1&&(s===0&&(r={}),e.stripElemPrefix?d=l.nodeName.replace(n,""):d=l.nodeName,a=xmlToJSON.parseXML(l),r.hasOwnProperty(d)?(r[d].constructor!==Array&&(r[d]=[r[d]]),r[d].push(a)):(r[d]=a,s++));return Object.keys(r).length||(r=u||""),r},this.xmlToString=function(t){try{var i=t.xml?t.xml:new XMLSerializer().serializeToString(t);return i}catch{return null}},this.stringToXML=function(t){try{var i=null;if(window.DOMParser){var o=new DOMParser;return i=o.parseFromString(t,"text/xml"),i}else return i=new ActiveXObject("Microsoft.XMLDOM"),i.async=!1,i.loadXML(t),i}catch{return null}},this}.call({}),xml2json$1=function(e){return xmlToJSON.parseString(e)},xml2json_1=xml2json$1,element_start_char="a-zA-Z_\xC0-\xD6\xD8-\xF6\xF8-\xFF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FFF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD",element_non_start_char="-.0-9\xB7\u0300-\u036F\u203F\u2040",element_replace=new RegExp("^([^"+element_start_char+"])|^((x|X)(m|M)(l|L))|([^"+element_start_char+element_non_start_char+"])","g"),not_safe_in_xml=/[^\x09\x0A\x0D\x20-\xFF\x85\xA0-\uD7FF\uE000-\uFDCF\uFDE0-\uFFFD]/gm,objKeys=function(e){var n=[];if(e instanceof Object)for(var t in e)e.hasOwnProperty(t)&&n.push(t);return n},process_to_xml=function(e,n){var t=function(i,o,r,s,u){var c=n.indent!==void 0?n.indent:"	",l=n.prettyPrint?`
`+new Array(s).join(c):"";n.removeIllegalNameCharacters&&(i=i.replace(element_replace,"_"));var d=[l,"<",i,r||""];return o&&o.length>0?(d.push(">"),d.push(o),u&&d.push(l),d.push("</"),d.push(i),d.push(">")):d.push("/>"),d.join("")};return function i(o,r,s){var u=typeof o;switch((Array.isArray?Array.isArray(o):o instanceof Array)?u="array":o instanceof Date&&(u="date"),u){case"array":var c=[];return o.map(function(f){c.push(i(f,1,s+1))}),n.prettyPrint&&c.push(`
`),c.join("");case"date":return o.toJSON?o.toJSON():o+"";case"object":var l=[];for(var d in o)if(o.hasOwnProperty(d))if(o[d]instanceof Array)for(var a=0;a<o[d].length;a++)o[d].hasOwnProperty(a)&&l.push(t(d,i(o[d][a],0,s+1),null,s+1,objKeys(o[d][a]).length));else l.push(t(d,i(o[d],0,s+1),null,s+1));return n.prettyPrint&&l.length>0&&l.push(`
`),l.join("");case"function":return o();default:return n.escape?esc(o):""+o}}(e,0,0)},xml_header=function(e){var n=['<?xml version="1.0" encoding="UTF-8"'];return e&&n.push(' standalone="yes"'),n.push("?>"),n.join("")};function esc(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(not_safe_in_xml,"")}var json2xml$1=function(e,n){if(n||(n={xmlHeader:{standalone:!0},prettyPrint:!0,indent:"  ",escape:!0}),typeof e=="string")try{e=JSON.parse(e.toString())}catch{return!1}var t="",i="";n&&(typeof n=="object"?(n.xmlHeader&&(t=xml_header(!!n.xmlHeader.standalone)),typeof n.docType!="undefined"&&(i="<!DOCTYPE "+n.docType+">")):t=xml_header()),n=n||{};var o=[t,n.prettyPrint&&i?`
`:"",i,process_to_xml(e,n)];return o.join("").replace(/\n{2,}/g,`
`).replace(/\s+$/g,"")},md5=md5$1.exports,CryptoJS=crypto.exports,xml2json=xml2json_1,json2xml=json2xml$1;function camSafeUrlEncode(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function getObjectKeys(e,n){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(n?camSafeUrlEncode(i).toLowerCase():i);return t.sort(function(o,r){return o=o.toLowerCase(),r=r.toLowerCase(),o===r?0:o>r?1:-1})}var obj2str=function(e,n){var t,i,o,r=[],s=getObjectKeys(e);for(t=0;t<s.length;t++)i=s[t],o=e[i]===void 0||e[i]===null?"":""+e[i],i=n?camSafeUrlEncode(i).toLowerCase():camSafeUrlEncode(i),o=camSafeUrlEncode(o)||"",r.push(i+"="+o);return r.join("&")},signHeaders=["content-disposition","content-encoding","content-length","content-md5","expect","host","if-match","if-modified-since","if-none-match","if-unmodified-since","origin","range","response-cache-control","response-content-disposition","response-content-encoding","response-content-language","response-content-type","response-expires","transfer-encoding","versionid"],getSignHeaderObj=function(e){var n={};for(var t in e){var i=t.toLowerCase();(i.indexOf("x-cos-")>-1||signHeaders.indexOf(i)>-1)&&(n[t]=e[t])}return n},getAuth$1=function(e){e=e||{};var n=e.SecretId,t=e.SecretKey,i=e.KeyTime,o=(e.method||e.Method||"get").toLowerCase(),r=clone(e.Query||e.params||{}),s=getSignHeaderObj(clone(e.Headers||e.headers||{})),u=e.Key||"",c;if(e.UseRawKey?c=e.Pathname||e.pathname||"/"+u:(c=e.Pathname||e.pathname||u,c.indexOf("/")!==0&&(c="/"+c)),!s.Host&&!s.host&&e.Bucket&&e.Region&&(s.Host=e.Bucket+".cos."+e.Region+".myqcloud.com"),!n)throw new Error("missing param SecretId");if(!t)throw new Error("missing param SecretKey");var l=Math.round(getSkewTime(e.SystemClockOffset)/1e3)-1,d=l,a=e.Expires||e.expires;a===void 0?d+=900:d+=a*1||0;var f="sha1",p=n,S=i||l+";"+d,g=i||l+";"+d,h=getObjectKeys(s,!0).join(";").toLowerCase(),C=getObjectKeys(r,!0).join(";").toLowerCase(),v=CryptoJS.HmacSHA1(g,t).toString(),y=[o,c,util$5.obj2str(r,!0),util$5.obj2str(s,!0),""].join(`
`),R=["sha1",S,CryptoJS.SHA1(y).toString(),""].join(`
`),T=CryptoJS.HmacSHA1(R,v).toString(),E=["q-sign-algorithm="+f,"q-ak="+p,"q-sign-time="+S,"q-key-time="+g,"q-header-list="+h,"q-url-param-list="+C,"q-signature="+T].join("&");return E},readIntBE=function(e,n,t){var i=n/8,o=e.slice(t,t+i);return new Uint8Array(o).reverse(),new{8:Uint8Array,16:Uint16Array,32:Uint32Array}[n](o)[0]},buf2str=function(e,n,t,i){var o=e.slice(n,t),r="";return new Uint8Array(o).forEach(function(s){r+=String.fromCharCode(s)}),i&&(r=decodeURIComponent(escape(r))),r},parseSelectPayload=function(e){for(var n={},t=buf2str(e),i={records:[]};e.byteLength;){var o=readIntBE(e,32,0),r=readIntBE(e,32,4),s=o-r-16,u=0,c;for(e=e.slice(12);u<r;){var l=readIntBE(e,8,u),d=buf2str(e,u+1,u+1+l),a=readIntBE(e,16,u+l+2),f=buf2str(e,u+l+4,u+l+4+a);n[d]=f,u+=l+4+a}if(n[":event-type"]==="Records")c=buf2str(e,u,u+s,!0),i.records.push(c);else if(n[":event-type"]==="Stats")c=buf2str(e,u,u+s,!0),i.stats=util$5.xml2json(c).Stats;else if(n[":event-type"]==="error"){var p=n[":error-code"],S=n[":error-message"],g=new Error(S);g.message=S,g.name=g.code=p,i.error=g}e=e.slice(u+s+4)}return{payload:i.records.join(""),body:t}},getSourceParams=function(e){var n=this.options.CopySourceParser;if(n)return n(e);var t=e.match(/^([^.]+-\d+)\.cos(v6|-cdc)?\.([^.]+)\.myqcloud\.com\/(.+)$/);return t?{Bucket:t[1],Region:t[3],Key:t[4]}:null},noop=function(){},clearKey=function(e){var n={};for(var t in e)e.hasOwnProperty(t)&&e[t]!==void 0&&e[t]!==null&&(n[t]=e[t]);return n},readAsBinaryString=function(e,n){var t,i=new FileReader;FileReader.prototype.readAsBinaryString?(t=FileReader.prototype.readAsBinaryString,i.onload=function(){n(this.result)}):FileReader.prototype.readAsArrayBuffer?t=function(o){var r="",s=new FileReader;s.onload=function(u){for(var c=new Uint8Array(s.result),l=c.byteLength,d=0;d<l;d++)r+=String.fromCharCode(c[d]);n(r)},s.readAsArrayBuffer(o)}:console.error("FileReader not support readAsBinaryString"),t.call(i,e)},fileSliceNeedCopy=function(){var e=function(t,i){t=t.split("."),i=i.split(".");for(var o=0;o<i.length;o++)if(t[o]!==i[o])return parseInt(t[o])>parseInt(i[o])?1:-1;return 0},n=function(t){if(!t)return!1;var i=(t.match(/Chrome\/([.\d]+)/)||[])[1],o=(t.match(/QBCore\/([.\d]+)/)||[])[1],r=(t.match(/QQBrowser\/([.\d]+)/)||[])[1],s=i&&e(i,"53.0.2785.116")<0&&o&&e(o,"3.53.991.400")<0&&r&&e(r,"9.0.2524.400")<=0||!1;return s};return n(typeof navigator!="undefined"&&navigator.userAgent)}(),fileSlice=function(e,n,t,i,o){var r;if(e.slice?r=e.slice(n,t):e.mozSlice?r=e.mozSlice(n,t):e.webkitSlice&&(r=e.webkitSlice(n,t)),i&&fileSliceNeedCopy){var s=new FileReader;s.onload=function(u){r=null,o(new Blob([s.result]))},s.readAsArrayBuffer(r)}else o(r)},getBodyMd5=function(e,n,t,i){t=t||noop,e?typeof n=="string"?t(util$5.md5(n,!0)):Blob&&n instanceof Blob?util$5.getFileMd5(n,function(o,r){t(r)},i):t():t()},md5ChunkSize=1024*1024,getFileMd5=function(e,n,t){var i=e.size,o=0,r=md5.getCtx(),s=function(u){if(u>=i){var c=r.digest("hex");n(null,c);return}var l=Math.min(i,u+md5ChunkSize);util$5.fileSlice(e,u,l,!1,function(d){readAsBinaryString(d,function(a){d=null,r=r.update(a,!0),o+=a.length,a=null,t&&t({loaded:o,total:i,percent:Math.round(o/i*1e4)/1e4}),s(u+md5ChunkSize)})})};s(0)};function clone(e){return map(e,function(n){return typeof n=="object"&&n!==null?clone(n):n})}function attr(e,n,t){return e&&n in e?e[n]:t}function extend(e,n){return each(n,function(t,i){e[i]=n[i]}),e}function isArray(e){return e instanceof Array}function isInArray(e,n){for(var t=!1,i=0;i<e.length;i++)if(n===e[i]){t=!0;break}return t}function makeArray(e){return isArray(e)?e:[e]}function each(e,n){for(var t in e)e.hasOwnProperty(t)&&n(e[t],t)}function map(e,n){var t=isArray(e)?[]:{};for(var i in e)e.hasOwnProperty(i)&&(t[i]=n(e[i],i));return t}function filter(e,n){var t=isArray(e),i=t?[]:{};for(var o in e)e.hasOwnProperty(o)&&n(e[o],o)&&(t?i.push(e[o]):i[o]=e[o]);return i}var binaryBase64=function(e){var n,t,i,o="";for(n=0,t=e.length/2;n<t;n++)i=parseInt(e[n*2]+e[n*2+1],16),o+=String.fromCharCode(i);return btoa(o)},uuid=function(){var e=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},hasMissingParams=function(e,n){var t=n.Bucket,i=n.Region,o=n.Key,r=this.options.Domain,s=!r||r.indexOf("{Bucket}")>-1,u=!r||r.indexOf("{Region}")>-1;if(e.indexOf("Bucket")>-1||e==="deleteMultipleObject"||e==="multipartList"||e==="listObjectVersions"){if(s&&!t)return"Bucket";if(u&&!i)return"Region"}else if(e.indexOf("Object")>-1||e.indexOf("multipart")>-1||e==="sliceUploadFile"||e==="abortUploadTask"){if(s&&!t)return"Bucket";if(u&&!i)return"Region";if(!o)return"Key"}return!1},formatParams=function(e,n){if(n=extend({},n),e!=="getAuth"&&e!=="getV4Auth"&&e!=="getObjectUrl"){var t=n.Headers||{};if(n&&typeof n=="object"){(function(){for(var o in n)n.hasOwnProperty(o)&&o.indexOf("x-cos-")>-1&&(t[o]=n[o])})();var i={"x-cos-mfa":"MFA","Content-MD5":"ContentMD5","Content-Length":"ContentLength","Content-Type":"ContentType",Expect:"Expect",Expires:"Expires","Cache-Control":"CacheControl","Content-Disposition":"ContentDisposition","Content-Encoding":"ContentEncoding",Range:"Range","If-Modified-Since":"IfModifiedSince","If-Unmodified-Since":"IfUnmodifiedSince","If-Match":"IfMatch","If-None-Match":"IfNoneMatch","x-cos-copy-source":"CopySource","x-cos-copy-source-Range":"CopySourceRange","x-cos-metadata-directive":"MetadataDirective","x-cos-copy-source-If-Modified-Since":"CopySourceIfModifiedSince","x-cos-copy-source-If-Unmodified-Since":"CopySourceIfUnmodifiedSince","x-cos-copy-source-If-Match":"CopySourceIfMatch","x-cos-copy-source-If-None-Match":"CopySourceIfNoneMatch","x-cos-acl":"ACL","x-cos-grant-read":"GrantRead","x-cos-grant-write":"GrantWrite","x-cos-grant-full-control":"GrantFullControl","x-cos-grant-read-acp":"GrantReadAcp","x-cos-grant-write-acp":"GrantWriteAcp","x-cos-storage-class":"StorageClass","x-cos-traffic-limit":"TrafficLimit","x-cos-mime-limit":"MimeLimit","x-cos-server-side-encryption-customer-algorithm":"SSECustomerAlgorithm","x-cos-server-side-encryption-customer-key":"SSECustomerKey","x-cos-server-side-encryption-customer-key-MD5":"SSECustomerKeyMD5","x-cos-server-side-encryption":"ServerSideEncryption","x-cos-server-side-encryption-cos-kms-key-id":"SSEKMSKeyId","x-cos-server-side-encryption-context":"SSEContext"};util$5.each(i,function(o,r){n[o]!==void 0&&(t[r]=n[o])}),n.Headers=clearKey(t)}}return n},apiWrapper=function(e,n){return function(t,i){var o=this;typeof t=="function"&&(i=t,t={}),t=formatParams(e,t);var r=function(a){return a&&a.headers&&(a.headers["x-cos-request-id"]&&(a.RequestId=a.headers["x-cos-request-id"]),a.headers["x-cos-version-id"]&&(a.VersionId=a.headers["x-cos-version-id"]),a.headers["x-cos-delete-marker"]&&(a.DeleteMarker=a.headers["x-cos-delete-marker"])),a},s=function(a,f){i&&i(r(a),r(f))},u=function(){if(e!=="getService"&&e!=="abortUploadTask"){var a=hasMissingParams.call(o,e,t);if(a)return"missing param "+a;if(t.Region){if(o.options.CompatibilityMode){if(!/^([a-z\d-.]+)$/.test(t.Region))return"Region format error."}else{if(t.Region.indexOf("cos.")>-1)return'param Region should not be start with "cos."';if(!/^([a-z\d-]+)$/.test(t.Region))return"Region format error."}!o.options.CompatibilityMode&&t.Region.indexOf("-")===-1&&t.Region!=="yfb"&&t.Region!=="default"&&t.Region!=="accelerate"&&console.warn("warning: param Region format error, find help here: https://cloud.tencent.com/document/product/436/6224")}if(t.Bucket){if(!/^([a-z\d-]+)-(\d+)$/.test(t.Bucket))if(t.AppId)t.Bucket=t.Bucket+"-"+t.AppId;else if(o.options.AppId)t.Bucket=t.Bucket+"-"+o.options.AppId;else return'Bucket should format as "test-1250000000".';t.AppId&&(console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g Bucket:"test-1250000000" ).'),delete t.AppId)}!o.options.UseRawKey&&t.Key&&t.Key.substr(0,1)==="/"&&(t.Key=t.Key.substr(1))}},c=u(),l=e==="getAuth"||e==="getObjectUrl";if(window.Promise&&!l&&!i)return new Promise(function(a,f){if(i=function(p,S){p?f(p):a(S)},c)return s(util$5.error(new Error(c)));n.call(o,t,s)});if(c)return s(util$5.error(new Error(c)));var d=n.call(o,t,s);if(l)return d}},throttleOnProgress=function(e,n){var t=this,i=0,o=0,r=Date.now(),s,u;function c(){if(u=0,n&&typeof n=="function"){s=Date.now();var l=Math.max(0,Math.round((o-i)/((s-r)/1e3)*100)/100)||0,d;o===0&&e===0?d=1:d=Math.floor(o/e*100)/100||0,r=s,i=o;try{n({loaded:o,total:e,speed:l,percent:d})}catch{}}}return function(l,d){if(l&&(o=l.loaded,e=l.total),d)clearTimeout(u),c();else{if(u)return;u=setTimeout(c,t.options.ProgressInterval)}}},getFileSize=function(e,n,t){var i;if(typeof n.Body=="string"?n.Body=new Blob([n.Body],{type:"text/plain"}):n.Body instanceof ArrayBuffer&&(n.Body=new Blob([n.Body])),n.Body&&(n.Body instanceof Blob||n.Body.toString()==="[object File]"||n.Body.toString()==="[object Blob]"))i=n.Body.size;else{t(util$5.error(new Error("params body format error, Only allow File|Blob|String.")));return}n.ContentLength=i,t(null,i)},getSkewTime=function(e){return Date.now()+(e||0)},error=function(e,n){var t=e;return e.message=e.message||null,typeof n=="string"?(e.error=n,e.message=n):typeof n=="object"&&n!==null&&(extend(e,n),(n.code||n.name)&&(e.code=n.code||n.name),n.message&&(e.message=n.message),n.stack&&(e.stack=n.stack)),typeof Object.defineProperty=="function"&&(Object.defineProperty(e,"name",{writable:!0,enumerable:!1}),Object.defineProperty(e,"message",{enumerable:!0})),e.name=n&&n.name||e.name||e.code||"Error",e.code||(e.code=e.name),e.error||(e.error=clone(t)),e},isNode=function(){return typeof window!="object"&&typeof process=="object"&&typeof commonjsRequire=="function"},isCIHost=function(e){return/^https?:\/\/([^/]+\.)?ci\.[^/]+/.test(e)},util$5={noop,formatParams,apiWrapper,xml2json,json2xml,md5,clearKey,fileSlice,getBodyMd5,getFileMd5,binaryBase64,extend,isArray,isInArray,makeArray,each,map,filter,clone,attr,uuid,camSafeUrlEncode,throttleOnProgress,getFileSize,getSkewTime,error,obj2str,getAuth:getAuth$1,parseSelectPayload,getSourceParams,isBrowser:!0,isNode,isCIHost},util_1=util$5,event$1={},initEvent=function(e){var n={},t=function(i){return!n[i]&&(n[i]=[]),n[i]};e.on=function(i,o){i==="task-list-update"&&console.warn('warning: Event "'+i+'" has been deprecated. Please use "list-update" instead.'),t(i).push(o)},e.off=function(i,o){for(var r=t(i),s=r.length-1;s>=0;s--)o===r[s]&&r.splice(s,1)},e.emit=function(i,o){for(var r=t(i).map(function(u){return u}),s=0;s<r.length;s++)r[s](o)}},EventProxy$1=function(){initEvent(this)};event$1.init=initEvent;event$1.EventProxy=EventProxy$1;var task$1={},util$4=util_1,cacheKey="cos_sdk_upload_cache",expires=30*24*3600,cache,timer,getCache=function(){try{var e=JSON.parse(localStorage.getItem(cacheKey))}catch{}e||(e=[]),cache=e},setCache=function(){try{localStorage.setItem(cacheKey,JSON.stringify(cache))}catch{}},init=function(){if(!cache){getCache.call(this);for(var e=!1,n=Math.round(Date.now()/1e3),t=cache.length-1;t>=0;t--){var i=cache[t][2];(!i||i+expires<n)&&(cache.splice(t,1),e=!0)}e&&setCache()}},save=function(){timer||(timer=setTimeout(function(){setCache(),timer=null},400))},mod={using:{},setUsing:function(e){mod.using[e]=!0},removeUsing:function(e){delete mod.using[e]},getFileId:function(e,n,t,i){return e.name&&e.size&&e.lastModifiedDate&&n?util$4.md5([e.name,e.size,e.lastModifiedDate,n,t,i].join("::")):null},getUploadIdList:function(e){if(!e)return null;init.call(this);for(var n=[],t=0;t<cache.length;t++)cache[t][0]===e&&n.push(cache[t][1]);return n.length?n:null},saveUploadId:function(e,n,t){if(init.call(this),!!e){for(var i=cache.length-1;i>=0;i--){var o=cache[i];o[0]===e&&o[1]===n&&cache.splice(i,1)}cache.unshift([e,n,Math.round(Date.now()/1e3)]),cache.length>t&&cache.splice(t),save()}},removeUploadId:function(e){init.call(this),delete mod.using[e];for(var n=cache.length-1;n>=0;n--)cache[n][1]===e&&cache.splice(n,1);save()}},session$2=mod,session$1=session$2,util$3=util_1,originApiMap={},transferToTaskMethod=function(e,n){originApiMap[n]=e[n],e[n]=function(t,i){t.SkipTask?originApiMap[n].call(this,t,i):this._addTask(n,t,i)}},initTask=function(e){var n=[],t={},i=0,o=0,r=function(a){var f={id:a.id,Bucket:a.Bucket,Region:a.Region,Key:a.Key,FilePath:a.FilePath,state:a.state,loaded:a.loaded,size:a.size,speed:a.speed,percent:a.percent,hashPercent:a.hashPercent,error:a.error};return a.FilePath&&(f.FilePath=a.FilePath),a._custom&&(f._custom=a._custom),f},s=function(){var a,f=function(){a=0,e.emit("task-list-update",{list:util$3.map(n,r)}),e.emit("list-update",{list:util$3.map(n,r)})};return function(){a||(a=setTimeout(f))}}(),u=function(){if(!(n.length<=e.options.UploadQueueSize)){for(var a=0;a<o&&a<n.length&&n.length>e.options.UploadQueueSize;){var f=n[a].state==="waiting"||n[a].state==="checking"||n[a].state==="uploading";!n[a]||!f?(t[n[a].id]&&delete t[n[a].id],n.splice(a,1),o--):a++}s()}},c=function(){if(!(i>=e.options.FileParallelLimit)){for(;n[o]&&n[o].state!=="waiting";)o++;if(!(o>=n.length)){var a=n[o];o++,i++,a.state="checking",a.params.onTaskStart&&a.params.onTaskStart(r(a)),!a.params.UploadData&&(a.params.UploadData={});var f=util$3.formatParams(a.api,a.params);originApiMap[a.api].call(e,f,function(p,S){!e._isRunningTask(a.id)||((a.state==="checking"||a.state==="uploading")&&(a.state=p?"error":"success",p&&(a.error=p),i--,s(),c(),a.callback&&a.callback(p,S),a.state==="success"&&(a.params&&(delete a.params.UploadData,delete a.params.Body,delete a.params),delete a.callback)),u())}),s(),setTimeout(c)}}},l=function(a,f){var p=t[a];if(!!p){var S=p&&p.state==="waiting",g=p&&(p.state==="checking"||p.state==="uploading");if(f==="canceled"&&p.state!=="canceled"||f==="paused"&&S||f==="paused"&&g){if(f==="paused"&&p.params.Body&&typeof p.params.Body.pipe=="function"){console.error("stream not support pause");return}p.state=f,e.emit("inner-kill-task",{TaskId:a,toState:f});try{var h=p&&p.params&&p.params.UploadData.UploadId}catch{}f==="canceled"&&h&&session$1.removeUsing(h),s(),g&&(i--,c()),f==="canceled"&&(p.params&&(delete p.params.UploadData,delete p.params.Body,delete p.params),delete p.callback)}u()}};e._addTasks=function(a){util$3.each(a,function(f){e._addTask(f.api,f.params,f.callback,!0)}),s()};var d=!0;e._addTask=function(a,f,p,S){f=util$3.formatParams(a,f);var g=util$3.uuid();f.TaskId=g,f.onTaskReady&&f.onTaskReady(g),f.TaskReady&&(f.TaskReady(g),d&&console.warn('warning: Param "TaskReady" has been deprecated. Please use "onTaskReady" instead.'),d=!1);var h={params:f,callback:p,api:a,index:n.length,id:g,Bucket:f.Bucket,Region:f.Region,Key:f.Key,FilePath:f.FilePath||"",state:"waiting",loaded:0,size:0,speed:0,percent:0,hashPercent:0,error:null,_custom:f._custom},C=f.onHashProgress;f.onHashProgress=function(y){!e._isRunningTask(h.id)||(h.hashPercent=y.percent,C&&C(y),s())};var v=f.onProgress;return f.onProgress=function(y){!e._isRunningTask(h.id)||(h.state==="checking"&&(h.state="uploading"),h.loaded=y.loaded,h.speed=y.speed,h.percent=y.percent,v&&v(y),s())},util$3.getFileSize(a,f,function(y,R){if(y)return p(util$3.error(y));t[g]=h,n.push(h),h.size=R,!S&&s(),c(),u()}),g},e._isRunningTask=function(a){var f=t[a];return!!(f&&(f.state==="checking"||f.state==="uploading"))},e.getTaskList=function(){return util$3.map(n,r)},e.cancelTask=function(a){l(a,"canceled")},e.pauseTask=function(a){l(a,"paused")},e.restartTask=function(a){var f=t[a];f&&(f.state==="paused"||f.state==="error")&&(f.state="waiting",s(),o=Math.min(o,f.index),c())},e.isUploadRunning=function(){return i||o<n.length}};task$1.transferToTaskMethod=transferToTaskMethod;task$1.init=initTask;var base$1={},stringifyPrimitive=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},queryStringify=function(e,n,t,i){return n=n||"&",t=t||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(o){var r=encodeURIComponent(stringifyPrimitive(o))+t;return Array.isArray(e[o])?e[o].map(function(s){return r+encodeURIComponent(stringifyPrimitive(s))}).join(n):r+encodeURIComponent(stringifyPrimitive(e[o]))}).filter(Boolean).join(n):i?encodeURIComponent(stringifyPrimitive(i))+t+encodeURIComponent(stringifyPrimitive(e)):""},xhrRes=function(e,n,t){var i={};return n.getAllResponseHeaders().trim().split(`
`).forEach(function(o){if(o){var r=o.indexOf(":"),s=o.substr(0,r).trim().toLowerCase(),u=o.substr(r+1).trim();i[s]=u}}),{error:e,statusCode:n.status,statusMessage:n.statusText,headers:i,body:t}},xhrBody=function(e,n){return!n&&n==="text"?e.responseText:e.response},request$1=function(e,n){var t=(e.method||"GET").toUpperCase(),i=e.url;if(e.qs){var o=queryStringify(e.qs);o&&(i+=(i.indexOf("?")===-1?"?":"&")+o)}var r=new XMLHttpRequest;if(r.open(t,i,!0),r.responseType=e.dataType||"text",e.xhrFields)for(var s in e.xhrFields)r[s]=e.xhrFields[s];var u=e.headers;if(u)for(var c in u)u.hasOwnProperty(c)&&c.toLowerCase()!=="content-length"&&c.toLowerCase()!=="user-agent"&&c.toLowerCase()!=="origin"&&c.toLowerCase()!=="host"&&r.setRequestHeader(c,u[c]);return e.onProgress&&r.upload&&(r.upload.onprogress=e.onProgress),e.onDownloadProgress&&(r.onprogress=e.onDownloadProgress),e.timeout&&(r.timeout=e.timeout),r.ontimeout=function(l){var d=new Error("timeout");n(xhrRes(d,r))},r.onload=function(){n(xhrRes(null,r,xhrBody(r,e.dataType)))},r.onerror=function(l){var d=xhrBody(r,e.dataType);if(d)n(xhrRes(null,r,d));else{var a=r.statusText;!a&&r.status===0&&(a=new Error("CORS blocked or network error")),n(xhrRes(a,r,d))}},r.send(e.body||""),r},request_1=request$1,REQUEST=request_1,util$2=util_1;function getService(e,n){typeof e=="function"&&(n=e,e={});var t=this.options.Protocol||(util$2.isBrowser&&location.protocol==="http:"?"http:":"https:"),i=this.options.ServiceDomain,o=e.AppId||this.options.appId,r=e.Region;i?(i=i.replace(/\{\{AppId\}\}/ig,o||"").replace(/\{\{Region\}\}/ig,r||"").replace(/\{\{.*?\}\}/ig,""),/^[a-zA-Z]+:\/\//.test(i)||(i=t+"//"+i),i.slice(-1)==="/"&&(i=i.slice(0,-1))):r?i=t+"//cos."+r+".myqcloud.com":i=t+"//service.cos.myqcloud.com";var s="",u=r?"cos."+r+".myqcloud.com":"service.cos.myqcloud.com",c=i.replace(/^https?:\/\/([^/]+)(\/.*)?$/,"$1");u===c&&(s=u),submitRequest.call(this,{Action:"name/cos:GetService",url:i,method:"GET",headers:e.Headers,SignHost:s},function(l,d){if(l)return n(l);var a=d&&d.ListAllMyBucketsResult&&d.ListAllMyBucketsResult.Buckets&&d.ListAllMyBucketsResult.Buckets.Bucket||[];a=util$2.isArray(a)?a:[a];var f=d&&d.ListAllMyBucketsResult&&d.ListAllMyBucketsResult.Owner||{};n(null,{Buckets:a,Owner:f,statusCode:d.statusCode,headers:d.headers})})}function putBucket(e,n){var t=this,i="";if(e.BucketAZConfig){var o={BucketAZConfig:e.BucketAZConfig};i=util$2.json2xml({CreateBucketConfiguration:o})}submitRequest.call(this,{Action:"name/cos:PutBucket",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,body:i},function(r,s){if(r)return n(r);var u=getUrl({protocol:t.options.Protocol,domain:t.options.Domain,bucket:e.Bucket,region:e.Region,isLocation:!0});n(null,{Location:u,statusCode:s.statusCode,headers:s.headers})})}function headBucket(e,n){submitRequest.call(this,{Action:"name/cos:HeadBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"HEAD"},n)}function getBucket(e,n){var t={};t.prefix=e.Prefix||"",t.delimiter=e.Delimiter,t.marker=e.Marker,t["max-keys"]=e.MaxKeys,t["encoding-type"]=e.EncodingType,submitRequest.call(this,{Action:"name/cos:GetBucket",ResourceKey:t.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:t},function(i,o){if(i)return n(i);var r=o.ListBucketResult||{},s=r.Contents||[],u=r.CommonPrefixes||[];s=util$2.isArray(s)?s:[s],u=util$2.isArray(u)?u:[u];var c=util$2.clone(r);util$2.extend(c,{Contents:s,CommonPrefixes:u,statusCode:o.statusCode,headers:o.headers}),n(null,c)})}function deleteBucket(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"DELETE"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketAcl(e,n){var t=e.Headers,i="";if(e.AccessControlPolicy){var o=util$2.clone(e.AccessControlPolicy||{}),r=o.Grants||o.Grant;r=util$2.isArray(r)?r:[r],delete o.Grant,delete o.Grants,o.AccessControlList={Grant:r},i=util$2.json2xml({AccessControlPolicy:o}),t["Content-Type"]="application/xml",t["Content-MD5"]=util$2.binaryBase64(util$2.md5(i))}util$2.each(t,function(s,u){u.indexOf("x-cos-grant-")===0&&(t[u]=uniqGrant(t[u]))}),submitRequest.call(this,{Action:"name/cos:PutBucketACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:t,action:"acl",body:i},function(s,u){if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketAcl(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketACL",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"acl"},function(t,i){if(t)return n(t);var o=i.AccessControlPolicy||{},r=o.Owner||{},s=o.AccessControlList.Grant||[];s=util$2.isArray(s)?s:[s];var u=decodeAcl(o);i.headers&&i.headers["x-cos-acl"]&&(u.ACL=i.headers["x-cos-acl"]),u=util$2.extend(u,{Owner:r,Grants:s,statusCode:i.statusCode,headers:i.headers}),n(null,u)})}function putBucketCors(e,n){var t=e.CORSConfiguration||{},i=t.CORSRules||e.CORSRules||[];i=util$2.clone(util$2.isArray(i)?i:[i]),util$2.each(i,function(s){util$2.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(u){var c=u+"s",l=s[c]||s[u]||[];delete s[c],s[u]=util$2.isArray(l)?l:[l]})});var o=util$2.json2xml({CORSConfiguration:{CORSRule:i}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketCORS",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"cors",headers:r},function(s,u){if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketCors(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketCORS",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors"},function(t,i){if(t){if(t.statusCode===404&&t.error&&t.error.Code==="NoSuchCORSConfiguration"){var o={CORSRules:[],statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=i.CORSConfiguration||{},s=r.CORSRules||r.CORSRule||[];s=util$2.clone(util$2.isArray(s)?s:[s]),util$2.each(s,function(u){util$2.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(c){var l=c+"s",d=u[l]||u[c]||[];delete u[c],u[l]=util$2.isArray(d)?d:[d]})}),n(null,{CORSRules:s,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketCors(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketCORS",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode||t.statusCode,headers:i.headers})})}function getBucketLocation(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketLocation",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"location"},n)}function putBucketPolicy(e,n){var t=e.Policy;try{typeof t=="string"&&(t=JSON.parse(t))}catch{}if(!t||typeof t=="string")return n(util$2.error(new Error("Policy format error")));var i=JSON.stringify(t);t.version||(t.version="2.0");var o=e.Headers;o["Content-Type"]="application/json",o["Content-MD5"]=util$2.binaryBase64(util$2.md5(i)),submitRequest.call(this,{Action:"name/cos:PutBucketPolicy",method:"PUT",Bucket:e.Bucket,Region:e.Region,action:"policy",body:i,headers:o},function(r,s){if(r&&r.statusCode===204)return n(null,{statusCode:r.statusCode});if(r)return n(r);n(null,{statusCode:s.statusCode,headers:s.headers})})}function getBucketPolicy(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketPolicy",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy",rawBody:!0},function(t,i){if(t)return t.statusCode&&t.statusCode===403?n(util$2.error(t,{ErrorStatus:"Access Denied"})):t.statusCode&&t.statusCode===405?n(util$2.error(t,{ErrorStatus:"Method Not Allowed"})):t.statusCode&&t.statusCode===404?n(util$2.error(t,{ErrorStatus:"Policy Not Found"})):n(t);var o={};try{o=JSON.parse(i.body)}catch{}n(null,{Policy:o,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketPolicy(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketPolicy",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode||t.statusCode,headers:i.headers})})}function putBucketTagging(e,n){var t=e.Tagging||{},i=t.TagSet||t.Tags||e.Tags||[];i=util$2.clone(util$2.isArray(i)?i:[i]);var o=util$2.json2xml({Tagging:{TagSet:{Tag:i}}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketTagging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"tagging",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketTagging(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketTagging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging"},function(t,i){if(t){if(t.statusCode===404&&t.error&&(t.error==="Not Found"||t.error.Code==="NoSuchTagSet")){var o={Tags:[],statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=[];try{r=i.Tagging.TagSet.Tag||[]}catch{}r=util$2.clone(util$2.isArray(r)?r:[r]),n(null,{Tags:r,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketTagging(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketLifecycle(e,n){var t=e.LifecycleConfiguration||{},i=t.Rules||e.Rules||[];i=util$2.clone(i);var o=util$2.json2xml({LifecycleConfiguration:{Rule:i}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketLifecycle",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"lifecycle",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketLifecycle(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketLifecycle",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle"},function(t,i){if(t){if(t.statusCode===404&&t.error&&t.error.Code==="NoSuchLifecycleConfiguration"){var o={Rules:[],statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=[];try{r=i.LifecycleConfiguration.Rule||[]}catch{}r=util$2.clone(util$2.isArray(r)?r:[r]),n(null,{Rules:r,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketLifecycle(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketLifecycle",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketVersioning(e,n){if(!e.VersioningConfiguration){n(util$2.error(new Error("missing param VersioningConfiguration")));return}var t=e.VersioningConfiguration||{},i=util$2.json2xml({VersioningConfiguration:t}),o=e.Headers;o["Content-Type"]="application/xml",o["Content-MD5"]=util$2.binaryBase64(util$2.md5(i)),submitRequest.call(this,{Action:"name/cos:PutBucketVersioning",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:i,action:"versioning",headers:o},function(r,s){if(r&&r.statusCode===204)return n(null,{statusCode:r.statusCode});if(r)return n(r);n(null,{statusCode:s.statusCode,headers:s.headers})})}function getBucketVersioning(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketVersioning",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"versioning"},function(t,i){t||!i.VersioningConfiguration&&(i.VersioningConfiguration={}),n(t,i)})}function putBucketReplication(e,n){var t=util$2.clone(e.ReplicationConfiguration),i=util$2.json2xml({ReplicationConfiguration:t});i=i.replace(/<(\/?)Rules>/ig,"<$1Rule>"),i=i.replace(/<(\/?)Tags>/ig,"<$1Tag>");var o=e.Headers;o["Content-Type"]="application/xml",o["Content-MD5"]=util$2.binaryBase64(util$2.md5(i)),submitRequest.call(this,{Action:"name/cos:PutBucketReplication",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:i,action:"replication",headers:o},function(r,s){if(r&&r.statusCode===204)return n(null,{statusCode:r.statusCode});if(r)return n(r);n(null,{statusCode:s.statusCode,headers:s.headers})})}function getBucketReplication(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketReplication",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication"},function(t,i){if(t){if(t.statusCode===404&&t.error&&(t.error==="Not Found"||t.error.Code==="ReplicationConfigurationnotFoundError")){var o={ReplicationConfiguration:{Rules:[]},statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}!i.ReplicationConfiguration&&(i.ReplicationConfiguration={}),i.ReplicationConfiguration.Rule&&(i.ReplicationConfiguration.Rules=util$2.makeArray(i.ReplicationConfiguration.Rule),delete i.ReplicationConfiguration.Rule),n(t,i)})}function deleteBucketReplication(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketWebsite(e,n){if(!e.WebsiteConfiguration){n(util$2.error(new Error("missing param WebsiteConfiguration")));return}var t=util$2.clone(e.WebsiteConfiguration||{}),i=t.RoutingRules||t.RoutingRule||[];i=util$2.isArray(i)?i:[i],delete t.RoutingRule,delete t.RoutingRules,i.length&&(t.RoutingRules={RoutingRule:i});var o=util$2.json2xml({WebsiteConfiguration:t}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketWebsite",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"website",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketWebsite(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketWebsite",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"website"},function(t,i){if(t){if(t.statusCode===404&&t.error.Code==="NoSuchWebsiteConfiguration"){var o={WebsiteConfiguration:{},statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=i.WebsiteConfiguration||{};if(r.RoutingRules){var s=util$2.clone(r.RoutingRules.RoutingRule||[]);s=util$2.makeArray(s),r.RoutingRules=s}n(null,{WebsiteConfiguration:r,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketWebsite(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketWebsite",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"website"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketReferer(e,n){if(!e.RefererConfiguration){n(util$2.error(new Error("missing param RefererConfiguration")));return}var t=util$2.clone(e.RefererConfiguration||{}),i=t.DomainList||{},o=i.Domains||i.Domain||[];o=util$2.isArray(o)?o:[o],o.length&&(t.DomainList={Domain:o});var r=util$2.json2xml({RefererConfiguration:t}),s=e.Headers;s["Content-Type"]="application/xml",s["Content-MD5"]=util$2.binaryBase64(util$2.md5(r)),submitRequest.call(this,{Action:"name/cos:PutBucketReferer",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"referer",headers:s},function(u,c){if(u&&u.statusCode===204)return n(null,{statusCode:u.statusCode});if(u)return n(u);n(null,{statusCode:c.statusCode,headers:c.headers})})}function getBucketReferer(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketReferer",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"referer"},function(t,i){if(t){if(t.statusCode===404&&t.error.Code==="NoSuchRefererConfiguration"){var o={WebsiteConfiguration:{},statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=i.RefererConfiguration||{};if(r.DomainList){var s=util$2.makeArray(r.DomainList.Domain||[]);r.DomainList={Domains:s}}n(null,{RefererConfiguration:r,statusCode:i.statusCode,headers:i.headers})})}function putBucketDomain(e,n){var t=e.DomainConfiguration||{},i=t.DomainRule||e.DomainRule||[];i=util$2.clone(i);var o=util$2.json2xml({DomainConfiguration:{DomainRule:i}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketDomain",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"domain",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketDomain(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketDomain",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"domain"},function(t,i){if(t)return n(t);var o=[];try{o=i.DomainConfiguration.DomainRule||[]}catch{}o=util$2.clone(util$2.isArray(o)?o:[o]),n(null,{DomainRule:o,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketDomain(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketDomain",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"domain"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketOrigin(e,n){var t=e.OriginConfiguration||{},i=t.OriginRule||e.OriginRule||[];i=util$2.clone(i);var o=util$2.json2xml({OriginConfiguration:{OriginRule:i}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketOrigin",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"origin",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketOrigin(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketOrigin",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"origin"},function(t,i){if(t)return n(t);var o=[];try{o=i.OriginConfiguration.OriginRule||[]}catch{}o=util$2.clone(util$2.isArray(o)?o:[o]),n(null,{OriginRule:o,statusCode:i.statusCode,headers:i.headers})})}function deleteBucketOrigin(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketOrigin",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"origin"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketLogging(e,n){var t=util$2.json2xml({BucketLoggingStatus:e.BucketLoggingStatus||""}),i=e.Headers;i["Content-Type"]="application/xml",i["Content-MD5"]=util$2.binaryBase64(util$2.md5(t)),submitRequest.call(this,{Action:"name/cos:PutBucketLogging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:t,action:"logging",headers:i},function(o,r){if(o&&o.statusCode===204)return n(null,{statusCode:o.statusCode});if(o)return n(o);n(null,{statusCode:r.statusCode,headers:r.headers})})}function getBucketLogging(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketLogging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"logging"},function(t,i){if(t)return n(t);n(null,{BucketLoggingStatus:i.BucketLoggingStatus,statusCode:i.statusCode,headers:i.headers})})}function putBucketInventory(e,n){var t=util$2.clone(e.InventoryConfiguration);if(t.OptionalFields){var i=t.OptionalFields||[];t.OptionalFields={Field:i}}if(t.Destination&&t.Destination.COSBucketDestination&&t.Destination.COSBucketDestination.Encryption){var o=t.Destination.COSBucketDestination.Encryption;Object.keys(o).indexOf("SSECOS")>-1&&(o["SSE-COS"]=o.SSECOS,delete o.SSECOS)}var r=util$2.json2xml({InventoryConfiguration:t}),s=e.Headers;s["Content-Type"]="application/xml",s["Content-MD5"]=util$2.binaryBase64(util$2.md5(r)),submitRequest.call(this,{Action:"name/cos:PutBucketInventory",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"inventory",qs:{id:e.Id},headers:s},function(u,c){if(u&&u.statusCode===204)return n(null,{statusCode:u.statusCode});if(u)return n(u);n(null,{statusCode:c.statusCode,headers:c.headers})})}function getBucketInventory(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketInventory",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{id:e.Id}},function(t,i){if(t)return n(t);var o=i.InventoryConfiguration;if(o&&o.OptionalFields&&o.OptionalFields.Field){var r=o.OptionalFields.Field;util$2.isArray(r)||(r=[r]),o.OptionalFields=r}if(o.Destination&&o.Destination.COSBucketDestination&&o.Destination.COSBucketDestination.Encryption){var s=o.Destination.COSBucketDestination.Encryption;Object.keys(s).indexOf("SSE-COS")>-1&&(s.SSECOS=s["SSE-COS"],delete s["SSE-COS"])}n(null,{InventoryConfiguration:o,statusCode:i.statusCode,headers:i.headers})})}function listBucketInventory(e,n){submitRequest.call(this,{Action:"name/cos:ListBucketInventory",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{"continuation-token":e.ContinuationToken}},function(t,i){if(t)return n(t);var o=i.ListInventoryConfigurationResult,r=o.InventoryConfiguration||[];r=util$2.isArray(r)?r:[r],delete o.InventoryConfiguration,util$2.each(r,function(s){if(s&&s.OptionalFields&&s.OptionalFields.Field){var u=s.OptionalFields.Field;util$2.isArray(u)||(u=[u]),s.OptionalFields=u}if(s.Destination&&s.Destination.COSBucketDestination&&s.Destination.COSBucketDestination.Encryption){var c=s.Destination.COSBucketDestination.Encryption;Object.keys(c).indexOf("SSE-COS")>-1&&(c.SSECOS=c["SSE-COS"],delete c["SSE-COS"])}}),o.InventoryConfigurations=r,util$2.extend(o,{statusCode:i.statusCode,headers:i.headers}),n(null,o)})}function deleteBucketInventory(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketInventory",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{id:e.Id}},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function putBucketAccelerate(e,n){if(!e.AccelerateConfiguration){n(util$2.error(new Error("missing param AccelerateConfiguration")));return}var t={AccelerateConfiguration:e.AccelerateConfiguration||{}},i=util$2.json2xml(t),o={};o["Content-Type"]="application/xml",o["Content-MD5"]=util$2.binaryBase64(util$2.md5(i)),submitRequest.call(this,{Action:"name/cos:PutBucketAccelerate",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:i,action:"accelerate",headers:o},function(r,s){if(r)return n(r);n(null,{statusCode:s.statusCode,headers:s.headers})})}function getBucketAccelerate(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketAccelerate",method:"GET",Bucket:e.Bucket,Region:e.Region,action:"accelerate"},function(t,i){t||!i.AccelerateConfiguration&&(i.AccelerateConfiguration={}),n(t,i)})}function putBucketEncryption(e,n){var t=e.ServerSideEncryptionConfiguration||{},i=t.Rule||t.Rules||[],o=util$2.json2xml({ServerSideEncryptionConfiguration:{Rule:i}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutBucketEncryption",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"encryption",headers:r},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getBucketEncryption(e,n){submitRequest.call(this,{Action:"name/cos:GetBucketEncryption",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"encryption"},function(t,i){if(t){if(t.statusCode===404&&t.code==="NoSuchEncryptionConfiguration"){var o={EncryptionConfiguration:{Rules:[]},statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=util$2.makeArray(i.EncryptionConfiguration&&i.EncryptionConfiguration.Rule||[]);i.EncryptionConfiguration={Rules:r},n(t,i)})}function deleteBucketEncryption(e,n){submitRequest.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"encryption"},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function headObject(e,n){submitRequest.call(this,{Action:"name/cos:HeadObject",method:"HEAD",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers},function(t,i){if(t){var o=t.statusCode;return e.Headers["If-Modified-Since"]&&o&&o===304?n(null,{NotModified:!0,statusCode:o}):n(t)}i.ETag=util$2.attr(i.headers,"etag",""),n(null,i)})}function listObjectVersions(e,n){var t={};t.prefix=e.Prefix||"",t.delimiter=e.Delimiter,t["key-marker"]=e.KeyMarker,t["version-id-marker"]=e.VersionIdMarker,t["max-keys"]=e.MaxKeys,t["encoding-type"]=e.EncodingType,submitRequest.call(this,{Action:"name/cos:GetBucketObjectVersions",ResourceKey:t.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:t,action:"versions"},function(i,o){if(i)return n(i);var r=o.ListVersionsResult||{},s=r.DeleteMarker||[];s=util$2.isArray(s)?s:[s];var u=r.Version||[];u=util$2.isArray(u)?u:[u];var c=util$2.clone(r);delete c.DeleteMarker,delete c.Version,util$2.extend(c,{DeleteMarkers:s,Versions:u,statusCode:o.statusCode,headers:o.headers}),n(null,c)})}function getObject(e,n){var t=e.Query||{},i=e.QueryString||"",o=util$2.throttleOnProgress.call(this,0,e.onProgress);t["response-content-type"]=e.ResponseContentType,t["response-content-language"]=e.ResponseContentLanguage,t["response-expires"]=e.ResponseExpires,t["response-cache-control"]=e.ResponseCacheControl,t["response-content-disposition"]=e.ResponseContentDisposition,t["response-content-encoding"]=e.ResponseContentEncoding,submitRequest.call(this,{Action:"name/cos:GetObject",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,DataType:e.DataType,headers:e.Headers,qs:t,qsStr:i,rawBody:!0,onDownloadProgress:o},function(r,s){if(o(null,!0),r){var u=r.statusCode;return e.Headers["If-Modified-Since"]&&u&&u===304?n(null,{NotModified:!0}):n(r)}n(null,{Body:s.body,ETag:util$2.attr(s.headers,"etag",""),statusCode:s.statusCode,headers:s.headers})})}function putObject(e,n){var t=this,i=e.ContentLength,o=util$2.throttleOnProgress.call(t,i,e.onProgress),r=e.Headers;!r["Cache-Control"]&&!r["cache-control"]&&(r["Cache-Control"]=""),!r["Content-Type"]&&!r["content-type"]&&(r["Content-Type"]=e.Body&&e.Body.type||"");var s=e.UploadAddMetaMd5||t.options.UploadAddMetaMd5||t.options.UploadCheckContentMd5;util$2.getBodyMd5(s,e.Body,function(u){u&&(t.options.UploadCheckContentMd5&&(r["Content-MD5"]=util$2.binaryBase64(u)),(e.UploadAddMetaMd5||t.options.UploadAddMetaMd5)&&(r["x-cos-meta-md5"]=u)),e.ContentLength!==void 0&&(r["Content-Length"]=e.ContentLength),o(null,!0),submitRequest.call(t,{Action:"name/cos:PutObject",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:e.Query,body:e.Body,onProgress:o},function(c,l){if(c)return o(null,!0),n(c);o({loaded:i,total:i},!0);var d=getUrl({ForcePathStyle:t.options.ForcePathStyle,protocol:t.options.Protocol,domain:t.options.Domain,bucket:e.Bucket,region:t.options.UseAccelerate?"accelerate":e.Region,object:e.Key});d=d.substr(d.indexOf("://")+3),l.Location=d,l.ETag=util$2.attr(l.headers,"etag",""),n(null,l)})},e.onHashProgress)}function deleteObject(e,n){submitRequest.call(this,{Action:"name/cos:DeleteObject",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,VersionId:e.VersionId,action:e.Recursive?"recursive":""},function(t,i){if(t){var o=t.statusCode;return o&&o===404?n(null,{BucketNotFound:!0,statusCode:o}):n(t)}n(null,{statusCode:i.statusCode,headers:i.headers})})}function getObjectAcl(e,n){submitRequest.call(this,{Action:"name/cos:GetObjectACL",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"acl"},function(t,i){if(t)return n(t);var o=i.AccessControlPolicy||{},r=o.Owner||{},s=o.AccessControlList&&o.AccessControlList.Grant||[];s=util$2.isArray(s)?s:[s];var u=decodeAcl(o);delete u.GrantWrite,i.headers&&i.headers["x-cos-acl"]&&(u.ACL=i.headers["x-cos-acl"]),u=util$2.extend(u,{Owner:r,Grants:s,statusCode:i.statusCode,headers:i.headers}),n(null,u)})}function putObjectAcl(e,n){var t=e.Headers,i="";if(e.AccessControlPolicy){var o=util$2.clone(e.AccessControlPolicy||{}),r=o.Grants||o.Grant;r=util$2.isArray(r)?r:[r],delete o.Grant,delete o.Grants,o.AccessControlList={Grant:r},i=util$2.json2xml({AccessControlPolicy:o}),t["Content-Type"]="application/xml",t["Content-MD5"]=util$2.binaryBase64(util$2.md5(i))}util$2.each(t,function(s,u){u.indexOf("x-cos-grant-")===0&&(t[u]=uniqGrant(t[u]))}),submitRequest.call(this,{Action:"name/cos:PutObjectACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"acl",headers:t,body:i},function(s,u){if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function optionsObject(e,n){var t=e.Headers;t.Origin=e.Origin,t["Access-Control-Request-Method"]=e.AccessControlRequestMethod,t["Access-Control-Request-Headers"]=e.AccessControlRequestHeaders,submitRequest.call(this,{Action:"name/cos:OptionsObject",method:"OPTIONS",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:t},function(i,o){if(i)return i.statusCode&&i.statusCode===403?n(null,{OptionsForbidden:!0,statusCode:i.statusCode}):n(i);var r=o.headers||{};n(null,{AccessControlAllowOrigin:r["access-control-allow-origin"],AccessControlAllowMethods:r["access-control-allow-methods"],AccessControlAllowHeaders:r["access-control-allow-headers"],AccessControlExposeHeaders:r["access-control-expose-headers"],AccessControlMaxAge:r["access-control-max-age"],statusCode:o.statusCode,headers:o.headers})})}function putObjectCopy(e,n){var t=this,i=e.Headers;!i["Cache-Control"]&&!i["cache-control"]&&(i["Cache-Control"]="");var o=e.CopySource||"",r=util$2.getSourceParams.call(this,o);if(!r){n(util$2.error(new Error("CopySource format error")));return}var s=r[1],u=r[3],c=decodeURIComponent(r[4]);submitRequest.call(this,{Scope:[{action:"name/cos:GetObject",bucket:s,region:u,prefix:c},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers},function(l,d){if(l)return n(l);var a=util$2.clone(d.CopyObjectResult||{}),f=getUrl({ForcePathStyle:t.options.ForcePathStyle,protocol:t.options.Protocol,domain:t.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key,isLocation:!0});util$2.extend(a,{Location:f,statusCode:d.statusCode,headers:d.headers}),n(null,a)})}function uploadPartCopy(e,n){var t=e.CopySource||"",i=util$2.getSourceParams.call(this,t);if(!i){n(util$2.error(new Error("CopySource format error")));return}var o=i[1],r=i[3],s=decodeURIComponent(i[4]);submitRequest.call(this,{Scope:[{action:"name/cos:GetObject",bucket:o,region:r,prefix:s},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers},function(u,c){if(u)return n(u);var l=util$2.clone(c.CopyPartResult||{});util$2.extend(l,{statusCode:c.statusCode,headers:c.headers}),n(null,l)})}function deleteMultipleObject(e,n){var t=e.Objects||[],i=e.Quiet;t=util$2.isArray(t)?t:[t];var o=util$2.json2xml({Delete:{Object:t,Quiet:i||!1}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o));var s=util$2.map(t,function(u){return{action:"name/cos:DeleteObject",bucket:e.Bucket,region:e.Region,prefix:u.Key}});submitRequest.call(this,{Scope:s,method:"POST",Bucket:e.Bucket,Region:e.Region,body:o,action:"delete",headers:r},function(u,c){if(u)return n(u);var l=c.DeleteResult||{},d=l.Deleted||[],a=l.Error||[];d=util$2.isArray(d)?d:[d],a=util$2.isArray(a)?a:[a];var f=util$2.clone(l);util$2.extend(f,{Error:a,Deleted:d,statusCode:c.statusCode,headers:c.headers}),n(null,f)})}function restoreObject(e,n){var t=e.Headers;if(!e.RestoreRequest){n(util$2.error(new Error("missing param RestoreRequest")));return}var i=e.RestoreRequest||{},o=util$2.json2xml({RestoreRequest:i});t["Content-Type"]="application/xml",t["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:RestoreObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,body:o,action:"restore",headers:t},n)}function putObjectTagging(e,n){var t=e.Tagging||{},i=t.TagSet||t.Tags||e.Tags||[];i=util$2.clone(util$2.isArray(i)?i:[i]);var o=util$2.json2xml({Tagging:{TagSet:{Tag:i}}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:PutObjectTagging",method:"PUT",Bucket:e.Bucket,Key:e.Key,Region:e.Region,body:o,action:"tagging",headers:r,VersionId:e.VersionId},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);n(null,{statusCode:u.statusCode,headers:u.headers})})}function getObjectTagging(e,n){submitRequest.call(this,{Action:"name/cos:GetObjectTagging",method:"GET",Key:e.Key,Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging",VersionId:e.VersionId},function(t,i){if(t){if(t.statusCode===404&&t.error&&(t.error==="Not Found"||t.error.Code==="NoSuchTagSet")){var o={Tags:[],statusCode:t.statusCode};t.headers&&(o.headers=t.headers),n(null,o)}else n(t);return}var r=[];try{r=i.Tagging.TagSet.Tag||[]}catch{}r=util$2.clone(util$2.isArray(r)?r:[r]),n(null,{Tags:r,statusCode:i.statusCode,headers:i.headers})})}function deleteObjectTagging(e,n){submitRequest.call(this,{Action:"name/cos:DeleteObjectTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"tagging",VersionId:e.VersionId},function(t,i){if(t&&t.statusCode===204)return n(null,{statusCode:t.statusCode});if(t)return n(t);n(null,{statusCode:i.statusCode,headers:i.headers})})}function selectObjectContent(e,n){var t=e.SelectType;if(!t)return n(util$2.error(new Error("missing param SelectType")));var i=e.SelectRequest||{},o=util$2.json2xml({SelectRequest:i}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=util$2.binaryBase64(util$2.md5(o)),submitRequest.call(this,{Action:"name/cos:GetObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"select",qs:{"select-type":e.SelectType},VersionId:e.VersionId,body:o,DataType:"arraybuffer",rawBody:!0},function(s,u){if(s&&s.statusCode===204)return n(null,{statusCode:s.statusCode});if(s)return n(s);var c=util$2.parseSelectPayload(u.body);n(null,{statusCode:u.statusCode,headers:u.headers,Body:c.body,Payload:c.payload})})}function multipartInit(e,n){var t=this,i=e.Headers;!i["Cache-Control"]&&!i["cache-control"]&&(i["Cache-Control"]=""),!i["Content-Type"]&&!i["content-type"]&&(i["Content-Type"]=e.Body&&e.Body.type||""),util$2.getBodyMd5(e.Body&&(e.UploadAddMetaMd5||t.options.UploadAddMetaMd5),e.Body,function(o){o&&(e.Headers["x-cos-meta-md5"]=o),submitRequest.call(t,{Action:"name/cos:InitiateMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"uploads",headers:e.Headers,qs:e.Query},function(r,s){if(r)return n(r);if(s=util$2.clone(s||{}),s&&s.InitiateMultipartUploadResult)return n(null,util$2.extend(s.InitiateMultipartUploadResult,{statusCode:s.statusCode,headers:s.headers}));n(null,s)})},e.onHashProgress)}function multipartUpload(e,n){var t=this;util$2.getFileSize("multipartUpload",e,function(){util$2.getBodyMd5(t.options.UploadCheckContentMd5,e.Body,function(i){i&&(e.Headers["Content-MD5"]=util$2.binaryBase64(i)),submitRequest.call(t,{Action:"name/cos:UploadPart",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers,onProgress:e.onProgress,body:e.Body||null},function(o,r){if(o)return n(o);n(null,{ETag:util$2.attr(r.headers,"etag",""),statusCode:r.statusCode,headers:r.headers})})})})}function multipartComplete(e,n){for(var t=this,i=e.UploadId,o=e.Parts,r=0,s=o.length;r<s;r++)o[r].ETag&&o[r].ETag.indexOf('"')===0||(o[r].ETag='"'+o[r].ETag+'"');var u=util$2.json2xml({CompleteMultipartUpload:{Part:o}});u=u.replace(/\n\s*/g,"");var c=e.Headers;c["Content-Type"]="application/xml",c["Content-MD5"]=util$2.binaryBase64(util$2.md5(u)),submitRequest.call(this,{Action:"name/cos:CompleteMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{uploadId:i},body:u,headers:c},function(l,d){if(l)return n(l);var a=getUrl({ForcePathStyle:t.options.ForcePathStyle,protocol:t.options.Protocol,domain:t.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key,isLocation:!0}),f=d.CompleteMultipartUploadResult||{};f.ProcessResults&&f&&f.ProcessResults&&(f.UploadResult={OriginalInfo:{Key:f.Key,Location:a,ETag:f.ETag,ImageInfo:f.ImageInfo},ProcessResults:f.ProcessResults},delete f.ImageInfo,delete f.ProcessResults);var p=util$2.extend(f,{Location:a,statusCode:d.statusCode,headers:d.headers});n(null,p)})}function multipartList(e,n){var t={};t.delimiter=e.Delimiter,t["encoding-type"]=e.EncodingType,t.prefix=e.Prefix||"",t["max-uploads"]=e.MaxUploads,t["key-marker"]=e.KeyMarker,t["upload-id-marker"]=e.UploadIdMarker,t=util$2.clearKey(t),submitRequest.call(this,{Action:"name/cos:ListMultipartUploads",ResourceKey:t.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:t,action:"uploads"},function(i,o){if(i)return n(i);if(o&&o.ListMultipartUploadsResult){var r=o.ListMultipartUploadsResult.Upload||[];r=util$2.isArray(r)?r:[r],o.ListMultipartUploadsResult.Upload=r}var s=util$2.clone(o.ListMultipartUploadsResult||{});util$2.extend(s,{statusCode:o.statusCode,headers:o.headers}),n(null,s)})}function multipartListPart(e,n){var t={};t.uploadId=e.UploadId,t["encoding-type"]=e.EncodingType,t["max-parts"]=e.MaxParts,t["part-number-marker"]=e.PartNumberMarker,submitRequest.call(this,{Action:"name/cos:ListParts",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:t},function(i,o){if(i)return n(i);var r=o.ListPartsResult||{},s=r.Part||[];s=util$2.isArray(s)?s:[s],r.Part=s;var u=util$2.clone(r);util$2.extend(u,{statusCode:o.statusCode,headers:o.headers}),n(null,u)})}function multipartAbort(e,n){var t={};t.uploadId=e.UploadId,submitRequest.call(this,{Action:"name/cos:AbortMultipartUpload",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:t},function(i,o){if(i)return n(i);n(null,{statusCode:o.statusCode,headers:o.headers})})}function request(e,n){submitRequest.call(this,{method:e.Method,Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:e.Action,headers:e.Headers,qs:e.Query,body:e.Body,Url:e.Url,rawBody:e.RawBody},function(t,i){if(t)return n(t);i&&i.body&&(i.Body=i.body,delete i.body),n(t,i)})}function appendObject(e,n){var t=e.Headers;!t["Cache-Control"]&&!t["cache-control"]&&(t["Cache-Control"]=""),!t["Content-Type"]&&!t["content-type"]&&(t["Content-Type"]=e.Body&&e.Body.type||""),submitRequest.call(this,{Action:"name/cos:AppendObject",method:"POST",Bucket:e.Bucket,Region:e.Region,action:"append",Key:e.Key,body:e.Body,qs:{position:e.Position},headers:e.Headers},function(i,o){if(i)return n(i);n(null,o)})}function getAuth(e){var n=this;return util$2.getAuth({SecretId:e.SecretId||this.options.SecretId||"",SecretKey:e.SecretKey||this.options.SecretKey||"",Bucket:e.Bucket,Region:e.Region,Method:e.Method,Key:e.Key,Query:e.Query,Headers:e.Headers,Expires:e.Expires,UseRawKey:n.options.UseRawKey,SystemClockOffset:n.options.SystemClockOffset})}function getObjectUrl(e,n){var t=this,i=getUrl({ForcePathStyle:t.options.ForcePathStyle,protocol:e.Protocol||t.options.Protocol,domain:e.Domain||t.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key}),o="";e.Query&&(o+=util$2.obj2str(e.Query)),e.QueryString&&(o+=(o?"&":"")+e.QueryString);var r=i;if(e.Sign!==void 0&&!e.Sign)return o&&(r+="?"+o),n(null,{Url:r}),r;var s=getSignHost.call(this,{Bucket:e.Bucket,Region:e.Region,Url:i}),u=getAuthorizationAsync.call(this,{Action:(e.Method||"").toUpperCase()==="PUT"?"name/cos:PutObject":"name/cos:GetObject",Bucket:e.Bucket||"",Region:e.Region||"",Method:e.Method||"get",Key:e.Key,Expires:e.Expires,Headers:e.Headers,Query:e.Query,SignHost:s},function(c,l){if(!!n){if(c){n(c);return}var d=function(f){var p=f.match(/q-url-param-list.*?(?=&)/g)[0],S="q-url-param-list="+encodeURIComponent(p.replace(/q-url-param-list=/,"")).toLowerCase(),g=new RegExp(p,"g"),h=f.replace(g,S);return h},a=i;a+="?"+(l.Authorization.indexOf("q-signature")>-1?d(l.Authorization):"sign="+encodeURIComponent(l.Authorization)),l.SecurityToken&&(a+="&x-cos-security-token="+l.SecurityToken),l.ClientIP&&(a+="&clientIP="+l.ClientIP),l.ClientUA&&(a+="&clientUA="+l.ClientUA),l.Token&&(a+="&token="+l.Token),o&&(a+="&"+o),setTimeout(function(){n(null,{Url:a})})}});return u?(r+="?"+u.Authorization+(u.SecurityToken?"&x-cos-security-token="+u.SecurityToken:""),o&&(r+="&"+o)):o&&(r+="?"+o),r}function decodeAcl(e){var n={GrantFullControl:[],GrantWrite:[],GrantRead:[],GrantReadAcp:[],GrantWriteAcp:[],ACL:""},t={FULL_CONTROL:"GrantFullControl",WRITE:"GrantWrite",READ:"GrantRead",READ_ACP:"GrantReadAcp",WRITE_ACP:"GrantWriteAcp"},i=e&&e.AccessControlList||{},o=i.Grant;o&&(o=util$2.isArray(o)?o:[o]);var r={READ:0,WRITE:0,FULL_CONTROL:0};return o&&o.length&&util$2.each(o,function(s){s.Grantee.ID==="qcs::cam::anyone:anyone"||s.Grantee.URI==="http://cam.qcloud.com/groups/global/AllUsers"?r[s.Permission]=1:s.Grantee.ID!==e.Owner.ID&&n[t[s.Permission]].push('id="'+s.Grantee.ID+'"')}),r.FULL_CONTROL||r.WRITE&&r.READ?n.ACL="public-read-write":r.READ?n.ACL="public-read":n.ACL="private",util$2.each(t,function(s){n[s]=uniqGrant(n[s].join(","))}),n}function uniqGrant(e){var n=e.split(","),t={},i,o;for(i=0;i<n.length;)o=n[i].trim(),t[o]?n.splice(i,1):(t[o]=!0,n[i]=o,i++);return n.join(",")}function getUrl(e){var n=e.region||"",t=e.bucket||"",i=t.substr(0,t.lastIndexOf("-")),o=t.substr(t.lastIndexOf("-")+1),r=e.domain,s=e.object;typeof r=="function"&&(r=r({Bucket:t,Region:n}));var u=e.protocol||(util$2.isBrowser&&location.protocol==="http:"?"http:":"https:");r||(["cn-south","cn-south-2","cn-north","cn-east","cn-southwest","sg"].indexOf(n)>-1?r="{Region}.myqcloud.com":r="cos.{Region}.myqcloud.com",e.ForcePathStyle||(r="{Bucket}."+r)),r=r.replace(/\{\{AppId\}\}/ig,o).replace(/\{\{Bucket\}\}/ig,i).replace(/\{\{Region\}\}/ig,n).replace(/\{\{.*?\}\}/ig,""),r=r.replace(/\{AppId\}/ig,o).replace(/\{BucketName\}/ig,i).replace(/\{Bucket\}/ig,t).replace(/\{Region\}/ig,n).replace(/\{.*?\}/ig,""),/^[a-zA-Z]+:\/\//.test(r)||(r=u+"//"+r),r.slice(-1)==="/"&&(r=r.slice(0,-1));var c=r;return e.ForcePathStyle&&(c+="/"+t),c+="/",s&&(c+=util$2.camSafeUrlEncode(s).replace(/%2F/g,"/")),e.isLocation&&(c=c.replace(/^https?:\/\//,"")),c}var getSignHost=function(e){if(!e.Bucket||!e.Region)return"";var n=e.Url||getUrl({ForcePathStyle:this.options.ForcePathStyle,protocol:this.options.Protocol,domain:this.options.Domain,bucket:e.Bucket,region:this.options.UseAccelerate?"accelerate":e.Region}),t=n.replace(/^https?:\/\/([^/]+)(\/.*)?$/,"$1"),i=new RegExp("^([a-z\\d-]+-\\d+\\.)?(cos|cosv6|ci|pic)\\.([a-z\\d-]+)\\.myqcloud\\.com$");return i.test(t)?t:""};function getAuthorizationAsync(e,n){var t=util$2.clone(e.Headers),i="";util$2.each(t,function(v,y){(v===""||["content-type","cache-control","expires"].indexOf(y.toLowerCase())>-1)&&delete t[y],y.toLowerCase()==="host"&&(i=v)}),!i&&e.SignHost&&(t.Host=e.SignHost);var o=!1,r=function(v,y){o||(o=!0,y&&y.XCosSecurityToken&&!y.SecurityToken&&(y=util$2.clone(y),y.SecurityToken=y.XCosSecurityToken,delete y.XCosSecurityToken),n&&n(v,y))},s=this,u=e.Bucket||"",c=e.Region||"",l=e.Key||"";s.options.ForcePathStyle&&u&&(l=u+"/"+l);var d="/"+l,a={},f=e.Scope;if(!f){var p=e.Action||"",S=e.ResourceKey||e.Key||"";f=e.Scope||[{action:p,bucket:u,region:c,prefix:S}]}var g=util$2.md5(JSON.stringify(f));s._StsCache=s._StsCache||[],function(){var v,y;for(v=s._StsCache.length-1;v>=0;v--){y=s._StsCache[v];var R=Math.round(util$2.getSkewTime(s.options.SystemClockOffset)/1e3)+30;if(y.StartTime&&R<y.StartTime||R>=y.ExpiredTime){s._StsCache.splice(v,1);continue}if(!y.ScopeLimit||y.ScopeLimit&&y.ScopeKey===g){a=y;break}}}();var h=function(){var v=a.StartTime&&a.ExpiredTime?a.StartTime+";"+a.ExpiredTime:"",y=util$2.getAuth({SecretId:a.TmpSecretId,SecretKey:a.TmpSecretKey,Method:e.Method,Pathname:d,Query:e.Query,Headers:t,Expires:e.Expires,UseRawKey:s.options.UseRawKey,SystemClockOffset:s.options.SystemClockOffset,KeyTime:v}),R={Authorization:y,SecurityToken:a.SecurityToken||a.XCosSecurityToken||"",Token:a.Token||"",ClientIP:a.ClientIP||"",ClientUA:a.ClientUA||""};r(null,R)},C=function(v){if(v.Authorization){var y=!1,R=v.Authorization;if(R)if(R.indexOf(" ")>-1)y=!1;else if(R.indexOf("q-sign-algorithm=")>-1&&R.indexOf("q-ak=")>-1&&R.indexOf("q-sign-time=")>-1&&R.indexOf("q-key-time=")>-1&&R.indexOf("q-url-param-list=")>-1)y=!0;else try{R=atob(R),R.indexOf("a=")>-1&&R.indexOf("k=")>-1&&R.indexOf("t=")>-1&&R.indexOf("r=")>-1&&R.indexOf("b=")>-1&&(y=!0)}catch{}if(!y)return util$2.error(new Error("getAuthorization callback params format error"))}else{if(!v.TmpSecretId)return util$2.error(new Error('getAuthorization callback params missing "TmpSecretId"'));if(!v.TmpSecretKey)return util$2.error(new Error('getAuthorization callback params missing "TmpSecretKey"'));if(!v.SecurityToken&&!v.XCosSecurityToken)return util$2.error(new Error('getAuthorization callback params missing "SecurityToken"'));if(!v.ExpiredTime)return util$2.error(new Error('getAuthorization callback params missing "ExpiredTime"'));if(v.ExpiredTime&&v.ExpiredTime.toString().length!==10)return util$2.error(new Error('getAuthorization callback params "ExpiredTime" should be 10 digits'));if(v.StartTime&&v.StartTime.toString().length!==10)return util$2.error(new Error('getAuthorization callback params "StartTime" should be 10 StartTime'))}return!1};if(a.ExpiredTime&&a.ExpiredTime-util$2.getSkewTime(s.options.SystemClockOffset)/1e3>60)h();else if(s.options.getAuthorization)s.options.getAuthorization.call(s,{Bucket:u,Region:c,Method:e.Method,Key:l,Pathname:d,Query:e.Query,Headers:t,Scope:f,SystemClockOffset:s.options.SystemClockOffset},function(v){typeof v=="string"&&(v={Authorization:v});var y=C(v);if(y)return r(y);v.Authorization?r(null,v):(a=v||{},a.Scope=f,a.ScopeKey=g,s._StsCache.push(a),h())});else if(s.options.getSTS)s.options.getSTS.call(s,{Bucket:u,Region:c},function(v){a=v||{},a.Scope=f,a.ScopeKey=g,a.TmpSecretId||(a.TmpSecretId=a.SecretId),a.TmpSecretKey||(a.TmpSecretKey=a.SecretKey);var y=C(a);if(y)return r(y);s._StsCache.push(a),h()});else return function(){var v=util$2.getAuth({SecretId:e.SecretId||s.options.SecretId,SecretKey:e.SecretKey||s.options.SecretKey,Method:e.Method,Pathname:d,Query:e.Query,Headers:t,Expires:e.Expires,UseRawKey:s.options.UseRawKey,SystemClockOffset:s.options.SystemClockOffset}),y={Authorization:v,SecurityToken:s.options.SecurityToken||s.options.XCosSecurityToken};return r(null,y),y}();return""}function allowRetry(e){var n=!1,t=!1,i=e.headers&&(e.headers.date||e.headers.Date)||e.error&&e.error.ServerTime;try{var o=e.error.Code,r=e.error.Message;(o==="RequestTimeTooSkewed"||o==="AccessDenied"&&r==="Request has expired")&&(t=!0)}catch{}if(e)if(t&&i){var s=Date.parse(i);this.options.CorrectClockSkew&&Math.abs(util$2.getSkewTime(this.options.SystemClockOffset)-s)>=3e4&&(console.error("error: Local time is too skewed."),this.options.SystemClockOffset=s-Date.now(),n=!0)}else Math.floor(e.statusCode/100)===5&&(n=!0);return n}function submitRequest(e,n){var t=this;!e.headers&&(e.headers={}),!e.qs&&(e.qs={}),e.VersionId&&(e.qs.versionId=e.VersionId),e.qs=util$2.clearKey(e.qs),e.headers&&(e.headers=util$2.clearKey(e.headers)),e.qs&&(e.qs=util$2.clearKey(e.qs));var i=util$2.clone(e.qs);e.action&&(i[e.action]="");var o=e.url||e.Url,r=e.SignHost||getSignHost.call(this,{Bucket:e.Bucket,Region:e.Region,Url:o}),s=function(u){var c=t.options.SystemClockOffset;getAuthorizationAsync.call(t,{Bucket:e.Bucket||"",Region:e.Region||"",Method:e.method,Key:e.Key,Query:i,Headers:e.headers,SignHost:r,Action:e.Action,ResourceKey:e.ResourceKey,Scope:e.Scope},function(l,d){if(l){n(l);return}e.AuthData=d,_submitRequest.call(t,e,function(a,f){a&&u<2&&(c!==t.options.SystemClockOffset||allowRetry.call(t,a))?(e.headers&&(delete e.headers.Authorization,delete e.headers.token,delete e.headers.clientIP,delete e.headers.clientUA,e.headers["x-cos-security-token"]&&delete e.headers["x-cos-security-token"],e.headers["x-ci-security-token"]&&delete e.headers["x-ci-security-token"]),s(u+1)):n(a,f)})})};s(1)}function _submitRequest(e,n){var t=this,i=e.TaskId;if(!(i&&!t._isRunningTask(i))){var o=e.Bucket,r=e.Region,s=e.Key,u=e.method||"GET",c=e.Url||e.url,l=e.body,d=e.rawBody;t.options.UseAccelerate&&(r="accelerate"),c=c||getUrl({ForcePathStyle:t.options.ForcePathStyle,protocol:t.options.Protocol,domain:t.options.Domain,bucket:o,region:r,object:s}),e.action&&(c=c+"?"+e.action),e.qsStr&&(c.indexOf("?")>-1?c=c+"&"+e.qsStr:c=c+"?"+e.qsStr);var a={method:u,url:c,headers:e.headers,qs:e.qs,body:l},f="x-cos-security-token";if(util$2.isCIHost(c)&&(f="x-ci-security-token"),a.headers.Authorization=e.AuthData.Authorization,e.AuthData.Token&&(a.headers.token=e.AuthData.Token),e.AuthData.ClientIP&&(a.headers.clientIP=e.AuthData.ClientIP),e.AuthData.ClientUA&&(a.headers.clientUA=e.AuthData.ClientUA),e.AuthData.SecurityToken&&(a.headers[f]=e.AuthData.SecurityToken),a.headers&&(a.headers=util$2.clearKey(a.headers)),a=util$2.clearKey(a),e.onProgress&&typeof e.onProgress=="function"){var p=l&&(l.size||l.length)||0;a.onProgress=function(h){if(!(i&&!t._isRunningTask(i))){var C=h?h.loaded:0;e.onProgress({loaded:C,total:p})}}}e.onDownloadProgress&&(a.onDownloadProgress=e.onDownloadProgress),e.DataType&&(a.dataType=e.DataType),this.options.Timeout&&(a.timeout=this.options.Timeout),t.options.ForcePathStyle&&(a.pathStyle=t.options.ForcePathStyle),t.emit("before-send",a);var S=(t.options.Request||REQUEST)(a,function(h){if(h.error!=="abort"){var C={options:a,error:y,statusCode:v&&v.statusCode||0,headers:v&&v.headers||{},body:R};t.emit("after-receive",C),y=C.error,R=C.body,v={statusCode:C.statusCode,headers:C.headers},t.emit("after-receive",h);var v={statusCode:h.statusCode,statusMessage:h.statusMessage,headers:h.headers},y=h.error,R=h.body,T,E=function(A,D){if(i&&t.off("inner-kill-task",g),!T){T=!0;var N={};v&&v.statusCode&&(N.statusCode=v.statusCode),v&&v.headers&&(N.headers=v.headers),A?(A=util$2.extend(A||{},N),n(A,null)):(D=util$2.extend(D||{},N),n(null,D)),S=null}};if(y)return E(util$2.error(y));var m=v.statusCode,x=Math.floor(m/100)===2;if(d&&x)return E(null,{body:R});var _;try{_=R&&R.indexOf("<")>-1&&R.indexOf(">")>-1&&util$2.xml2json(R)||{}}catch{_={}}var B=_&&_.Error;x?E(null,_):B?E(util$2.error(new Error(B.Message),{code:B.Code,error:B})):m?E(util$2.error(new Error(v.statusMessage),{code:""+m})):m&&E(util$2.error(new Error("statusCode error")))}}),g=function(h){h.TaskId===i&&(S&&S.abort&&S.abort(),t.off("inner-kill-task",g))};i&&t.on("inner-kill-task",g)}}var API_MAP$1={getService,putBucket,headBucket,getBucket,deleteBucket,putBucketAcl,getBucketAcl,putBucketCors,getBucketCors,deleteBucketCors,getBucketLocation,getBucketPolicy,putBucketPolicy,deleteBucketPolicy,putBucketTagging,getBucketTagging,deleteBucketTagging,putBucketLifecycle,getBucketLifecycle,deleteBucketLifecycle,putBucketVersioning,getBucketVersioning,putBucketReplication,getBucketReplication,deleteBucketReplication,putBucketWebsite,getBucketWebsite,deleteBucketWebsite,putBucketReferer,getBucketReferer,putBucketDomain,getBucketDomain,deleteBucketDomain,putBucketOrigin,getBucketOrigin,deleteBucketOrigin,putBucketLogging,getBucketLogging,putBucketInventory,getBucketInventory,listBucketInventory,deleteBucketInventory,putBucketAccelerate,getBucketAccelerate,putBucketEncryption,getBucketEncryption,deleteBucketEncryption,getObject,headObject,listObjectVersions,putObject,deleteObject,getObjectAcl,putObjectAcl,optionsObject,putObjectCopy,deleteMultipleObject,restoreObject,putObjectTagging,getObjectTagging,deleteObjectTagging,selectObjectContent,appendObject,uploadPartCopy,multipartInit,multipartUpload,multipartComplete,multipartList,multipartListPart,multipartAbort,request,getObjectUrl,getAuth};function warnOldApi(e,n,t){util$2.each(["Cors","Acl"],function(i){if(e.slice(-i.length)===i){var o=e.slice(0,-i.length)+i.toUpperCase(),r=util$2.apiWrapper(e,n),s=!1;t[o]=function(){!s&&console.warn("warning: cos."+o+" has been deprecated. Please Use cos."+e+" instead."),s=!0,r.apply(this,arguments)}}})}base$1.init=function(e,n){n.transferToTaskMethod(API_MAP$1,"putObject"),util$2.each(API_MAP$1,function(t,i){e.prototype[i]=util$2.apiWrapper(i,t),warnOldApi(i,t,e.prototype)})};var advance$1={},eachLimit=function(e,n,t,i){if(i=i||function(){},!e.length||n<=0)return i();var o=0,r=0,s=0;(function u(){if(o>=e.length)return i();for(;s<n&&r<e.length;)r+=1,s+=1,t(e[r-1],function(c){c?(i(c),i=function(){}):(o+=1,s-=1,o>=e.length?i():u())})})()},retry=function(e,n,t){var i=function(o){n(function(r,s){r&&o<e?i(o+1):t(r,s)})};e<1?t():i(1)},async={eachLimit,retry},async_1=async,session=session$2,Async=async_1,EventProxy=event$1.EventProxy,util$1=util_1;function sliceUploadFile(e,n){var t=this,i=new EventProxy,o=e.TaskId,r=e.Bucket,s=e.Region,u=e.Key,c=e.Body,l=e.ChunkSize||e.SliceSize||t.options.ChunkSize,d=e.AsyncLimit,a=e.StorageClass,f=e.ServerSideEncryption,p,S,g=e.onHashProgress;i.on("error",function(h){if(!!t._isRunningTask(o))return h.UploadId=e.UploadData.UploadId||"",n(h)}),i.on("upload_complete",function(h){var C=util$1.extend({UploadId:e.UploadData.UploadId||""},h);n(null,C)}),i.on("upload_slice_complete",function(h){var C={};util$1.each(e.Headers,function(v,y){var R=y.toLowerCase();(R.indexOf("x-cos-meta-")===0||R==="pic-operations")&&(C[y]=v)}),uploadSliceComplete.call(t,{Bucket:r,Region:s,Key:u,UploadId:h.UploadId,SliceList:h.SliceList,Headers:C},function(v,y){if(!!t._isRunningTask(o)){if(session.removeUsing(h.UploadId),v)return S(null,!0),i.emit("error",v);session.removeUploadId.call(t,h.UploadId),S({loaded:p,total:p},!0),i.emit("upload_complete",y)}})}),i.on("get_upload_data_finish",function(h){var C=session.getFileId(c,e.ChunkSize,r,u);C&&session.saveUploadId.call(t,C,h.UploadId,t.options.UploadIdCacheLimit),session.setUsing(h.UploadId),S(null,!0),uploadSliceList.call(t,{TaskId:o,Bucket:r,Region:s,Key:u,Body:c,FileSize:p,SliceSize:l,AsyncLimit:d,ServerSideEncryption:f,UploadData:h,Headers:e.Headers,onProgress:S},function(v,y){if(!!t._isRunningTask(o)){if(v)return S(null,!0),i.emit("error",v);i.emit("upload_slice_complete",y)}})}),i.on("get_file_size_finish",function(){if(S=util$1.throttleOnProgress.call(t,p,e.onProgress),e.UploadData.UploadId)i.emit("get_upload_data_finish",e.UploadData);else{var h=util$1.extend({TaskId:o,Bucket:r,Region:s,Key:u,Headers:e.Headers,StorageClass:a,Body:c,FileSize:p,SliceSize:l,onHashProgress:g},e);getUploadIdAndPartList.call(t,h,function(C,v){if(!!t._isRunningTask(o)){if(C)return i.emit("error",C);e.UploadData.UploadId=v.UploadId,e.UploadData.PartList=v.PartList,i.emit("get_upload_data_finish",e.UploadData)}})}}),p=e.ContentLength,delete e.ContentLength,!e.Headers&&(e.Headers={}),util$1.each(e.Headers,function(h,C){C.toLowerCase()==="content-length"&&delete e.Headers[C]}),function(){for(var h=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],C=1024*1024,v=0;v<h.length&&(C=h[v]*1024*1024,!(p/C<=t.options.MaxPartNumber));v++);e.ChunkSize=e.SliceSize=l=Math.max(l,C)}(),p===0?(e.Body="",e.ContentLength=0,e.SkipTask=!0,t.putObject(e,n)):i.emit("get_file_size_finish")}function getUploadIdAndPartList(e,n){var t=e.TaskId,i=e.Bucket,o=e.Region,r=e.Key,s=e.StorageClass,u=this,c={},l=e.FileSize,d=e.SliceSize,a=Math.ceil(l/d),f=0,p=util$1.throttleOnProgress.call(u,l,e.onHashProgress),S=function(C,v){var y=d*(C-1),R=Math.min(y+d,l),T=R-y;c[C]?v(null,{PartNumber:C,ETag:c[C],Size:T}):util$1.fileSlice(e.Body,y,R,!1,function(E){util$1.getFileMd5(E,function(m,x){if(m)return v(util$1.error(m));var _='"'+x+'"';c[C]=_,f+=T,p({loaded:f,total:l}),v(null,{PartNumber:C,ETag:_,Size:T})})})},g=function(C,v){var y=C.length;if(y===0)return v(null,!0);if(y>a)return v(null,!1);if(y>1){var R=Math.max(C[0].Size,C[1].Size);if(R!==d)return v(null,!1)}var T=function(E){if(E<y){var m=C[E];S(m.PartNumber,function(x,_){_&&_.ETag===m.ETag&&_.Size===m.Size?T(E+1):v(null,!1)})}else v(null,!0)};T(0)},h=new EventProxy;h.on("error",function(C){if(!!u._isRunningTask(t))return n(C)}),h.on("upload_id_available",function(C){var v={},y=[];util$1.each(C.PartList,function(E){v[E.PartNumber]=E});for(var R=1;R<=a;R++){var T=v[R];T?(T.PartNumber=R,T.Uploaded=!0):T={PartNumber:R,ETag:null,Uploaded:!1},y.push(T)}C.PartList=y,n(null,C)}),h.on("no_available_upload_id",function(){if(!!u._isRunningTask(t)){var C=util$1.extend({Bucket:i,Region:o,Key:r,Query:util$1.clone(e.Query),StorageClass:s,Body:e.Body},e),v=util$1.clone(e.Headers);delete v["x-cos-mime-limit"],C.Headers=v,u.multipartInit(C,function(y,R){if(!!u._isRunningTask(t)){if(y)return h.emit("error",y);var T=R.UploadId;if(!T)return n(util$1.error(new Error("no such upload id")));h.emit("upload_id_available",{UploadId:T,PartList:[]})}})}}),h.on("has_and_check_upload_id",function(C){C=C.reverse(),Async.eachLimit(C,1,function(v,y){if(!!u._isRunningTask(t)){if(session.using[v]){y();return}wholeMultipartListPart.call(u,{Bucket:i,Region:o,Key:r,UploadId:v},function(R,T){if(!!u._isRunningTask(t)){if(R)return session.removeUsing(v),h.emit("error",R);var E=T.PartList;E.forEach(function(m){m.PartNumber*=1,m.Size*=1,m.ETag=m.ETag||""}),g(E,function(m,x){if(!!u._isRunningTask(t)){if(m)return h.emit("error",m);x?y({UploadId:v,PartList:E}):y()}})}})}},function(v){!u._isRunningTask(t)||(p(null,!0),v&&v.UploadId?h.emit("upload_id_available",v):h.emit("no_available_upload_id"))})}),h.on("seek_local_avail_upload_id",function(C){var v=session.getFileId(e.Body,e.ChunkSize,i,r),y=session.getUploadIdList.call(u,v);if(!v||!y){h.emit("has_and_check_upload_id",C);return}var R=function(T){if(T>=y.length){h.emit("has_and_check_upload_id",C);return}var E=y[T];if(!util$1.isInArray(C,E)){session.removeUploadId.call(u,E),R(T+1);return}if(session.using[E]){R(T+1);return}wholeMultipartListPart.call(u,{Bucket:i,Region:o,Key:r,UploadId:E},function(m,x){!u._isRunningTask(t)||(m?(session.removeUploadId.call(u,E),R(T+1)):h.emit("upload_id_available",{UploadId:E,PartList:x.PartList}))})};R(0)}),h.on("get_remote_upload_id_list",function(){wholeMultipartList.call(u,{Bucket:i,Region:o,Key:r},function(C,v){if(!!u._isRunningTask(t)){if(C)return h.emit("error",C);var y=util$1.filter(v.UploadList,function(E){return E.Key===r&&(!s||E.StorageClass.toUpperCase()===s.toUpperCase())}).reverse().map(function(E){return E.UploadId||E.UploadID});if(y.length)h.emit("seek_local_avail_upload_id",y);else{var R=session.getFileId(e.Body,e.ChunkSize,i,r),T;R&&(T=session.getUploadIdList.call(u,R))&&util$1.each(T,function(E){session.removeUploadId.call(u,E)}),h.emit("no_available_upload_id")}}})}),h.emit("get_remote_upload_id_list")}function wholeMultipartList(e,n){var t=this,i=[],o={Bucket:e.Bucket,Region:e.Region,Prefix:e.Key},r=function(){t.multipartList(o,function(s,u){if(s)return n(s);i.push.apply(i,u.Upload||[]),u.IsTruncated==="true"?(o.KeyMarker=u.NextKeyMarker,o.UploadIdMarker=u.NextUploadIdMarker,r()):n(null,{UploadList:i})})};r()}function wholeMultipartListPart(e,n){var t=this,i=[],o={Bucket:e.Bucket,Region:e.Region,Key:e.Key,UploadId:e.UploadId},r=function(){t.multipartListPart(o,function(s,u){if(s)return n(s);i.push.apply(i,u.Part||[]),u.IsTruncated==="true"?(o.PartNumberMarker=u.NextPartNumberMarker,r()):n(null,{PartList:i})})};r()}function uploadSliceList(e,n){var t=this,i=e.TaskId,o=e.Bucket,r=e.Region,s=e.Key,u=e.UploadData,c=e.FileSize,l=e.SliceSize,d=Math.min(e.AsyncLimit||t.options.ChunkParallelLimit||1,256),a=e.Body,f=Math.ceil(c/l),p=0,S=e.ServerSideEncryption,g=e.Headers,h=util$1.filter(u.PartList,function(v){return v.Uploaded&&(p+=v.PartNumber>=f&&c%l||l),!v.Uploaded}),C=e.onProgress;Async.eachLimit(h,d,function(v,y){if(!!t._isRunningTask(i)){var R=v.PartNumber,T=Math.min(c,v.PartNumber*l)-(v.PartNumber-1)*l,E=0;uploadSliceItem.call(t,{TaskId:i,Bucket:o,Region:r,Key:s,SliceSize:l,FileSize:c,PartNumber:R,ServerSideEncryption:S,Body:a,UploadData:u,Headers:g,onProgress:function(m){p+=m.loaded-E,E=m.loaded,C({loaded:p,total:c})}},function(m,x){!t._isRunningTask(i)||(!m&&!x.ETag&&(m='get ETag error, please add "ETag" to CORS ExposeHeader setting.( \u83B7\u53D6ETag\u5931\u8D25\uFF0C\u8BF7\u5728CORS ExposeHeader\u8BBE\u7F6E\u4E2D\u6DFB\u52A0ETag\uFF0C\u8BF7\u53C2\u8003\u6587\u6863\uFF1Ahttps://cloud.tencent.com/document/product/436/13318 )'),m?p-=E:(p+=T-E,v.ETag=x.ETag),C({loaded:p,total:c}),y(m||null,x))})}},function(v){if(!!t._isRunningTask(i)){if(v)return n(v);n(null,{UploadId:u.UploadId,SliceList:u.PartList})}})}function uploadSliceItem(e,n){var t=this,i=e.TaskId,o=e.Bucket,r=e.Region,s=e.Key,u=e.FileSize,c=e.Body,l=e.PartNumber*1,d=e.SliceSize,a=e.ServerSideEncryption,f=e.UploadData,p=e.Headers||{},S=t.options.ChunkRetryTimes+1,g=d*(l-1),h=d,C=g+d;C>u&&(C=u,h=C-g);var v=["x-cos-traffic-limit","x-cos-mime-limit"],y={};util$1.each(p,function(T,E){v.indexOf(E)>-1&&(y[E]=T)});var R=f.PartList[l-1];Async.retry(S,function(T){!t._isRunningTask(i)||util$1.fileSlice(c,g,C,!0,function(E){t.multipartUpload({TaskId:i,Bucket:o,Region:r,Key:s,ContentLength:h,PartNumber:l,UploadId:f.UploadId,ServerSideEncryption:a,Body:E,Headers:y,onProgress:e.onProgress},function(m,x){if(!!t._isRunningTask(i))return m?T(m):(R.Uploaded=!0,T(null,x))})})},function(T,E){if(!!t._isRunningTask(i))return n(T,E)})}function uploadSliceComplete(e,n){var t=e.Bucket,i=e.Region,o=e.Key,r=e.UploadId,s=e.SliceList,u=this,c=this.options.ChunkRetryTimes+1,l=e.Headers,d=s.map(function(a){return{PartNumber:a.PartNumber,ETag:a.ETag}});Async.retry(c,function(a){u.multipartComplete({Bucket:t,Region:i,Key:o,UploadId:r,Parts:d,Headers:l},a)},function(a,f){n(a,f)})}function abortUploadTask(e,n){var t=e.Bucket,i=e.Region,o=e.Key,r=e.UploadId,s=e.Level||"task",u=e.AsyncLimit,c=this,l=new EventProxy;if(l.on("error",function(d){return n(d)}),l.on("get_abort_array",function(d){abortUploadTaskArray.call(c,{Bucket:t,Region:i,Key:o,Headers:e.Headers,AsyncLimit:u,AbortArray:d},n)}),s==="bucket")wholeMultipartList.call(c,{Bucket:t,Region:i},function(d,a){if(d)return n(d);l.emit("get_abort_array",a.UploadList||[])});else if(s==="file"){if(!o)return n(util$1.error(new Error("abort_upload_task_no_key")));wholeMultipartList.call(c,{Bucket:t,Region:i,Key:o},function(d,a){if(d)return n(d);l.emit("get_abort_array",a.UploadList||[])})}else if(s==="task"){if(!r)return n(util$1.error(new Error("abort_upload_task_no_id")));if(!o)return n(util$1.error(new Error("abort_upload_task_no_key")));l.emit("get_abort_array",[{Key:o,UploadId:r}])}else return n(util$1.error(new Error("abort_unknown_level")))}function abortUploadTaskArray(e,n){var t=e.Bucket,i=e.Region,o=e.Key,r=e.AbortArray,s=e.AsyncLimit||1,u=this,c=0,l=new Array(r.length);Async.eachLimit(r,s,function(d,a){var f=c;if(o&&o!==d.Key){l[f]={error:{KeyNotMatch:!0}},a(null);return}var p=d.UploadId||d.UploadID;u.multipartAbort({Bucket:t,Region:i,Key:d.Key,Headers:e.Headers,UploadId:p},function(S){var g={Bucket:t,Region:i,Key:d.Key,UploadId:p};l[f]={error:S,task:g},a(null)}),c++},function(d){if(d)return n(d);for(var a=[],f=[],p=0,S=l.length;p<S;p++){var g=l[p];g.task&&(g.error?f.push(g.task):a.push(g.task))}return n(null,{successList:a,errorList:f})})}function uploadFile(e,n){var t=this,i=e.SliceSize===void 0?t.options.SliceSize:e.SliceSize,o=[],r=e.Body,s=r.size||r.length||0,u={TaskId:""};util$1.each(e,function(p,S){typeof p!="object"&&typeof p!="function"&&(u[S]=p)});var c=e.onTaskReady,l=function(p){u.TaskId=p,c&&c(p)};e.onTaskReady=l;var d=e.onFileFinish,a=function(p,S){d&&d(p,S,u),n&&n(p,S)},f=s>i?"sliceUploadFile":"putObject";o.push({api:f,params:e,callback:a}),t._addTasks(o)}function uploadFiles(e,n){var t=this,i=e.SliceSize===void 0?t.options.SliceSize:e.SliceSize,o=0,r=0,s=util$1.throttleOnProgress.call(t,r,e.onProgress),u=e.files.length,c=e.onFileFinish,l=Array(u),d=function(f,p,S){s(null,!0),c&&c(f,p,S),l[S.Index]={options:S,error:f,data:p},--u<=0&&n&&n(null,{files:l})},a=[];util$1.each(e.files,function(f,p){(function(){var S=f.Body,g=S.size||S.length||0,h={Index:p,TaskId:""};o+=g,util$1.each(f,function(_,B){typeof _!="object"&&typeof _!="function"&&(h[B]=_)});var C=f.onTaskReady,v=function(_){h.TaskId=_,C&&C(_)};f.onTaskReady=v;var y=0,R=f.onProgress,T=function(_){r=r-y+_.loaded,y=_.loaded,R&&R(_),s({loaded:r,total:o})};f.onProgress=T;var E=f.onFileFinish,m=function(_,B){E&&E(_,B),d&&d(_,B,h)},x=g>i?"sliceUploadFile":"putObject";a.push({api:x,params:f,callback:m})})()}),t._addTasks(a)}function sliceCopyFile(e,n){var t=new EventProxy,i=this,o=e.Bucket,r=e.Region,s=e.Key,u=e.CopySource,c=util$1.getSourceParams.call(this,u);if(!c){n(util$1.error(new Error("CopySource format error")));return}var l=c.Bucket,d=c.Region,a=decodeURIComponent(c.Key),f=e.CopySliceSize===void 0?i.options.CopySliceSize:e.CopySliceSize;f=Math.max(0,f);var p=e.CopyChunkSize||this.options.CopyChunkSize,S=this.options.CopyChunkParallelLimit,g=0,h,C;t.on("copy_slice_complete",function(v){util$1.each(e.Headers,function(R,T){T.toLowerCase().indexOf("x-cos-meta-")});var y=util$1.map(v.PartList,function(R){return{PartNumber:R.PartNumber,ETag:R.ETag}});i.multipartComplete({Bucket:o,Region:r,Key:s,UploadId:v.UploadId,Parts:y},function(R,T){if(R)return C(null,!0),n(R);C({loaded:h,total:h},!0),n(null,T)})}),t.on("get_copy_data_finish",function(v){Async.eachLimit(v.PartList,S,function(y,R){var T=y.PartNumber,E=y.CopySourceRange,m=y.end-y.start;copySliceItem.call(i,{Bucket:o,Region:r,Key:s,CopySource:u,UploadId:v.UploadId,PartNumber:T,CopySourceRange:E},function(x,_){if(x)return R(x);g+=m,C({loaded:g,total:h}),y.ETag=_.ETag,R(x||null,_)})},function(y){if(y)return C(null,!0),n(y);t.emit("copy_slice_complete",v)})}),t.on("get_file_size_finish",function(v){(function(){for(var T=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],E=1024*1024,m=0;m<T.length&&(E=T[m]*1024*1024,!(h/E<=i.options.MaxPartNumber));m++);e.ChunkSize=p=Math.max(p,E);for(var x=Math.ceil(h/p),_=[],B=1;B<=x;B++){var A=(B-1)*p,D=B*p<h?B*p-1:h-1,N={PartNumber:B,start:A,end:D,CopySourceRange:"bytes="+A+"-"+D};_.push(N)}e.PartList=_})();var y;if(e.Headers["x-cos-metadata-directive"]==="Replaced"?y=e.Headers:y=v,y["x-cos-storage-class"]=e.Headers["x-cos-storage-class"]||v["x-cos-storage-class"],y=util$1.clearKey(y),v["x-cos-storage-class"]==="ARCHIVE"||v["x-cos-storage-class"]==="DEEP_ARCHIVE"){var R=v["x-cos-restore"];if(!R||R==='ongoing-request="true"'){n(util$1.error(new Error("Unrestored archive object is not allowed to be copied")));return}}delete y["x-cos-copy-source"],delete y["x-cos-metadata-directive"],delete y["x-cos-copy-source-If-Modified-Since"],delete y["x-cos-copy-source-If-Unmodified-Since"],delete y["x-cos-copy-source-If-Match"],delete y["x-cos-copy-source-If-None-Match"],i.multipartInit({Bucket:o,Region:r,Key:s,Headers:y},function(T,E){if(T)return n(T);e.UploadId=E.UploadId,t.emit("get_copy_data_finish",e)})}),i.headObject({Bucket:l,Region:d,Key:a},function(v,y){if(v){v.statusCode&&v.statusCode===404?n(util$1.error(v,{ErrorStatus:a+" Not Exist"})):n(v);return}if(h=e.FileSize=y.headers["content-length"],h===void 0||!h){n(util$1.error(new Error('get Content-Length error, please add "Content-Length" to CORS ExposeHeader setting.\uFF08 \u83B7\u53D6Content-Length\u5931\u8D25\uFF0C\u8BF7\u5728CORS ExposeHeader\u8BBE\u7F6E\u4E2D\u6DFB\u52A0Content-Length\uFF0C\u8BF7\u53C2\u8003\u6587\u6863\uFF1Ahttps://cloud.tencent.com/document/product/436/13318 \uFF09')));return}if(C=util$1.throttleOnProgress.call(i,h,e.onProgress),h<=f)e.Headers["x-cos-metadata-directive"]||(e.Headers["x-cos-metadata-directive"]="Copy"),i.putObjectCopy(e,function(E,m){if(E)return C(null,!0),n(E);C({loaded:h,total:h},!0),n(E,m)});else{var R=y.headers,T={"Cache-Control":R["cache-control"],"Content-Disposition":R["content-disposition"],"Content-Encoding":R["content-encoding"],"Content-Type":R["content-type"],Expires:R.expires,"x-cos-storage-class":R["x-cos-storage-class"]};util$1.each(R,function(E,m){var x="x-cos-meta-";m.indexOf(x)===0&&m.length>x.length&&(T[m]=E)}),t.emit("get_file_size_finish",T)}})}function copySliceItem(e,n){var t=e.TaskId,i=e.Bucket,o=e.Region,r=e.Key,s=e.CopySource,u=e.UploadId,c=e.PartNumber*1,l=e.CopySourceRange,d=this.options.ChunkRetryTimes+1,a=this;Async.retry(d,function(f){a.uploadPartCopy({TaskId:t,Bucket:i,Region:o,Key:r,CopySource:s,UploadId:u,PartNumber:c,CopySourceRange:l},function(p,S){f(p||null,S)})},function(f,p){return n(f,p)})}var API_MAP={sliceUploadFile,abortUploadTask,uploadFile,uploadFiles,sliceCopyFile};advance$1.init=function(e,n){n.transferToTaskMethod(API_MAP,"sliceUploadFile"),util$1.each(API_MAP,function(t,i){e.prototype[i]=util$1.apiWrapper(i,t)})};var util=util_1,event=event$1,task=task$1,base=base$1,advance=advance$1,defaultOptions={AppId:"",SecretId:"",SecretKey:"",SecurityToken:"",ChunkRetryTimes:2,FileParallelLimit:3,ChunkParallelLimit:3,ChunkSize:1024*1024,SliceSize:1024*1024,CopyChunkParallelLimit:20,CopyChunkSize:1024*1024*10,CopySliceSize:1024*1024*10,MaxPartNumber:1e4,ProgressInterval:1e3,Domain:"",ServiceDomain:"",Protocol:"",CompatibilityMode:!1,ForcePathStyle:!1,UseRawKey:!1,Timeout:0,CorrectClockSkew:!0,SystemClockOffset:0,UploadCheckContentMd5:!1,UploadQueueSize:1e4,UploadAddMetaMd5:!1,UploadIdCacheLimit:50,UseAccelerate:!1},COS$1=function(e){this.options=util.extend(util.clone(defaultOptions),e||{}),this.options.FileParallelLimit=Math.max(1,this.options.FileParallelLimit),this.options.ChunkParallelLimit=Math.max(1,this.options.ChunkParallelLimit),this.options.ChunkRetryTimes=Math.max(0,this.options.ChunkRetryTimes),this.options.ChunkSize=Math.max(1024*1024,this.options.ChunkSize),this.options.CopyChunkParallelLimit=Math.max(1,this.options.CopyChunkParallelLimit),this.options.CopyChunkSize=Math.max(1024*1024,this.options.CopyChunkSize),this.options.CopySliceSize=Math.max(0,this.options.CopySliceSize),this.options.MaxPartNumber=Math.max(1024,Math.min(1e4,this.options.MaxPartNumber)),this.options.Timeout=Math.max(0,this.options.Timeout),this.options.AppId&&console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g: "test-1250000000").'),this.options.SecretId&&this.options.SecretId.indexOf(" ")>-1&&(console.error("error: SecretId\u683C\u5F0F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5"),console.error("error: SecretId format is incorrect. Please check")),this.options.SecretKey&&this.options.SecretKey.indexOf(" ")>-1&&(console.error("error: SecretKey\u683C\u5F0F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5"),console.error("error: SecretKey format is incorrect. Please check")),util.isNode()&&(console.warn("warning: cos-js-sdk-v5 \u4E0D\u652F\u6301 nodejs \u73AF\u5883\u4F7F\u7528\uFF0C\u8BF7\u6539\u7528 cos-nodejs-sdk-v5\uFF0C\u53C2\u8003\u6587\u6863\uFF1A https://cloud.tencent.com/document/product/436/8629"),console.warn("warning: cos-js-sdk-v5 does not support nodejs environment. Please use cos-nodejs-sdk-v5 instead. See: https://cloud.tencent.com/document/product/436/8629")),event.init(this),task.init(this)};base.init(COS$1,task);advance.init(COS$1,task);COS$1.util={md5:util.md5,xml2json:util.xml2json,json2xml:util.json2xml};COS$1.getAuthorization=util.getAuth;COS$1.version="1.3.4";var cos=COS$1,COS=cos,cosJsSdkV5=COS,index=_mergeNamespaces({__proto__:null,default:cosJsSdkV5},[cosJsSdkV5]);export{index as i};
