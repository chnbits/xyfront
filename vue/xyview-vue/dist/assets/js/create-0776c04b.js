import{a as M}from"../index-91ea30ae.js";const U={data(){return{orderInfo:[],orderSets:[],addressData:{name:"",tel:"",address:"",city:"",isDefault:0},deliverTypelist:[],deliverType:0,offlineList:[],offlineId:[],tradeNo:"",payTypeList:[{title:"\u652F\u4ED8\u5B9D",value:"alipay",icon:"xyicon-alipay",color:"#07b4fd",check:!0},{title:"\u5FAE\u4FE1\u652F\u4ED8",value:"wxpay",icon:"xyicon-wxpay",color:"#51b100",check:!1},{title:"\u4F59\u989D\u652F\u4ED8",value:"score_1",icon:"xyicon-card",color:"#fec600",check:!1}],form:{payType:""},tradeNo:""}},async created(){var y,w;let u=JSON.parse((w=(y=this.$route)==null?void 0:y.query)==null?void 0:w.data).orderInfo;if(u){let a=await this.$xyutil.request({url:"/v1/ishop/order/create",method:"post",data:{orderInfo:u}});console.log(a),a.code==200?(this.orderInfo=a.data.orderInfo,this.orderSets=a.data.orderSets):this.$xyutil.showModal({title:"\u63D0\u793A",content:a.data.msg,success:function(h){}})}},methods:{setAddress(s){console.log(s),this.addressData=s},couponOk(s){this.countMoney()},couponRest(s){this.orderInfo[s].couponIds=new Array,this.toggleMask(s)},selectCoupon(s,u){this.orderInfo[s].couponIds.push(u)},async countMoney(){let s=await this.$xyutil.request({url:"/v1/ishop/order/money",method:"post",data:{orderInfo:this.orderInfo}});s.code==200?this.orderSets=s.data.orderSets:this.$xyutil.showToast({title:s.msg,icon:"loading",duration:1e3})},async submit(){if(this.deliverType==3&&this.offlineId.length==0){this.$util.showToast({title:"\u8BF7\u9009\u62E9\u95E8\u5E97"});return}let s=await this.$xyutil.request({url:"/v1/ishop/order/submit",method:"post",data:{orderInfo:this.orderInfo,extra:{payType:this.form.payType,payPlatform:"pc"}}});if(s.code==200)this.tradeNo=s.data.tradeNo,this.orderSets=s.data.orderSets,s.data.paySuccess?(this.$util.showToast({title:"\u652F\u4ED8\u6210\u529F",icon:"success",duration:2e3}),this.$router.push({path:"/ishop/order/my"})):s.data.isRedirect?window.open(s.data.payString,"_blank"):window.open("/pay/order/qrpay?realMoney="+this.info.price+"&payType="+this.form.payType+"&tradeNo="+this.tradeNo+"&payString="+s.data.payString,"_blank");else{this.loading=!1,alert(s.msg);return}}}},e=window.Vue.createElementVNode,m=window.Vue.renderList,x=window.Vue.Fragment,d=window.Vue.openBlock,c=window.Vue.createElementBlock,l=window.Vue.toDisplayString,f=window.Vue.createTextVNode,r=window.Vue.resolveComponent,n=window.Vue.withCtx,$=window.Vue.createBlock,i=window.Vue.createVNode,g=window.Vue.vShow,k=window.Vue.withDirectives,B=window.Vue.createCommentVNode,j=window.Vue.normalizeClass,q=window.Vue.normalizeStyle,E=window.Vue.pushScopeId,F=window.Vue.popScopeId,p=s=>(E("data-v-68d5801f"),s=s(),F(),s),O={class:"container bg-white m-t"},R=p(()=>e("div",{class:"ts-24 tw5 text-center m-b-lg"}," \u8BA2\u5355\u7ED3\u7B97 ",-1)),A={class:"p-t p-b p-l p-r flex space-between flex-alignCenter"},Y={class:"ts-14"},J={class:"user-address"},P={class:"cen"},G={class:"top"},H={class:"name"},K={class:"mobile"},Q={class:"address"},W=p(()=>e("span",{class:"xyicon xyicon-address"},null,-1)),X={class:"yt-list"},Z=["onClick"],ee={class:"cell-tip active"},oe=["onClick"],te={class:"con"},se={class:"left"},le={class:"title"},ne={class:"time"},ie={class:"right"},ae={class:"price"},de=p(()=>e("div",{class:"circle l"},null,-1)),ce=p(()=>e("div",{class:"circle r"},null,-1)),re=p(()=>e("text",{class:"tips"},null,-1)),pe=f("\u91CD\u7F6E"),_e=f("\u786E\u5B9A"),ue={key:0},fe={key:0},he={key:1},me={class:"goods-section justify-self-start md:pl-8"},xe={class:"m-b flex"},ye=["src"],we={class:"name"},ve=["src"],be={class:"right flex-1"},ge={class:"title clamp m-b-xs"},ke={class:"spec m-b-xs text-gray-700"},Ve={class:"price-box text-gray-700"},Ie={class:"price"},Se={class:"number m-l-xs"},Te=p(()=>e("hr",null,null,-1)),Ce={class:"m-t flex flex-col justify-end items-end"},ze={class:"flex items-center"},Ne=p(()=>e("h4",{class:"m-r"},"\u4ED8\u6B3E\u65B9\u5F0F\uFF1A",-1)),Le={class:"p-t-sm p-b-sm p-l p-r flex space-between flex-alignCenter"},De={class:"m-r"},Me={class:"ts-16"},Ue=p(()=>e("p",null,null,-1)),$e={class:"pay-total"},Be={class:"price-content m-b-sm"},je=p(()=>e("text",null,"\u5B9E\u4ED8\u6B3E",-1)),qe=p(()=>e("text",{class:"price-tip"},"\uFFE5",-1)),Ee={class:"price"},Fe=f("\u7ACB\u5373\u4ED8\u6B3E");function Oe(s,u,y,w,a,h){const S=r("el-radio"),T=r("el-radio-group"),_=r("el-form-item"),V=r("xy-choose"),v=r("el-button"),C=r("el-dialog"),z=r("el-input"),N=r("el-form"),I=r("el-col"),L=r("el-row");return d(),c("div",O,[R,(d(!0),c(x,null,m(a.orderInfo,(o,D)=>(d(),c("div",{key:D},[i(L,{gutter:20},{default:n(()=>[i(I,{xs:24,span:12,offset:0},{default:n(()=>[i(N,{ref_for:!0,ref:"form","label-width":"80px",inline:!1,size:"normal"},{default:n(()=>[k(i(_,{label:"\u914D\u9001\u65B9\u5F0F"},{default:n(()=>[i(T,{modelValue:o.deliverType,"onUpdate:modelValue":t=>o.deliverType=t,size:"normal"},{default:n(()=>[(d(!0),c(x,null,m(o.deliverTypeList,t=>(d(),$(S,{key:t.key,label:t.value},{default:n(()=>[f(l(t.title),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1536),[[g,o.deliverTypeList.length>1]]),k(i(_,{label:"\u9009\u62E9\u95E8\u5E97",class:"offline-list"},{default:n(()=>[i(V,{options:o.offlineList,modelValue:o.offlineId,"onUpdate:modelValue":t=>o.offlineId=t},{default:n(t=>[e("div",A,[e("div",null,[e("h5",Y,l(t.city),1),e("p",null,l(t.address),1)])])]),_:2},1032,["options","modelValue","onUpdate:modelValue"])]),_:2},1536),[[g,o.deliverType==3]]),k(i(_,{label:"\u6536\u8D27\u5730\u5740",class:"address-section"},{default:n(()=>[e("div",J,[e("div",P,[e("div",G,[e("text",H,l(o.addressData.name),1),e("text",K,l(o.addressData.tel),1)]),e("div",Q,[W,f(" "+l(o.addressData.city.join(""))+" "+l(o.addressData.address),1)])])])]),_:2},1536),[[g,o.deliverType<=2]]),i(_,{label:"\u4F18\u60E0\u660E\u7EC6"},{default:n(()=>[e("div",X,[e("div",{class:"yt-list-cell b-b",onClick:t=>{o.couponShow=!0}},[e("text",ee," \u9009\u62E9\u4F18\u60E0\u5238("+l(o.couponList.length)+") ",1)],8,Z)]),i(C,{title:"\u4F18\u60E0\u5238",modelValue:o.couponShow,"onUpdate:modelValue":t=>o.couponShow=t,width:300},{footer:n(()=>[e("span",null,[i(v,{size:"small",type:"default",onClick:t=>h.couponRest(o.storeInfo.id)},{default:n(()=>[pe]),_:2},1032,["onClick"]),i(v,{size:"small",class:"ok",type:"primary",onClick:t=>h.couponOk(o.storeInfo.id)},{default:n(()=>[_e]),_:2},1032,["onClick"])])]),default:n(()=>[(d(!0),c(x,null,m(o.couponList,(t,b)=>(d(),c("div",{onClick:Re=>h.selectCoupon(o.storeInfo.id,t.id),class:"coupon-item",key:b},[e("div",te,[e("div",se,[e("text",le,l(t.title),1),e("text",ne,"\u6709\u6548\u671F\u81F3"+l(s.$xyutil.timeFormat(t.expireTime)),1)]),e("div",ie,[e("text",ae,l(t.couponValue),1),e("text",null,"\u6EE1"+l(t.limitMoney)+"\u53EF\u7528",1)]),de,ce]),re],8,oe))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),i(_,{label:"\u5546\u54C1\u91D1\u989D"},{default:n(()=>[f(" \uFFE5"+l(o.originalMoney),1)]),_:2},1024),i(_,{label:"\u4F18\u60E0\u91D1\u989D"},{default:n(()=>[o.couponSum>0?(d(),c("span",ue,"-")):B("",!0),f(" \uFFE5"+l(o.couponSum),1)]),_:2},1024),i(_,{label:"\u8FD0\u8D39"},{default:n(()=>[o.deliverMoney==0?(d(),c("span",fe,"\u514D\u8FD0\u8D39")):(d(),c("span",he,l(o.deliverMoney),1))]),_:2},1024),i(_,{label:"\u5907\u6CE8"},{default:n(()=>[i(z,{class:"desc",type:"text",modelValue:o.remark,"onUpdate:modelValue":t=>o.remark=t,placeholder:"\u8BF7\u586B\u5199\u5907\u6CE8\u4FE1\u606F","placeholder-class":"placeholder"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),i(_)]),_:2},1536)]),_:2},1024),i(I,{xs:24,span:12,offset:0},{default:n(()=>[e("div",me,[e("div",xe,[e("img",{class:"logo",width:"30",src:o.storeInfo.logo},null,8,ye),e("text",we,l(o.storeInfo.title),1)]),(d(!0),c(x,null,m(o.skuList,(t,b)=>(d(),c("div",{class:"goods-item flex",key:b},[e("img",{width:"70",src:t.itemInfo.cover},null,8,ve),e("div",be,[e("div",ge,l(t.itemInfo.title),1),e("div",ke,l(t.spec),1),e("div",Ve,[e("span",Ie,"\uFFE5"+l(t.price),1),e("span",Se,"x "+l(t.amount),1)])])]))),128))])]),_:2},1024)]),_:2},1024)]))),128)),Te,e("div",Ce,[e("div",ze,[Ne,i(V,{options:a.payTypeList,modelValue:a.form.payType,"onUpdate:modelValue":u[0]||(u[0]=o=>a.form.payType=o)},{default:n(o=>[e("div",Le,[e("div",De,[e("i",{class:j("ts-32 xyicon "+o.icon),style:q({color:o.color})},null,6)]),e("div",null,[e("h5",Me,l(o.title),1),Ue])])]),_:1},8,["options","modelValue"])]),e("div",$e,[e("div",Be,[je,qe,e("text",Ee,l(a.orderSets.realMoney),1)]),i(v,{type:"primary",disabled:a.form.payType!="",class:"submit w-28 m-r-0",size:"large",onClick:h.submit},{default:n(()=>[Fe]),_:1},8,["disabled","onClick"])])])])}var Ye=M(U,[["render",Oe],["__scopeId","data-v-68d5801f"]]);export{Ye as default};
