import{a as d}from"../index-91ea30ae.js";const u={props:{qrloginShow:!1,type:"",cate:{type:Number,default:0},tip:{type:String,default:"\u4F7F\u7528\u5FAE\u4FE1\u626B\u4E00\u626B"},width:{type:Number,default:200},bgColor:{type:String,default:"#eee"}},data(){return{seed:"",qrurl:"",timer:null,timeout:!1}},mounted:function(){this.qrloginShow&&this.loadData()},watch:{qrloginShow(t){t?(clearInterval(this.timer),this.loadData()):clearInterval(this.timer)}},beforeUnmount(){clearInterval(this.timer)},methods:{async loadData(){let t=await this.$util.request({url:"/v1/qrlogin/qrlogin/getSeed",data:{type:this.type,cate:this.cate},method:"get"});t.code==200?(this.seed=t.data.seed,this.qrurl=t.data.qrurl,this.timeout=!1,clearInterval(this.timer),this.timer=setInterval(this.getLogin,3e3)):this.$util.showToast({title:t.msg,icon:"loading",duration:3e3})},async getLogin(){let t=await this.$util.request({url:"/v1/qrlogin/qrlogin/getLogin?seed="+this.seed,method:"get"});t.code==200&&(t.data.timeout?(this.timeout=!0,clearInterval(this.timer)):(clearInterval(this.timer),this.cate==1?(this.$util.showToast({title:t.msg,icon:"success",duration:2e3}),this.$emit("success")):t.data.userInfo?(t.data.token&&this.$store.commit("user/setToken",t.data.token),this.$store.commit("user/setUserInfo",t.data.userInfo),this.$util.showToast({title:t.msg,icon:"success",duration:2e3}),this.$emit("success")):this.$router.push({path:"/qrlogin/login",query:{seed:this.seed,type:this.type}})))}}},h=window.Vue.resolveComponent,n=window.Vue.normalizeStyle,m=window.Vue.createVNode,o=window.Vue.openBlock,i=window.Vue.createElementBlock,p=window.Vue.createCommentVNode,g=window.Vue.toDisplayString,w=window.Vue.createElementVNode;window.Vue.pushScopeId;window.Vue.popScopeId;const _={key:0},y={key:0,class:"xyicon xyicon-history"},f={class:"tip m-t-md text-666"};function q(t,s,r,v,e,a){const l=h("xy-qrcode");return o(),i("div",{class:"qr-box",onClick:s[0]||(s[0]=(...c)=>a.loadData&&a.loadData(...c))},[e.qrurl?(o(),i("div",_,[m(l,{class:"qrcode",style:n({opacity:e.timeout?.3:1}),value:e.qrurl,options:{width:r.width}},null,8,["style","value","options"]),e.timeout?(o(),i("span",y)):p("",!0)])):(o(),i("div",{key:1,class:"no-qr",style:n({width:this.width+"px",height:this.width+"px",background:this.bgColor})},null,4)),w("div",f,g(r.tip),1)])}var V=d(u,[["render",q],["__scopeId","data-v-3463165a"]]);export{V as q};
