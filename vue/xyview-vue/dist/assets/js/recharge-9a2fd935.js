import{p as I}from"./getRet-8d66d4f2.js";import{a as L}from"../index-91ea30ae.js";const B={name:"Recharge",mixins:[I],data(){var n,s,r;return{loading:!1,agree:!1,balance:(r=(s=(n=this.$store.state.user.userInfo)==null?void 0:n.moduleExtend)==null?void 0:s.user_score[1])==null?void 0:r.balance,scoreList:[],form:{money:"0.01",payType:""},rules:{money:[{required:!0,message:"\u8BF7\u8F93\u5165\u5145\u503C\u91D1\u989D",trigger:"blur"}],payType:[{required:!0,message:"\u8BF7\u9009\u62E9\u652F\u4ED8\u65B9\u5F0F"}]},payTypeSubIndex:0,orderInfo:[],orderSets:{totalMoney:0,realMoney:0},tradeNo:"",payDialog:!1,payTypeList:[{title:"\u652F\u4ED8\u5B9D",value:"alipay",icon:"xyicon-alipay",color:"#07b4fd",check:!0},{title:"\u5FAE\u4FE1\u652F\u4ED8",value:"wxpay",icon:"xyicon-wxpay",color:"#51b100",check:!1}],bankList:[{name:"\u4E2D\u56FD\u94F6\u884C",logo:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-f12e1180-fce8-465f-a4cd-9f2da88ca0e6/376ae143-b854-4561-bdf2-054307feb2f8.png"}]}},created(){this.loadBalance()},methods:{goBack(){this.$router.back()},async loadBalance(){let n=await this.$util.request({url:"/v1/user_score/score/my",data:{typeId:1},method:"get"});n.code==200?(this.scoreList=n.data.dataList,this.balance=this.scoreList[1].balance):this.$util.showToast({title:n.msg,icon:"loading",duration:3e3})},getPayResult(){},async submit(){let n=this;this.$refs.form.validate(async s=>{if(s){if(!this.agree)return this.$util.showToast({title:"\u8BF7\u52FE\u9009\u63D0\u793A\u8868\u793A\u540C\u610F",icon:"loading",duration:3e3}),!1;this.loading=!0;let r=await this.$util.request({url:"/v1/order/order/submit",data:{oneOrder:1,orderInfo:[{spuId:1,skuId:0,amount:this.form.money/1,extra:{typeId:1}}],extra:{module:"user_score",service:"score",payType:this.form.payType,payPlatform:"pc"}},method:"post"});if(this.loading=!1,r.code==200)this.tradeNo=r.data.tradeNo,this.orderSets=r.data.orderSets,this.payDialog=!0,this.timer=setInterval(function(){n.getPayResult(n.tradeNo)},3e3),r.data.isRedirect?window.open(r.data.payString,"_blank"):window.open("/pay/order/qrpay?realMoney="+this.orderSets.realMoney+"&payType="+this.form.payType+"&tradeNo="+this.tradeNo+"&payString="+r.data.payString,"_blank");else{this.$util.showToast({title:r.msg,icon:"loading",duration:3e3});return}}else return!1})}}},c=window.Vue.createTextVNode,i=window.Vue.resolveComponent,t=window.Vue.withCtx,e=window.Vue.createVNode,a=window.Vue.createElementVNode,d=window.Vue.toDisplayString,g=window.Vue.normalizeClass,q=window.Vue.normalizeStyle,D=window.Vue.renderList,E=window.Vue.Fragment,p=window.Vue.openBlock,_=window.Vue.createElementBlock,w=window.Vue.createCommentVNode,U={class:"box"},z={class:"p-t"},M=c("\u4E2A\u4EBA\u8BBE\u7F6E"),R=c("\u4F59\u989D\u5145\u503C"),P={class:"content"},F=c(" \xA5"),A={class:"p-t p-b p-l p-r flex space-between flex-alignCenter"},G={class:"m-r"},K={class:"ts-18"},O=a("p",null,null,-1),Y={key:0},j=["onClick"],H=["src"],J={key:0,class:"checkIcon"},Q=c("\u7ACB\u5373\u5145\u503C"),W=c("\u53D6\u6D88"),X=a("ul",null,[a("li",null,"\u652F\u4ED8\u672A\u5230\u8D26\u8BF7\u5148\u786E\u8BA4\u7B2C\u4E09\u65B9\u652F\u4ED8\u5E73\u53F0\u8D26\u5355\u5DF2\u652F\u4ED8\u6210\u529F\uFF1B"),a("li",null,"\u5982\u679C\u786E\u8BA4\u81EA\u5DF1\u5DF2\u7ECF\u4ED8\u6B3E\uFF0C\u4F59\u989D\u5374\u672A\u5230\u8D26\uFF0C\u8BF7\u8054\u7CFB\u5BA2\u670D\u6838\u5B9E\u3002")],-1),Z={slot:"footer"},$=c("\u652F\u4ED8\u9047\u5230\u95EE\u9898"),ee=c("\u652F\u4ED8\u6210\u529F");function te(n,s,r,oe,o,f){const h=i("el-breadcrumb-item"),V=i("el-breadcrumb"),u=i("el-form-item"),k=i("el-input"),v=i("xy-choose"),x=i("el-checkbox"),m=i("el-button"),T=i("el-form"),b=i("el-descriptions-item"),C=i("el-descriptions"),S=i("el-alert"),N=i("el-dialog");return p(),_("div",U,[a("div",z,[e(V,{"separator-class":"el-icon-arrow-right",class:"p-l m-b"},{default:t(()=>[e(h,{to:{path:"/user/center"}},{default:t(()=>[M]),_:1}),e(h,null,{default:t(()=>[R]),_:1})]),_:1})]),a("div",P,[e(T,{model:o.form,rules:o.rules,ref:"form","label-width":"120px","label-suffix":":",inline:!1,size:"normal"},{default:t(()=>[e(u,{label:"\u5F53\u524D\u8D26\u53F7"},{default:t(()=>[a("span",null,d(n.$store.state.user.userInfo.nickname)+"\uFF08id:"+d(n.$store.state.user.userInfo.id)+"\uFF09",1)]),_:1}),e(u,{label:"\u5F53\u524D\u4F59\u989D"},{default:t(()=>[F,a("span",null,d(o.balance),1)]),_:1}),e(u,{prop:"money",label:"\u5145\u503C\u91D1\u989D"},{default:t(()=>[e(k,{style:{width:"220px"},modelValue:o.form.money,"onUpdate:modelValue":s[0]||(s[0]=l=>o.form.money=l),placeholder:"\u8BF7\u8F93\u5165\u5145\u503C\u91D1\u989D"},null,8,["modelValue"])]),_:1}),e(u,{prop:"payType",label:"\u652F\u4ED8\u65B9\u5F0F",required:""},{default:t(()=>[e(v,{options:o.payTypeList,modelValue:o.form.payType,"onUpdate:modelValue":s[1]||(s[1]=l=>o.form.payType=l)},{default:t(l=>[a("div",A,[a("div",G,[a("i",{class:g("ts-32 xyicon "+l.icon),style:q({color:l.color})},null,6)]),a("div",null,[a("h5",K,d(l.title),1),O])])]),_:1},8,["options","modelValue"]),o.form.payType=="bank"?(p(),_("div",Y,[(p(!0),_(E,null,D(o.bankList,(l,y)=>(p(),_("div",{class:g(["bank-choose m-t m-b",{borderActive:y==o.payTypeSubIndex}]),key:y,onClick:se=>o.payTypeSubIndex=y},[a("img",{src:l.logo,alt:""},null,8,H),l.check?(p(),_("span",J)):w("",!0)],10,j))),128))])):w("",!0)]),_:1}),e(u,{label:""},{default:t(()=>[e(x,{modelValue:o.agree,"onUpdate:modelValue":s[2]||(s[2]=l=>o.agree=l)},null,8,["modelValue"]),c(" \u8D26\u6237\u4F59\u989D\u53EF\u7528\u6765\u5728"+d(n.$store.state.app.siteInfo.title)+"\u652F\u4ED8\u5404\u79CD\u7C7B\u578B\u7684\u4EA7\u54C1\u6216\u8005\u670D\u52A1\u3002 ",1)]),_:1}),e(u,{class:"m-t-md"},{default:t(()=>[e(m,{type:"primary",onClick:f.submit,disabled:!o.agree},{default:t(()=>[Q]),_:1},8,["onClick","disabled"]),e(m,{onClick:f.goBack},{default:t(()=>[W]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),e(N,{title:"\u63D0\u793A",visible:o.payDialog,"onUpdate:visible":s[5]||(s[5]=l=>o.payDialog=l),width:"600px"},{default:t(()=>[e(C,{title:"",column:1},{default:t(()=>[e(b,{label:"\u5145\u503C\u65B9\u5F0F"},{default:t(()=>[c(d(o.form.payType),1)]),_:1}),e(b,{label:"\u5145\u503C\u91D1\u989D"},{default:t(()=>[c(d(o.orderSets.totalMoney),1)]),_:1})]),_:1}),e(S,{title:"\u63D0\u793A",type:"warning",effect:"light","show-icon":"",closable:!1,class:"lh-1-6 m-t-md"},{default:t(()=>[X]),_:1}),a("span",Z,[e(m,{type:"danger",onClick:s[3]||(s[3]=l=>n.$util.showToast({title:"\u8BF7\u8054\u7CFB\u5BA2\u670D\u89E3\u51B3",icon:"loading",duration:5e3}))},{default:t(()=>[$]),_:1}),e(m,{type:"success",onClick:s[4]||(s[4]=l=>n.$router.push({path:"/user/center"}))},{default:t(()=>[ee]),_:1})])]),_:1},8,["visible"])])}var ae=L(B,[["render",te]]);export{ae as default};
