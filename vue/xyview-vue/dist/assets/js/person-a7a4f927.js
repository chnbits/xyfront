import{a as P}from"../index-91ea30ae.js";const H={name:"personcer",components:{},data(){var e,t,a,d,i,m,y,g;return{loading:!1,sizeLimit:2,options:{type:"image",drag:!0,driver:this.$store.state.app.uploadDriver,signUrl:"",icon:"",placeholder:"",action:"",format:"jpg,png",maxSize:1024*this.sizeLimit,hasUploadModule:!0},change:(t=(e=this.$route)==null?void 0:e.query)!=null&&t.change?this.$route.query.change:"",countryCode:(d=(a=this.$store.state.user.userInfo)==null?void 0:a.mobile)==null?void 0:d.identityGroup,mobile:(m=(i=this.$store.state.user.userInfo)==null?void 0:i.mobile)==null?void 0:m.identifier,email:(g=(y=this.$store.state.user.userInfo)==null?void 0:y.email)==null?void 0:g.identifier,mobileVerify:{countryCode:"+86",mobile:"",verify:"",token:""},emailVerify:{email:"",verify:"",token:""},form:{country:"+86",certCate:1,certType:1,realName:"",certNo:"",certPhoto:"",certPhotoInverse:""},mobileHelpUpload:!1,mobileHelpUploadId:"",mobileHelpUploadUrl:"",mobileHelpUploadTimer:null}},created(){this.mobile&&(this.mobileVerify.countryCode=this.countryCode,this.mobileVerify.mobile=this.mobile),this.email&&(this.emailVerify.email=this.email),this.loadData();var e=new Date;this.mobileHelpUploadId=e.getTime(),this.mobileHelpUploadUrl=this.$util.baseDomain()+"/user_cert/cert/mobileUpload?cate=1&id="+this.mobileHelpUploadId},watch:{"form.certPhoto":{handler(e){},deep:!0,immediate:!1}},methods:{test(){console.log(this.form)},async getOcrInfo(e,t){if(!t)return;let a={};switch(this.form.certCate){case 1:a.side=e,a.url=t;break;case 2:a.url=t;break}let d=await this.$util.request({url:"/v1/user_cert/cert/getOcrInfo",data:{certCate:this.form.certCate,...a},method:"post"});d.code==200?(this.form.realName=d.data.realName,this.form.certNo=d.data.certNo):this.$util.showToast({title:d.msg,icon:"loading",duration:3e3})},isChinese(e){var t=/^[\u0391-\uFFE5]+$/;if(e!=""&&!t.test(e))return alert("\u5FC5\u987B\u8F93\u5165\u4E2D\u6587\uFF01"),!1},onCountrySelect({name:e,iso2:t,dialCode:a}){this.mobileVerify.countryCode="+"+a},getMobileVerifyToken(e){this.mobileVerify.token=e.token},getEmailVerifyToken(e){this.emailVerify.token=e.token},mobileUpload(){this.mobileHelpUpload=!0,this.mobileHelpUploadTimer=setInterval(this.syncMobileUploadStatue,3e3)},async syncMobileUploadStatue(){let e=await this.$util.request({url:"/v1/core/index/cache",data:{id:this.mobileHelpUploadId},method:"get"});e.code==200&&e.data.info&&(this.form.certPhoto=e.data.info.certPhoto,this.form.certPhotoInverse=e.data.info.certPhotoInverse)},async loadData(){if(this.change)return;this.loading=!0;let e=await this.$util.request({url:"/v1/user_cert/cert/my",data:{},method:"get"});e.code==200?e.data.info&&(this.form=e.data.info):this.$util.showToast({title:e.msg,icon:"loading",duration:3e3}),this.loading=!1},cofirm(){this.$confirm('\u786E\u5B9A\u8981\u4F7F\u7528\u8BE5\u8EAB\u4EFD\uFF08<span style="color: var(--primary-color)">'+this.form.realName+"  "+this.form.certNo+'</span>\uFF09\u8FDB\u884C\u5B9E\u540D\u8BA4\u8BC1\u5417\uFF1F\u8BF7\u786E\u4FDD\u60A8\u662F\u8BE5<span style="color: var(--primary-color)">\u5B9E\u540D\u4FE1\u606F\u672C\u4EBA</span>\uFF0C\u5426\u5219\u4E0B\u4E00\u6B65\u65E0\u6CD5\u901A\u8FC7\u9A8C\u8BC1',"\u786E\u5B9A\u4F7F\u7528\u8BE5\u4FE1\u606F\u8FDB\u884C\u8BA4\u8BC1\u5417\uFF1F",{distinguishCancelAndClose:!0,confirmButtonText:"\u6211\u5F88\u786E\u5B9A",cancelButtonText:"\u8FD4\u56DE\u4FEE\u6539",dangerouslyUseHTMLString:!0}).then(()=>{this.handleSubmit()}).catch(e=>{})},async handleSubmit(){var a,d;this.form.change=this.change,!this.email&&this.$xyutil.hasExt("reg_email")&&(this.form.emailVerify=this.emailVerify),!this.mobile&&this.$xyutil.hasExt("reg_mobile")&&(this.form.mobileVerify=this.mobileVerify),this.loading=!0;let e=this;setTimeout(function(){e.loading=!1},5e3);let t=await this.$util.request({url:((a=this.form)==null?void 0:a.id)&&!this.change?"/v1/user_cert/cert/edit":"/v1/user_cert/cert/add",data:this.form,method:((d=this.form)==null?void 0:d.id)&&!this.change?"put":"post"});t.code=="200"?(this.$util.showToast({title:t.msg,icon:"success",duration:2e3}),this.$router.push({path:"/user_cert/faceid/person"})):this.$util.showToast({title:t.msg,icon:"loading",duration:3e3}),this.loading=!1}}},_=window.Vue.createTextVNode,n=window.Vue.resolveComponent,s=window.Vue.withCtx,l=window.Vue.createVNode,o=window.Vue.createElementVNode,p=window.Vue.openBlock,b=window.Vue.createBlock,h=window.Vue.createCommentVNode,U=window.Vue.Fragment,v=window.Vue.createElementBlock,D=window.Vue.resolveDirective,B=window.Vue.withDirectives,C=window.Vue.toDisplayString,M=window.Vue.pushScopeId,F=window.Vue.popScopeId,c=e=>(M("data-v-76d39e58"),e=e(),F(),e),L={class:"bg-white p-t p-b"},O=_("\u4E2A\u4EBA\u8BBE\u7F6E"),G=_("\u4E2A\u4EBA\u7528\u6237\u5B9E\u540D\u8BA4\u8BC1"),j={class:"content p-a-md m-t-lg"},A=c(()=>o("h3",{class:"m-b-md ts-22 text-center"},"\u8BF7\u586B\u5199\u4E2A\u4EBA\u4FE1\u606F",-1)),J=c(()=>o("div",{class:"m-b-lg text-666 text-left flex space-center"},[o("p",{class:"lh-1-6 ts-14",style:{"max-width":"500px"}}," \u9002\u7528\u4E2A\u4EBA\u7528\u6237\uFF0C\u8D26\u53F7\u4F7F\u7528\u6743\u5C5E\u4E8E\u4E2A\u4EBA\u3002\u4E2A\u4EBA\u5B9E\u540D\u8BA4\u8BC1\u7684\u8D26\u53F7\u4EA7\u751F\u6D88\u8D39\u65F6\u53EF\u4EE5\u5F00\u5177\u666E\u7968\uFF0C\u4E0D\u652F\u6301\u5F00\u5177\u4E13\u7968\uFF1B \u5982\u679C\u6B64\u8D26\u53F7\u5C06\u4F1A\u662F\u4F01\u4E1A\u4F7F\u7528\uFF0C\u60A8\u5E94\u5F53\u907F\u514D\u4F7F\u7528\u4E2A\u4EBA\u5B9E\u540D\uFF0C\u5E94\u8FD4\u56DE\u4E0A\u4E00\u9875\u9009\u62E9\u4F01\u4E1A\u5B9E\u540D\u8BA4\u8BC1\u9009\u9879\u3002 ")],-1)),$={class:"inline-flex justify-between"},K=c(()=>o("span",null,"\u8EAB\u4EFD\u8BC1\u7167\u7247",-1)),Q={class:"flex flex-alignCenter flex-center",style:{width:"120px",height:"120px",background:"#05B9CF"}},R=c(()=>o("span",null,"\u70B9\u51FB\u6216\u62D6\u62FD",-1)),W=c(()=>o("i",{class:"xyicon xyicon-plus",style:{"font-size":"48px",color:"#E1E1E1","margin-top":"18px","margin-bottom":"20px"}},null,-1)),X=c(()=>o("span",null,"\u4E0A\u4F20\u8EAB\u4EFD\u8BC1\u6B63\u9762\u7167\u7247\uFF08\u5934\u50CF\u9762\uFF09",-1)),Y=c(()=>o("span",null,"\u70B9\u51FB\u6216\u62D6\u62FD",-1)),Z=c(()=>o("i",{class:"xyicon xyicon-plus",style:{"font-size":"48px",color:"#E1E1E1","margin-top":"18px","margin-bottom":"20px"}},null,-1)),ee=c(()=>o("span",null,"\u4E0A\u4F20\u8EAB\u4EFD\u8BC1\u53CD\u9762\u7167\u7247(\u56FD\u5FBD\u9762)",-1)),te=_("\u4FEE\u6539\u624B\u673A\u53F7"),oe={class:"flex"},le=_("\u4FEE\u6539\u90AE\u7BB1"),ie={class:"flex"},se={class:"m-t-lg flex space-between"},re={class:"m-r"},ne=_("\u4E0A\u4E00\u6B65"),ae=_(" \u4E0B\u4E00\u6B65 "),de={class:"help p-l-lg p-r-lg p-t-md"},ce={class:"lh-1-6 ts-14"},me=c(()=>o("li",null,"1. \u624B\u673A\u53F7\u7801\u7684\u5B9E\u540D\u4FE1\u606F\u9700\u8981\u4E0E\u4E0A\u4F20\u8EAB\u4EFD\u8BC1\u7167\u7247\u8EAB\u4EFD\u4FE1\u606F\u4E00\u81F4\u7684\uFF1B ",-1)),ue=c(()=>o("li",null,"3. \u9700\u8981\u5BF9\u8BC1\u4EF6\u73B0\u573A\u62CD\u7167\uFF0C\u4E14\u4FDD\u8BC1\u6587\u5B57\u548C\u56FE\u7247\u3001\u4EBA\u50CF\u56E2\u7B49\u62CD\u6444\u6E05\u6670\u53EF\u89C1",-1));function pe(e,t,a,d,i,m){const y=n("el-breadcrumb-item"),g=n("el-breadcrumb"),N=n("xy-qrcode"),I=n("el-popover"),x=n("xy-upload"),u=n("el-form-item"),f=n("el-input"),T=n("xy-country-select"),w=n("router-link"),k=n("xy-send-verify"),V=n("el-button"),E=n("el-form"),S=n("el-col"),z=n("el-row"),q=D("loading");return p(),v("div",L,[l(g,{"separator-class":"el-icon-arrow-right",class:"p-l m-b"},{default:s(()=>[l(y,{to:{path:"/user/center"}},{default:s(()=>[O]),_:1}),l(y,null,{default:s(()=>[G]),_:1})]),_:1}),o("div",j,[A,J,B((p(),b(z,{type:"flex",justify:"center",align:"middle"},{default:s(()=>[l(S,{xs:22,sm:12,md:10,lg:10,class:"login-box bg-white"},{default:s(()=>[l(E,{ref:"form",model:i.form,"label-position":"top"},{default:s(()=>[l(u,{prop:"certPhoto",label:"\u8EAB\u4EFD\u8BC1\u7167\u7247",required:""},{label:s(()=>[o("div",$,[K,l(I,{placement:"top-start",title:"\u624B\u673A\u8F85\u52A9\u4E0A\u4F20",width:"120px",trigger:"click"},{reference:s(()=>[o("span",{onClick:t[0]||(t[0]=(...r)=>m.mobileUpload&&m.mobileUpload(...r)),class:"cursor-pointer ts-14 m-l-lg hidden"},"\u624B\u673A\u8F85\u52A9\u4E0A\u4F20")]),default:s(()=>[o("div",Q,[l(N,{class:"qrcode",style:{opacity:1},value:i.mobileHelpUploadUrl,options:{width:120}},null,8,["value"])])]),_:1})])]),default:s(()=>[o("div",null,[l(x,{options:i.options,header:{},modelValue:i.form.certPhoto,"onUpdate:modelValue":t[1]||(t[1]=r=>i.form.certPhoto=r)},{drag:s(()=>[R,W,X]),_:1},8,["options","modelValue"])])]),_:1}),l(u,{prop:"certPhotoInverse",required:""},{default:s(()=>[l(x,{options:i.options,header:{},modelValue:i.form.certPhotoInverse,"onUpdate:modelValue":t[2]||(t[2]=r=>i.form.certPhotoInverse=r)},{drag:s(()=>[Y,Z,ee]),_:1},8,["options","modelValue"])]),_:1}),l(u,{prop:"realName",label:"\u771F\u5B9E\u59D3\u540D",required:""},{default:s(()=>[l(f,{size:"large",type:"text",prefix:"ios-lock-outline",modelValue:i.form.realName,"onUpdate:modelValue":t[3]||(t[3]=r=>i.form.realName=r),placeholder:"\u8BF7\u8F93\u5165\u8EAB\u4EFD\u8BC1\u4E0A\u7684\u771F\u5B9E\u59D3\u540D"},null,8,["modelValue"])]),_:1}),l(u,{prop:"certNo",label:"\u8EAB\u4EFD\u8BC1\u53F7\u7801",required:""},{default:s(()=>[l(f,{size:"large",type:"text",prefix:"ios-lock-outline",modelValue:i.form.certNo,"onUpdate:modelValue":t[4]||(t[4]=r=>i.form.certNo=r),placeholder:"\u8BF7\u8F93\u516518\u4F4D\u4E8C\u4EE3\u8EAB\u4EFD\u8BC1\u53F7\u7801"},null,8,["modelValue"])]),_:1}),e.$util.hasExt("reg_mobile")?(p(),v(U,{key:0},[l(u,{prop:"mobile",label:"\u624B\u673A\u53F7\u9A8C\u8BC1",required:""},{default:s(()=>[l(f,{size:"large",type:"text",prefix:"ios-person-outline",disabled:!!this.mobile,modelValue:i.mobileVerify.mobile,"onUpdate:modelValue":t[5]||(t[5]=r=>i.mobileVerify.mobile=r),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u624B\u673A\u53F7\u7801"},{prepend:s(()=>[l(T,{defaultCountry:"CN",enabledCountryCode:"",onOnSelect:m.onCountrySelect},null,8,["onOnSelect"])]),_:1},8,["disabled","modelValue"]),o("div",null,[this.mobile?(p(),b(w,{key:0,to:"/reg_mobile/user/change",class:"ts-12"},{default:s(()=>[te]),_:1})):h("",!0)])]),_:1}),this.mobile?h("",!0):(p(),b(u,{key:0,prop:"verify"},{default:s(()=>[o("div",null,[o("div",oe,[l(f,{size:"large",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:i.mobileVerify.verify,"onUpdate:modelValue":t[6]||(t[6]=r=>i.mobileVerify.verify=r),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),l(V,{type:"primary",size:"large",class:"m-l-md"},{default:s(()=>[l(k,{onVerifysuccess:m.getMobileVerifyToken,url:"/v1/sms/verify/send",type:"\u624B\u673A\u53F7",account:"mobileVerify.mobile",title:"\u624B\u673A\u7ED1\u5B9A"},null,8,["onVerifysuccess"])]),_:1})])])]),_:1}))],64)):h("",!0),e.$util.hasExt("reg_email")?(p(),v(U,{key:1},[l(u,{prop:"email",label:"\u90AE\u7BB1\u9A8C\u8BC1",required:""},{default:s(()=>[l(f,{size:"large",type:"text",prefix:"ios-person-outline",disabled:!!this.email,modelValue:i.emailVerify.email,"onUpdate:modelValue":t[7]||(t[7]=r=>i.emailVerify.email=r),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u8D26\u53F7"},null,8,["disabled","modelValue"]),o("div",null,[this.email?(p(),b(w,{key:0,to:"/reg_email/user/change",class:"ts-12"},{default:s(()=>[le]),_:1})):h("",!0)])]),_:1}),this.email?h("",!0):(p(),b(u,{key:0,prop:"verify"},{default:s(()=>[o("div",null,[o("div",ie,[l(f,{size:"large",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:i.mobileVerify.verify,"onUpdate:modelValue":t[8]||(t[8]=r=>i.mobileVerify.verify=r),placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),l(V,{type:"primary",size:"large",class:"m-l-md"},{default:s(()=>[l(k,{onVerifysuccess:m.getEmailVerifyToken,url:"/v1/email/verify/send",type:"\u90AE\u7BB1",account:"emailVerify.mobile",title:"\u90AE\u7BB1\u7ED1\u5B9A"},null,8,["onVerifysuccess"])]),_:1})])])]),_:1}))],64)):h("",!0),o("div",se,[o("div",re,[l(V,{class:"full",size:"large",onClick:t[9]||(t[9]=r=>e.$router.back(-1))},{default:s(()=>[ne]),_:1})]),l(V,{class:"full submit-btn m-b-lg",size:"large",loading:i.loading,type:"primary",onClick:t[10]||(t[10]=r=>m.cofirm())},{default:s(()=>[ae]),_:1},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1})),[[q,i.loading]]),o("div",de,[o("ul",ce,[me,o("li",null,"2. \u4E0A\u4F20\u5355\u5F20\u7167\u7247\u5927\u5C0F\u4E0D\u8D85\u8FC7"+C(i.sizeLimit)+"MB\uFF0C\u652F\u6301PNG\u3001JPG\u683C\u5F0F\uFF1B",1),ue,o("li",null,"4. \u652F\u6301\u5BF9\u7167\u7247\u6DFB\u52A0\u52A0\u6C34\u5370\uFF0C\u5982\u6DFB\u52A0\u6C34\u5370\u6587\u5B57\uFF1A\u4EC5\u9650"+C(e.$store.state.app.siteInfo.title)+"\u5B9E\u540D\u8BA4\u8BC1\u4F7F\u7528\uFF0C\u6CE8\u610F\u4E0D\u8981\u906E\u6321\u6587\u5B57\u548C\u56FE\u6848\u3002",1)])])])])}var he=P(H,[["render",pe],["__scopeId","data-v-76d39e58"]]);export{he as default};
