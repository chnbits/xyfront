import{a as K}from"../index-91ea30ae.js";const X=window.Vue.defineComponent,Y=X({name:"GoodsComment",props:{itemId:{type:Boolean,defualt:0}},setup(){return{}},data(){return{loading:!1,itemId:0,labelList:[{name:"all",title:"\u5168\u90E8",count:0}],labelIndex:0,dataList:[],dataPage:{page:1,limit:20,total:0}}},created:function(){this.loadData(0)},watch:{itemId(){this.loadData(0)}},methods:{async loadData(e){this.loading=!0;let t=this.labelList[e].name,r=await this.$xyutil.request({url:"/v1/ishop/comment/lists?itemId="+this.itemId+"&type="+t,method:"get",data:{page:this.dataPage.page,limit:this.dataPage.limit}});r.code==200?(this.labelList=r.data.tabList,this.dataList=r.data.dataList,this.dataPage=r.data.dataPage):this.$xyutil.showToast({title:r.msg,icon:"loading",duration:1500}),this.loading=!1,this.labelIndex=e},handleSizeChange(e){this.dataPage.limit=e,this.loadData(this.labelIndex)},handleCurrentChange(e){this.dataPage.page=e,this.loadData(this.labelIndex)}}}),S=window.Vue.renderList,x=window.Vue.Fragment,u=window.Vue.openBlock,m=window.Vue.createElementBlock,g=window.Vue.toDisplayString,j=window.Vue.createTextVNode,L=window.Vue.resolveComponent,U=window.Vue.withCtx,H=window.Vue.createBlock,P=window.Vue.createCommentVNode,l=window.Vue.createElementVNode,G=window.Vue.createVNode,Z={class:"p-a"},ee={class:"media-list media-list-stream"},te={class:"m-r"},se=["src"],oe={class:"flex-1"},ie={class:"flex justify-between"},ae={class:"m-b-0 text-gray-400"},ne={class:"text-gray-400"},le={class:"m-t-sm lh-1-6 text-gray-500"},de={class:"flex m-t-sm"},ce=["src"],re={key:0,class:"append p-a bg-gray-100"},ue={class:"date"},pe={class:"rat"},he={class:"img-video"},me=["src"],_e={key:0,class:"flex justify-center"};function fe(e,t,r,y,I,w){const T=L("el-button"),N=L("el-empty"),z=L("el-skeleton"),D=L("el-pagination");return u(),m("div",Z,[(u(!0),m(x,null,S(e.labelList,(a,f)=>(u(),H(T,{key:f,class:"m-b-md",type:"primary",text:"",size:"default",bg:f==e.labelIndex,onClick:b=>e.loadData(f)},{default:U(()=>[j(g(a.title)+"("+g(a.count)+") ",1)]),_:2},1032,["bg","onClick"]))),128)),G(z,{loading:e.loading,animated:"",rows:8},{default:U(()=>[e.dataList.length==0?(u(),H(N,{key:0,description:"\u6682\u65E0\u6570\u636E"})):P("",!0),l("ul",ee,[(u(!0),m(x,null,S(e.dataList,(a,f)=>(u(),m("li",{key:f,class:"media p-b-md flex"},[l("div",te,[l("img",{style:{width:"48px",height:"48px","border-radius":"50%"},src:a.userInfo.avatar},null,8,se)]),l("div",oe,[l("div",ie,[l("div",null,[j(g(a.userInfo.nickname)+" ",1),l("span",ae,[l("span",null,"\uFF08"+g(a.skuSpec)+"\uFF09",1)])]),l("small",ne,g(e.$xyutil.timeFormat(a.createTime)),1)]),l("p",le,g(a.content),1),l("div",de,[(u(!0),m(x,null,S(a.images,(b,$)=>(u(),m("div",{class:"m-r",key:$},[l("img",{src:b.url,style:{width:"60px",height:"60px"}},null,8,ce)]))),128))]),a.append?(u(),m("view",re,[l("view",ue,g(e.$xyutil.timeFormat(a.append?a.append.createTime:"")),1),l("view",pe,g(a.append.content),1),l("view",he,[(u(!0),m(x,null,S(a.append.images,(b,$)=>(u(),m("div",{class:"m-r",key:$},[l("img",{src:b.url,style:{width:"60px",height:"60px"}},null,8,me)]))),128))])])):P("",!0)])]))),128))])]),_:1},8,["loading"]),e.dataList.length!=0?(u(),m("div",_e,[G(D,{class:"m-t-md",size:"default",onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange,"current-page":e.dataPage.page,"onUpdate:current-page":t[0]||(t[0]=a=>e.dataPage.page=a),background:"","page-sizes":[10,20,30,50],"page-size":e.dataPage.limit,"onUpdate:page-size":t[1]||(t[1]=a=>e.dataPage.limit=a),layout:"total, sizes, prev, pager, next, jumper",total:e.dataPage.total},null,8,["onSizeChange","onCurrentChange","current-page","page-size","total"])])):P("",!0)])}var ge=K(Y,[["render",fe]]);const c=window.Vue.resolveComponent,o=window.Vue.createVNode,s=window.Vue.createElementVNode,i=window.Vue.withCtx,_=window.Vue.toDisplayString,p=window.Vue.createTextVNode,M=window.Vue.renderList,O=window.Vue.Fragment,v=window.Vue.openBlock,C=window.Vue.createElementBlock,R=window.Vue.isRef,J=window.Vue.createBlock,A=window.Vue.createCommentVNode,ye=window.Vue.pushScopeId,we=window.Vue.popScopeId,k=e=>(ye("data-v-304abbf8"),e=e(),we(),e),be={class:"container m-t"},ve={class:"abstract p-a m-b"},ke=k(()=>s("p",{class:"text-gray-500"},null,-1)),Ie={class:"price-box p-a flex justify-between align-top"},$e=k(()=>s("span",{style:{color:"red"}},"\xA5",-1)),Ve={class:"ts-20",style:{color:"red"}},Ce={class:"m-l-lg"},Se=p(" \u5269\u4F59 "),xe={id:"order-stock"},Le=p(" \u4EF6 "),Te=p("\xA50"),Ne={class:"p-l-lg"},ze={class:"m-r m-b-sm"},De={class:"item-list"},Pe={class:"p-a-sm"},qe={class:"p-r-lg text-center hidden-sm-and-down"},Be=k(()=>s("div",null,"\u624B\u673A\u626B\u7801\u8BBF\u95EE",-1)),Ee={class:"buy-box m-b m-l flex justify-between"},Fe=p("\u7ACB\u5373\u8D2D\u4E70"),je=p("\u76F4\u63A5\u8D2D\u4E70"),Ue=p("\u52A0\u5165\u8D2D\u7269\u8F66"),He={class:"p-r-lg xs:p-r-0"},Ge=p("\u6536\u85CF\u5B9D\u8D1D"),Me=["innerHTML"],Oe={class:"m-b"},Re=k(()=>s("div",null,[s("span",null,"\u5E97\u94FA\u4FE1\u606F")],-1)),Je={class:"panel-body m-b"},Ae={class:"panel-body m-b"},Ke={class:"seller-head"},Qe=p(" \u8BC4\u5206: "),We=k(()=>s("div",{class:"panel-body"},[p(" \u5BA2\u670D: "),s("a",{class:"label label-primary",target:"_blank",href:"#"},[s("i",{class:"fa fa-commenting-o"}),p(" \u5728\u7EBF\u8054\u7CFB ")])],-1)),Xe=k(()=>s("div",null,[s("span",null,"\u63A8\u8350\u5546\u54C1")],-1)),Ye=["src","alt"],Ze={class:"p-l-xs"},et={class:"title ts-13 lh-1-6 text-left m-b clamp-2"},tt={class:"price text-danger text-left"},st={data(){return{loading:!1,id:"",currentTab:"content",promoteType:0,promoteId:0,promoteInfo:{curPrice:0},seckillLeftSeconds:0,info:{skuList:[]},currentImg:"",specClass:"none",specSelected:[],specSelectedIndex:"",amount:1,coupon:{getCouponShow:!1,loadingGetCoupon:!1,couponList:[]},favorite:!1,recList:[]}},created:async function(){this.id=this.$route.params.id,this.loadData(),this.loadHot()},watch:{$route(){this.id=this.$route.params.id,this.loadData()},specSelected(e){}},methods:{async toFavorite(){let e=this.favorite?1:0,t=await this.$xyutil.request({url:"/v1/ishop/collect/add",method:"post",data:{dataId:this.info.id,isCancel:e}});t.code==200?(this.favorite=!this.favorite,this.$xyutil.showToast({title:t.msg,icon:"loading",duration:1e3})):this.$xyutil.showToast({title:t.msg,icon:"error",duration:2e3})},async addCart(){this.specSelectedIndex;let e=await this.$xyutil.request({url:"/v1/ishop/cart/add",method:"post",data:{skuId:this.info.skuList[this.specSelectedIndex].id,promoteId:this.promoteId,promoteType:this.promoteType,amount:this.amount}});e.code==200?this.$xyutil.showToast({title:e.msg,icon:"loading",duration:1e3}):this.$xyutil.showToast({title:e.msg,icon:"error",duration:2e3})},buy(){if(this.$xyutil.isLogin()){let e=this;this.orderInfo[e.info.storeId]={skuList:[{itemId:this.info.id,skuId:this.info.skuList[this.specSelectedIndex].id,amount:1,promoteId:this.promoteId,promoteType:this.promoteType}]},console.log(this.orderInfo),this.$router.push({path:"/ishop/order/create",query:{data:`${JSON.stringify({orderInfo:this.orderInfo})}`}})}},selectSpec(e,t){this.specSelected[e]=t.value,console.log(this.specSelected);let r=!1;for(let y=0;y<this.info.skuList.length;y++)if(this.info.skuList[y].spec==this.specSelected.join(",")){console.log("\u5B58\u5728"),this.specSelectedIndex=y,r=!0;break}else console.log("\u4E0D\u5B58\u5728");r==!1&&(this.specSelectedIndex="")},async loadData(){this.loading=!0;let e=await this.$xyutil.request({url:"/v1/ishop/item/info/"+this.id,method:"get"});if(e.code==200&&(this.info=e.data.info,this.specSelected=this.info.skuList[0].spec.split(","),this.specSelectedIndex=0,console.log(this.specSelected),this.currentImg=this.info.cover,this.dataList=e.data.dataList),this.loading=!1,this.promoteType==1&&(await this.getSeckillInfo(),this.seckillLeftSeconds=new Date(this.promoteInfo.endTime.replace(/\-/g,"/")).getTime()/1e3-Date.parse(new Date)/1e3),this.$util.getToken()){let t=await this.$xyutil.request({url:"/v1/ishop/collect/my/0",method:"get",data:{dataId:this.info.id}});t.code==200&&t.data.dataList.length>0&&(this.favorite=!0),await this.$xyutil.request({url:"/v1/ishop/history/add",method:"post",data:{dataType:0,storeId:this.info.storeId,dataValue:this.info.id}})}},async loadHot(){let e=await this.$xyutil.request({url:"/v1/ishop/item/lists",method:"get",data:{limit:4,iadTag:"home_rec"}});e.code==200&&(this.recList=e.data.dataList),this.loading=!1},async getCoupon(e){let t=await this.$xyutil.request({url:"/v1/coupon/tpl/get",method:"post",data:{id:e}});t.code==200?this.$xyutil.showToast({title:t.msg,icon:"success",duration:1e3}):this.$xyutil.showToast({title:t.msg,icon:"error",duration:2e3})},async getSeckillInfo(){let e=await this.$xyutil.request({url:"/v1/ishop_seckill/seckill/info/"+this.promoteId,method:"get"});e.code==200&&(this.promoteInfo=e.data.info)}}},ot=Object.assign(st,{__name:"info",setup(e){return(t,r)=>{const y=c("xy-images-preview"),I=c("el-col"),w=c("el-descriptions-item"),T=c("xy-choose"),N=c("el-input-number"),z=c("el-descriptions"),D=c("xy-qrcode"),a=c("el-button"),f=c("el-row"),b=c("el-tab-pane"),$=c("el-tabs"),Q=c("el-input"),q=c("router-link"),W=c("el-rate"),B=c("el-card");return v(),C("div",be,[o(f,{gutter:20,class:"bg-white m-b-md p-a"},{default:i(()=>[o(I,{xs:24,md:24,lg:10,offset:0},{default:i(()=>[s("div",null,[o(y,{images:t.info.images},null,8,["images"])])]),_:1}),o(I,{xs:24,md:24,lg:14,offset:0},{default:i(()=>[s("div",ve,[s("h4",null,[s("strong",null,_(t.info.title),1)]),ke]),s("div",Ie,[o(z,{title:"",column:1},{default:i(()=>[o(w,{label:"\u4EF7\u683C"},{default:i(()=>{var n,d,h,V;return[$e,s("span",Ve,_(((d=(n=t.info.skuList)==null?void 0:n[t.specSelectedIndex])==null?void 0:d.price)||"--"),1),s("span",Ce,[Se,s("span",xe,_(((V=(h=t.info.skuList)==null?void 0:h[t.specSelectedIndex])==null?void 0:V.stock)||0),1),Le])]}),_:1}),o(w,{label:"\u539F\u4EF7"},{default:i(()=>[s("del",null,"\uFFE5"+_(t.info.originalPrice),1)]),_:1}),o(w,{label:"\u53D1\u8D27"},{default:i(()=>{var n,d;return[p(_(((d=(n=t.info)==null?void 0:n.storeInfo)==null?void 0:d.city)||"--"),1)]}),_:1}),o(w,{label:"\u8FD0\u8D39"},{default:i(()=>[Te]),_:1}),o(w,{label:"\u89C4\u683C"},{default:i(()=>[s("div",Ne,[(v(!0),C(O,null,M(t.info.skuSpec,(n,d)=>(v(),C("div",{key:d,class:"attr-list flex items-center"},[s("div",ze,_(n.title)+":",1),s("div",De,[o(T,{options:n.spec,onCustomClick:h=>t.selectSpec(d,h),modelValue:t.specSelected[d],"onUpdate:modelValue":h=>t.specSelected[d]=h},{default:i(h=>[s("div",Pe,_(h.title),1)]),_:2},1032,["options","onCustomClick","modelValue","onUpdate:modelValue"])])]))),128))])]),_:1}),o(w,{label:"\u6570\u91CF"},{default:i(()=>[o(N,{modelValue:t.amount,"onUpdate:modelValue":r[0]||(r[0]=n=>R(amount)?amount.value=n:null),size:"normal",label:"",min:1,max:1e3,step:1,controls:!0,"controls-position":"both"},null,8,["modelValue"])]),_:1})]),_:1}),s("div",qe,[o(D,{class:"qrcode",style:{opacity:1},value:t.$util.url,options:{width:150,margin:3}},null,8,["value"]),Be])]),s("div",Ee,[s("div",null,[o(a,{class:"m-b",type:"warning",size:"large",disabled:t.specSelectedIndex==="",onClick:t.buy},{default:i(()=>[Fe]),_:1},8,["disabled","onClick"]),t.promoteType>0?(v(),J(a,{key:0,class:"m-b",type:"warning",size:"large",disabled:t.specSelectedIndex==="",onClick:t.buy},{default:i(()=>[je]),_:1},8,["disabled","onClick"])):A("",!0),t.promoteType==0?(v(),J(a,{key:1,class:"m-b",type:"danger",size:"large",disabled:t.specSelectedIndex==="",onClick:t.addCart},{default:i(()=>[Ue]),_:1},8,["disabled","onClick"])):A("",!0)]),s("div",He,[o(a,{link:"",size:"default",onClick:t.toFavorite},{default:i(()=>[Ge]),_:1},8,["onClick"])])])]),_:1})]),_:1}),o(f,{gutter:20},{default:i(()=>[o(I,{xs:24,md:24,lg:18,offset:0},{default:i(()=>[o($,{class:"bg-white min-h-2 p-a",modelValue:t.currentTab,"onUpdate:modelValue":r[1]||(r[1]=n=>R(currentTab)?currentTab.value=n:null),type:"card","tab-position":"top"},{default:i(()=>[o(b,{label:"\u5546\u54C1\u8BE6\u60C5",name:"content"},{default:i(()=>[s("p",{innerHTML:t.info.content},null,8,Me)]),_:1}),o(b,{label:"\u5546\u54C1\u8BC4\u4EF7",name:"comment"},{default:i(()=>[o(ge,{itemId:t.info.id},null,8,["itemId"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(I,{xs:24,md:24,lg:6,offset:0},{default:i(()=>[s("div",Oe,[o(Q,{type:"text",class:"search-input bg-white",placeholder:"\u641C\u7D22\u5E97\u5185\u5546\u54C1",value:""})]),o(B,{class:"m-b",shadow:"never","body-style":{padding:"20px"}},{header:i(()=>[Re]),default:i(()=>{var n,d,h,V;return[s("div",Je,[s("strong",null,[o(q,{to:"/ishop_store/store/info/"+((d=(n=t.info)==null?void 0:n.storeInfo)==null?void 0:d.id)},{default:i(()=>{var E,F;return[p(_((F=(E=t.info)==null?void 0:E.storeInfo)==null?void 0:F.title),1)]}),_:1},8,["to"])])]),s("div",Ae,[s("div",Ke,[Qe,o(W,{disabled:"",value:(V=(h=t.info)==null?void 0:h.storeInfo)==null?void 0:V.rate,"allow-half":!0,"show-score":""},null,8,["value"])])]),We]}),_:1}),o(B,{shadow:"never","body-style":{padding:"20px"}},{header:i(()=>[Xe]),default:i(()=>[(v(!0),C(O,null,M(t.recList,(n,d)=>(v(),C("div",{key:d,class:"hot_item text-center"},[o(q,{class:"flex m-b",to:"ishop/item/info/"+n.id},{default:i(()=>[s("img",{width:"80",src:n.cover,alt:n.title},null,8,Ye),s("div",Ze,[s("p",et,_(n.title),1),s("p",tt," \xA5"+_(n.price),1)])]),_:2},1032,["to"])]))),128))]),_:1})]),_:1})]),_:1})])}}});var at=K(ot,[["__scopeId","data-v-304abbf8"]]);export{at as default};
