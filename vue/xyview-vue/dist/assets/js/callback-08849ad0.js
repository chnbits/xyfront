import{_ as z}from"../index-726dc959.js";const B={data(){return{show:"choose",form:{type:"",code:"",redirect:"",bindType:"",account:"",password:"",verify:"",token:""},rule:{account:[{required:!0,message:"\u8BF7\u586B\u5199\u8D26\u53F7",trigger:"blur"}]}}},created:function(){let l=this.$xyutil.getUrlQuery();this.form.type=this.$route.params.type,this.form.code=l.code,this.form.redirect=window.location.protocol+"//"+window.location.host+"/third_login/user/callback/"+this.form.type,this.handleCallback()},methods:{getVerifyToken(l){this.form.token=l},async handleCallback(){this.loading=!0;let l=this;setTimeout(function(){l.loading=!1},5e3);let e=await this.$util.request({url:"/v1/third_login/user/callback",data:this.form,method:"post"});e.code=="200"?(this.$store.commit("user/setToken",e.data.token),this.$store.commit("user/setUserInfo",e.data.userInfo),this.$util.showToast({title:e.msg,icon:"success",duration:2e3}),this.$xyutil.navigateTo("/")):this.show="choose",this.loading=!1},async handleRegister(){this.loading=!0;let l=this;setTimeout(function(){l.loading=!1},5e3);let e=await this.$util.request({url:"/v1/third_login/user/register",data:this.form,method:"post"});e.code=="200"?(this.$store.commit("user/setToken",e.data.token),this.$store.commit("user/setUserInfo",e.data.userInfo),this.$util.showToast({title:e.msg,icon:"success",duration:2e3}),this.$xyutil.navigateTo("/my")):this.$util.showToast({title:e.msg,icon:"loading",duration:3e3}),this.loading=!1},async handleBind(l){this.form.bindType=l,this.loading=!0;let e=this;setTimeout(function(){e.loading=!1},5e3);let a=await this.$util.request({url:"/v1/third_login/user/bind",data:this.form,method:"post"});a.code=="200"?(this.$store.commit("user/setToken",a.data.token),this.$store.commit("user/setUserInfo",a.data.userInfo),this.$util.showToast({title:a.msg,icon:"success",duration:2e3}),this.$xyutil.navigateTo("/my")):this.$util.showToast({title:a.msg,icon:"loading",duration:3e3}),this.loading=!1}}},r=window.Vue.resolveComponent,o=window.Vue.createVNode,i=window.Vue.createElementVNode,s=window.Vue.withCtx,b=window.Vue.toDisplayString,d=window.Vue.createTextVNode,F=window.Vue.resolveDirective,c=window.Vue.openBlock,y=window.Vue.createElementBlock,E=window.Vue.withDirectives,w=window.Vue.createBlock,x=window.Vue.createCommentVNode,N=window.Vue.pushScopeId,U=window.Vue.popScopeId,h=l=>(N("data-v-4d31db58"),l=l(),U(),l),D={id:"wrap",class:"wrap"},S={class:"main"},q={class:"container",style:{"padding-top":"100px","padding-bottom":"80px"}},$=["src"],P={class:"success-box text-center"},A=h(()=>i("h4",{class:"title"}," \u7528\u6237\u767B\u5F55 ",-1)),R=d(" \u7ED1\u5B9A\u5DF2\u6709\u8D26\u6237 "),j=d(" \u521B\u5EFA\u65B0\u8D26\u6237 "),Q=h(()=>i("div",{class:"bottom flex space-between flex-alignCenter"},null,-1)),G=h(()=>i("div",{class:"title"}," \u7528\u6237\u7ED1\u5B9A\u5E76\u767B\u5F55 ",-1)),H={class:"subtitle"},J=d(" \u8FD8\u6CA1\u6709\u6CE8\u518C\u5417\uFF1F "),K=d(" \u8BF7\u70B9\u51FB\u8FD9\u91CC "),L={class:"flex flex-alignCenter"},M=d(" \u7ED1\u5B9A "),O={class:"actions flex m-t"},W=d(" \u5FD8\u8BB0\u5BC6\u7801\uFF1F "),X=h(()=>i("div",{class:"title"}," \u7528\u6237\u7ED1\u5B9A\u5E76\u767B\u5F55 ",-1)),Y=d(" \u7ED1\u5B9A "),Z={class:"actions flex m-t"},ee=d(" \u5FD8\u8BB0\u5BC6\u7801\uFF1F ");function te(l,e,a,oe,t,u){const k=r("xy-header"),m=r("el-col"),p=r("el-button"),g=r("router-link"),f=r("el-input"),_=r("el-form-item"),V=r("xy-send-verify"),v=r("el-form"),C=r("el-row"),T=r("xy-footer"),I=F("loading");return c(),y("div",D,[o(k),i("div",S,[i("div",q,[o(C,{type:"flex",justify:"space-between",align:"middle"},{default:s(()=>[o(m,{xs:1,sm:1,md:14,lg:14,class:"left-box"},{default:s(()=>[i("img",{src:l.$store.state.app.loginPic,width:"500"},null,8,$)]),_:1}),t.show=="choose"?(c(),w(m,{key:0,xs:22,sm:12,md:10,lg:10,class:"login-box bg-white"},{default:s(()=>[E((c(),y("div",P,[A,i("p",null," \u60A8\u7684"+b(t.form.type)+"\u672A\u7ED1\u5B9A"+b(l.$store.state.app.siteInfo.title)+"\u8D26\u6237\uFF0C\u8BF7\u7ED1\u5B9A\u540E\u5B8C\u6210\u767B\u5F55 ",1),o(p,{class:"full cert",size:"large",type:"primary",onClick:e[0]||(e[0]=n=>{t.show="mobileVerify"})},{default:s(()=>[R]),_:1}),o(p,{class:"full skip",size:"large",onClick:e[1]||(e[1]=n=>u.handleRegister())},{default:s(()=>[j]),_:1})])),[[I,l.loading]]),Q]),_:1})):x("",!0),t.show=="mobileVerify"?(c(),w(m,{key:1,xs:22,sm:12,md:10,lg:10,class:"login-box bg-white"},{default:s(()=>[G,i("div",H,[J,o(g,{to:"/user/register"},{default:s(()=>[K]),_:1})]),o(v,{ref:"form",model:t.form,rules:t.rule},{default:s(()=>[o(_,{prop:"account"},{default:s(()=>[o(f,{size:"large",type:"text",prefix:"ios-person-outline",modelValue:t.form.account,"onUpdate:modelValue":e[2]||(e[2]=n=>t.form.account=n),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u624B\u673A\u53F7\u7801"},null,8,["modelValue"])]),_:1}),i("div",L,[o(_,{prop:"verify",class:"flex-1"},{default:s(()=>[o(f,{size:"large",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:t.form.verify,"onUpdate:modelValue":e[3]||(e[3]=n=>t.form.verify=n),placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"},null,8,["modelValue"])]),_:1}),o(V,{class:"send-verity-button",slot1:"append",onVerifysuccess:u.getVerifyToken,url:"/v1/sms/verify/send",type:"\u624B\u673A\u53F7",account:t.form.account,title:"\u7528\u6237\u767B\u5F55"},null,8,["onVerifysuccess","account"])]),o(p,{class:"full submit-btn",size:"large",loading:t.form.loading,type:"primary",onClick:e[4]||(e[4]=n=>u.handleBind("mobildVerify"))},{default:s(()=>[M]),_:1},8,["loading"]),i("div",O,[i("div",{onClick:e[5]||(e[5]=n=>t.show="password")}," \u4F7F\u7528\u8D26\u53F7\u5BC6\u7801\u7ED1\u5B9A "),i("div",null,[o(g,{to:"/user/resetPassword"},{default:s(()=>[W]),_:1})])])]),_:1},8,["model","rules"]),i("div",{class:"bottom flex space-between flex-alignCenter",onClick:e[6]||(e[6]=n=>{t.show="choose"})})]),_:1})):x("",!0),t.show=="password"?(c(),w(m,{key:2,xs:22,sm:12,md:10,lg:10,class:"login-box bg-white"},{default:s(()=>[X,o(v,{ref:"form",model:t.form,rules:t.rule},{default:s(()=>[o(_,{prop:"account"},{default:s(()=>[o(f,{size:"large",type:"text",prefix:"ios-person-outline",modelValue:t.form.account,"onUpdate:modelValue":e[7]||(e[7]=n=>t.form.account=n),placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\u5730\u5740\u6216\u624B\u673A\u53F7\u7801"},null,8,["modelValue"])]),_:1}),o(_,{prop:"password"},{default:s(()=>[o(f,{size:"large",type:"password",prefix:"ios-lock-outline",modelValue:t.form.password,"onUpdate:modelValue":e[8]||(e[8]=n=>t.form.password=n),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),o(p,{class:"full submit-btn",size:"large",loading:t.form.loading,type:"primary",onClick:e[9]||(e[9]=n=>u.handleBind("password"))},{default:s(()=>[Y]),_:1},8,["loading"]),i("div",Z,[i("div",{onClick:e[10]||(e[10]=n=>t.show="mobileVerify")}," \u4F7F\u7528\u624B\u673A\u9A8C\u8BC1\u7801\u7ED1\u5B9A "),i("div",null,[o(g,{to:"/reg_mobile/user/resetPassword"},{default:s(()=>[ee]),_:1})])])]),_:1},8,["model","rules"]),i("div",{class:"bottom flex space-between flex-alignCenter",onClick:e[11]||(e[11]=n=>{t.show="choose"})})]),_:1})):x("",!0)]),_:1})])]),o(T)])}var ie=z(B,[["render",te],["__scopeId","data-v-4d31db58"]]);export{ie as default};
