import{x as N}from"./xy-builder-form-25221289.js";import{c as F}from"./lists-155236f6.js";import{_ as z}from"../index-726dc959.js";import"./index-7b0b7a1f.js";const B={components:{xyBuilderForm:N,commentLists:F},data(){return{id:0,info:{title:"",content:""},item:{pageData:{show:!1}},loading:!1,showReplyForm:!1,tradeNo:"",form:{payType:"wxpay"}}},mounted:function(){this.id=this.$route.params.id,this.loadData()},watch:{$route(o,t){this.id=this.$route.params.id,this.loadData()}},methods:{async down(){var t,m,c;this.loading=!0;let o=await this.$util.request({url:"/v1/ext/addon/download/"+this.id,data:{},method:"post"});if(o.code==200)if((t=o.data)!=null&&t.url)this.loading=!1,window.open((m=o.data)==null?void 0:m.url);else if((c=o.data)!=null&&c.needBuy){let e=await this.$util.request({url:"/v1/order/order/submit",data:{oneOrder:1,orderInfo:[{spuId:this.id,skuId:0,amount:1,extra:{}}],extra:{module:"ext",service:"Order",payType:this.form.payType,payPlatform:"pc"}},method:"post"});if(e.code==200)this.tradeNo=e.data.tradeNo,this.orderSets=e.data.orderSets,e.data.paySuccess?(this.$util.showToast({title:"\u652F\u4ED8\u6210\u529F",icon:"success",duration:2e3}),this.$router.push({path:"/ext/order/my"})):e.data.isRedirect?window.open(e.data.payString,"_blank"):window.open("/pay/order/qrpay?realMoney="+this.info.price+"&payType="+this.form.payType+"&tradeNo="+this.tradeNo+"&payString="+e.data.payString,"_blank");else{this.loading=!1,alert(e.msg);return}}else this.loading=!1,alert("\u51FA\u9519");else this.loading=!1,alert(o.msg)},closeModel(o,t){this.item.pageData.show=!1,t&&this.loadData()},async actionClick(o,t,m){let c=await this.$util.request({url:"/v1/action/action/set",data:{dataId:o,dataModel:t,actionType:m},method:"post"});c.code==200?this.$util.showToast({title:c.msg,icon:"success",duration:2e3}):this.$util.showToast({title:c.msg,icon:"loading",duration:3e3})},async loadData(){this.loading=!0;let o=await this.$util.request({url:"/v1/ext/addon/info/"+this.id,data:{},method:"get"});o.code==200?this.info=o.data.info:this.$util.showToast({title:o.msg,icon:"loading",duration:3e3}),this.loading=!1}}},l=window.Vue.resolveComponent,i=window.Vue.createVNode,s=window.Vue.createElementVNode,R=window.Vue.normalizeStyle,a=window.Vue.withCtx,p=window.Vue.toDisplayString,_=window.Vue.createTextVNode,d=window.Vue.openBlock,r=window.Vue.createElementBlock,y=window.Vue.createCommentVNode,L=window.Vue.renderList,M=window.Vue.Fragment,q=window.Vue.resolveDirective,E=window.Vue.withDirectives,O=window.Vue.pushScopeId,U=window.Vue.popScopeId,f=o=>(O("data-v-546287e5"),o=o(),U(),o),j={class:"wrap"},H={class:"main p-t"},P={class:"container","element-loading-text":"\u62FC\u547D\u52A0\u8F7D\u4E2D"},A=["innerHTML"],G={class:"flex space-between flex-alignCenter m-b-sm"},J={class:"title ts-28"},K={class:"ts-16"},Q=f(()=>s("i",{class:"xyicon xyicon-zan ts-14"},null,-1)),W=_(" \u70B9\u8D5E "),X=f(()=>s("i",{class:"xyicon xyicon-heart ts-14"},null,-1)),Y=_(" \u6536\u85CF "),Z={class:"m-b-sm ts-14"},$={class:"m-b-sm"},ee={key:0,class:"subtitle text-error ts-14"},te={key:1,class:"subtitle text-success ts-14"},oe={class:"m-b"},se=_(" \u4E0B\u8F7D "),ie={key:0,class:"text-error ts-13"},ne={slot:"header",class:"flex space-between ts-16"},le=f(()=>s("div",null,[s("span",{class:"tw6 ts-18"},"\u4ECB\u7ECD")],-1)),ae={class:"m-b"},de=_("\u7248\u672C\u5217\u8868"),re={class:"m-t-sm"};function ce(o,t,m,c,e,u){const x=l("xy-header"),w=l("el-col"),h=l("el-button"),g=l("el-row"),v=l("xy-title"),b=l("xy-mavon-editor"),k=l("el-card"),V=l("comment-lists"),C=l("xy-builder-form"),S=l("el-dialog"),D=l("xy-footer"),T=q("loading");return d(),r("div",j,[i(x),s("div",H,[E((d(),r("div",P,[i(g,{class:"flex flex-wrap m-b-sm",type:"flex",gutter:25},{default:a(()=>[i(w,{xs:24,md:8,lg:6},{default:a(()=>[s("div",{class:"image cursor-pointer m-r",style:R({background:e.info.bgColor})},[s("div",{class:"icon",innerHTML:e.info.iconSvg},null,8,A)],4)]),_:1}),i(w,{xs:24,md:16,lg:18},{default:a(()=>[s("div",G,[s("h1",J,p(e.info.title),1),s("div",K,[i(h,{type:"default",size:"small",plain:"",onClick:t[0]||(t[0]=n=>u.actionClick(e.id,"ext_addon",1))},{default:a(()=>[Q,W]),_:1}),i(h,{type:"default",size:"small",plain:"",onClick:t[1]||(t[1]=n=>u.actionClick(e.id,"ext_addon",2))},{default:a(()=>[X,Y]),_:1})])]),s("div",Z,"\u66F4\u65B0\u65E5\u671F\uFF1A"+p(o.$util.timeFormat(e.info.updateTime)),1),s("div",$,[e.info.price!="0.00"?(d(),r("div",ee,"\uFFE5"+p(e.info.price),1)):(d(),r("div",te,"\u514D\u8D39"))]),s("div",oe,[i(h,{type:"primary",size:"small",onClick:u.down},{default:a(()=>[se]),_:1},8,["onClick"])]),e.info.collecting?(d(),r("div",ie," \u672C\u63D2\u4EF6\u5F81\u96C6\u5F00\u53D1\u8005\u4E2D\uFF0C\u83B7\u5F97\u901A\u8FC7\u7684\u5F00\u53D1\u8005\u5C06\u62E5\u6709\u63D2\u4EF6\u4F18\u5148\u5C55\u793A\u7684\u6743\u529B\uFF0C\u8BE6\u60C5\u8BF7\u52A0\u4EA4\u6D41\u7FA4\u3002 ")):y("",!0)]),_:1})]),_:1}),i(k,{shadow:"none",style:{"min-height":"400px"}},{default:a(()=>[s("div",ne,[le,s("div",null,[e.info.uid==o.$store.state.user.userInfo.id?(d(),r("span",{key:0,class:"cursor-pointer ts-14",onClick:t[2]||(t[2]=n=>{e.item.pageData.show=!0})},"\u4FEE\u6539")):y("",!0)])]),s("div",ae,[i(v,{class:"m-b-xs"},{default:a(()=>[de]),_:1}),s("ul",null,[(d(!0),r(M,null,L(e.info.versionList,(n,I)=>(d(),r("li",{key:I},p(n.version)+" - "+p(o.$util.timeFormat(n.updateTime)),1))),128))])]),i(b,{defaultOpen:"preview",codeStyle:"solarized-dark",previewBackground:"#fff",navigation:!1,editable:!1,subfield:!1,border:!1,ishljs:!1,toolbarsFlag:!1,modelValue:e.info.content,"onUpdate:modelValue":t[3]||(t[3]=n=>e.info.content=n)},null,8,["modelValue"])]),_:1}),s("div",re,[i(V,{title:"\u56DE\u590D",urlPrefix:"/ext",showReplyForm:e.showReplyForm,"onUpdate:showReplyForm":t[4]||(t[4]=n=>e.showReplyForm=n),dataId:e.id,dataModel:"ext_addon"},null,8,["showReplyForm","dataId"])])])),[[T,e.loading]])]),i(S,{class:"ts-16",title:"\u4FEE\u6539\u63D2\u4EF6",visible:e.item.pageData.show,"onUpdate:visible":t[6]||(t[6]=n=>e.item.pageData.show=n),width:"70%"},{default:a(()=>[i(C,{api:"/v1/ext/addon/edit/"+this.id,show:e.item.pageData.show,pitem:e.item,onClose:t[5]||(t[5]=n=>u.closeModel(e.item,n))},null,8,["api","show","pitem"])]),_:1},8,["visible"]),i(D)])}var he=z(B,[["render",ce],["__scopeId","data-v-546287e5"]]);export{he as default};
