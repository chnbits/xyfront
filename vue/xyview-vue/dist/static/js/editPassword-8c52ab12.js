import{_ as e}from"../../index.js";const t={components:{},data(){var e,t;return{active:1,loading:!1,form:{countryCode:null==(e=this.$store.state.user.userInfo.mobile)?void 0:e.identityGroup,mobile:null==(t=this.$store.state.user.userInfo.mobile)?void 0:t.identifier,verify:"",token:"",newPassword:"",rePassword:""},rule:{mobile:[{required:!0,message:"请填写手机号",trigger:"blur"}],newPassword:[{required:!0,message:"请填写新密码",trigger:"blur"},{type:"string",min:6,message:"密码至少6位",trigger:"blur"}],rePassword:[{required:!0,message:"请填写新密码",trigger:"blur"},{type:"string",min:6,message:"密码至少6位",trigger:"blur"}],verify:[{required:!0,message:"请填写验证码",trigger:"blur"}],token:[{required:!0,message:"请发送验证码",trigger:"blur"}]}}},created:function(){var e;(null==(e=this.$store.state.user.userInfo.mobile)?void 0:e.identifier)||this.$util.showToast({title:"未绑定手机",icon:"loading",duration:3e3})},methods:{goStep2(){this.form.mobile&&this.form.verify&&this.form.token?this.active++:this.$util.showToast({title:"验证失败",icon:"loading",duration:3e3})},onCountrySelect({name:e,iso2:t,dialCode:l}){this.form.countryCode="+"+l},getVerifyToken(e){this.form.token=e},handleSubmit(){return e=this,t=null,l=function*(){this.loading=!0;let e=this;setTimeout((function(){e.loading=!1}),5e3);let t=yield this.$util.request({url:"/v1/reg_mobile/user/restPassword",data:this.form,method:"put"});"200"==t.code?(this.$util.showToast({title:t.msg,icon:"success",duration:2e3}),this.active++):this.$util.showToast({title:t.msg,icon:"loading",duration:3e3}),this.loading=!1},new Promise(((o,i)=>{var r=e=>{try{a(l.next(e))}catch(t){i(t)}},s=e=>{try{a(l.throw(e))}catch(t){i(t)}},a=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,s);a((l=l.apply(e,t)).next())}));var e,t,l}}},l=window.Vue.createTextVNode,o=window.Vue.resolveComponent,i=window.Vue.withCtx,r=window.Vue.createVNode,s=window.Vue.createElementVNode,a=window.Vue.openBlock,d=window.Vue.createBlock,n=window.Vue.createCommentVNode,u=window.Vue.createElementBlock,c=window.Vue.pushScopeId,m=window.Vue.popScopeId,f=e=>(c("data-v-19df7724"),e=e(),m(),e),p={class:"box"},y={class:"p-t"},w={class:"content p-t-md"},b={class:"step-tabs"},g=f((()=>s("div",{class:"m-b-md ts-12 tw4",style:{color:"#2A2B2E"}},"为确认您本人操作，需要您进行手机验证码验证身份。",-1))),v={class:"flex"},h={class:"m-t-lg"},V=f((()=>s("div",{class:"m-b-md ts-18 tw4"},"请输入您的登录密码",-1))),k={class:"m-t-lg"},x={key:2},_=f((()=>s("div",null,[s("i",{class:"xyicon xyicon-check3 ts-30 m-r-sm",style:{color:"#4AC711"}}),s("span",{class:"ts-20 tw4",style:{color:"#2A2B2E"}},"修改登录密码成功，请您牢记密码。")],-1))),C={class:"m-t-lg"},P=f((()=>s("span",{slot:"title",class:"ts-14"},[s("i",{class:"xyicon xyicon-help-o m-r-xs text-primary"}),s("span",null,"收不到短信验证码？")],-1))),S=f((()=>s("div",{class:"lh-2 ts-12 p-l"},[l(" 1、网络通讯异常可能会造成短信丢失，请重新获取或稍后再试。"),s("br"),l(" 2、请核实手机是否已欠费停机，或者屏蔽了系统短信。"),s("br"),l(" 3、如果手机已丢失或停用， 请选择其他验证方式 。"),s("br"),l(" 4、您也可以尝试将SIM卡移动到另一部手机，然后重试。"),s("br")],-1)));const $=e(t,[["render",function(e,t,c,m,f,$){const z=o("el-breadcrumb-item"),T=o("el-breadcrumb"),I=o("el-step"),q=o("el-steps"),B=o("xy-country-select"),N=o("el-input"),E=o("el-form-item"),U=o("xy-send-verify"),A=o("el-button"),O=o("el-link"),j=o("el-form"),G=o("router-link"),M=o("el-alert");return a(),u("div",null,[s("div",p,[s("div",y,[r(T,{"separator-class":"el-icon-arrow-right",class:"p-l m-b"},{default:i((()=>[r(z,{to:{path:"/user/center"}},{default:i((()=>[l("个人设置")])),_:1}),r(z,null,{default:i((()=>[l("修改密码")])),_:1})])),_:1})]),s("div",w,[r(q,{active:f.active,simple:"","align-left":""},{default:i((()=>[r(I,{title:"验证手机号",description:""}),r(I,{title:"输入新密码",description:""}),r(I,{title:"修改成功",description:""})])),_:1},8,["active"]),s("div",b,[1==f.active?(a(),d(j,{key:0,ref:"form","label-position":"left","label-width":"140px",model:f.form,rules:f.rule},{default:i((()=>[g,r(E,{prop:"mobile",label:"手机号"},{default:i((()=>[r(N,{disabled:"",size:"default",type:"text",prefix:"ios-at-outline",modelValue:f.form.mobile,"onUpdate:modelValue":t[0]||(t[0]=e=>f.form.mobile=e),placeholder:f.form.mobile?"手机号":"未绑定手机号"},{prepend:i((()=>[r(B,{defaultCountry:"CN",enabledCountryCode:"",onOnSelect:$.onCountrySelect},null,8,["onOnSelect"])])),_:1},8,["modelValue","placeholder"])])),_:1}),r(E,{prop:"verify",label:"验证码"},{default:i((()=>[s("div",v,[r(N,{class:"m-r",size:"default",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:f.form.verify,"onUpdate:modelValue":t[1]||(t[1]=e=>f.form.verify=e),placeholder:"请输入手机验证码"},null,8,["modelValue"]),r(A,{type:"primary",size:"default"},{default:i((()=>[r(U,{onVerifysuccess:$.getVerifyToken,url:"/v1/sms/verify/send",type:"手机号",account:f.form.mobile,title:"修改密码"},null,8,["onVerifysuccess","account"])])),_:1})])])),_:1}),s("div",h,[r(A,{class:"submit-btn primary-linear m-r",size:"default",loading:f.loading,type:"primary",onClick:$.goStep2},{default:i((()=>[l(" 下一步 ")])),_:1},8,["loading","onClick"]),r(O,{class:"back ts-14",onClick:t[2]||(t[2]=t=>e.$router.back())},{default:i((()=>[l("取消操作")])),_:1})])])),_:1},8,["model","rules"])):n("",!0),2==f.active?(a(),d(j,{key:1,ref:"formVerifyPassword","label-position":"left","label-width":"140px",model:f.form,rules:f.rule},{default:i((()=>[V,r(E,{prop:"newPassword",label:"输入新的密码"},{default:i((()=>[r(N,{size:"default",type:"password",prefix:"ios-lock-outline",modelValue:f.form.newPassword,"onUpdate:modelValue":t[3]||(t[3]=e=>f.form.newPassword=e),placeholder:"输入新的密码"},null,8,["modelValue"])])),_:1}),r(E,{prop:"rePassword",label:"再次输入"},{default:i((()=>[r(N,{size:"default",type:"password",prefix:"ios-lock-outline",modelValue:f.form.rePassword,"onUpdate:modelValue":t[4]||(t[4]=e=>f.form.rePassword=e),placeholder:"再次输入"},null,8,["modelValue"])])),_:1}),s("div",k,[r(A,{class:"submit-btn primary-linear m-r",size:"default",loading:f.loading,type:"primary",onClick:t[5]||(t[5]=e=>$.handleSubmit("form"))},{default:i((()=>[l(" 下一步 ")])),_:1},8,["loading"]),r(O,{class:"back ts-14",onClick:t[6]||(t[6]=e=>f.active--)},{default:i((()=>[l("返回上一步")])),_:1})])])),_:1},8,["model","rules"])):n("",!0),3==f.active?(a(),u("div",x,[_,s("div",C,[r(G,{to:"/user/login"},{default:i((()=>[r(A,{class:"primary-linear",size:"small",type:"primary",round:""},{default:i((()=>[l("重新登录")])),_:1})])),_:1})])])):n("",!0)])])]),s("div",null,[r(M,{type:"primary"},{default:i((()=>[P,S])),_:1})])])}],["__scopeId","data-v-19df7724"]]);export{$ as default};
