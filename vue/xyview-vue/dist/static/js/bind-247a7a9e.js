var e=(e,l,t)=>new Promise(((o,i)=>{var a=e=>{try{r(t.next(e))}catch(l){i(l)}},s=e=>{try{r(t.throw(e))}catch(l){i(l)}},r=e=>e.done?o(e.value):Promise.resolve(e.value).then(a,s);r((t=t.apply(e,l)).next())}));import{_ as l,v as t}from"../../index.js";const o={mixins:[t],components:{},data:()=>({active:1,verifyList:[],loading:!1,form:{countryCode:"+86",mobile:"",password:"",verify:"",token:"",email:"",emailVerify:"",emailToken:"",gauth:""},rule:{mobile:[{required:!0,message:"请填写手机号",trigger:"blur"}],verify:[{required:!0,message:"请填写验证码",trigger:"blur"}],token:[{required:!0,message:"请发送验证码",trigger:"blur"}]}}),created:function(){this.loadData()},methods:{verifyPassword(){return e(this,null,(function*(){"200"==(yield this.doVerifyPassword()).code&&this.active++}))},onCountrySelect({name:e,iso2:l,dialCode:t}){this.form.countryCode="+"+t},getVerifyToken(e){this.form.token=e.token},getEmailVerifyToken(){this.form.emailToken=res.token},loadData(){return e(this,null,(function*(){let e=yield this.$util.request({url:"/v1/reg_mobile/user/bind",method:"get"});"200"==e.code?this.verifyList=e.data.dataList:this.$util.showToast({title:e.msg,icon:"loading",duration:3e3})}))},handleSubmit(){return e(this,null,(function*(){this.loading=!0;let e=this;setTimeout((function(){e.loading=!1}),5e3);let l=yield this.$util.request({url:"/v1/reg_mobile/user/bind",data:this.form,method:"post"});"200"==l.code?(this.$util.showToast({title:l.msg,icon:"success",duration:2e3}),this.active++):this.$util.showToast({title:l.msg,icon:"loading",duration:3e3}),this.loading=!1}))}}},i=window.Vue.createTextVNode,a=window.Vue.resolveComponent,s=window.Vue.withCtx,r=window.Vue.createVNode,d=window.Vue.createElementVNode,n=window.Vue.openBlock,u=window.Vue.createBlock,c=window.Vue.createCommentVNode,m=window.Vue.createElementBlock,f=window.Vue.pushScopeId,p=window.Vue.popScopeId,y=e=>(f("data-v-992b72dc"),e=e(),p(),e),h={class:"box"},v={class:"p-t"},w={class:"content p-t"},V={class:"step-tabs text-left"},b=y((()=>d("div",{class:"m-b-md ts-18 tw4"},"为确认是你本人操作",-1))),g={class:"m-t-lg"},k={class:"flex"},x={class:"m-t-lg"},_={key:2},C=y((()=>d("div",null,[d("i",{class:"xyicon xyicon-check3 ts-30 m-r-sm",style:{color:"#4AC711"}}),d("span",{class:"ts-20 tw4",style:{color:"#2A2B2E"}},"绑定手机号成功。")],-1))),T={class:"m-t-lg"},z=y((()=>d("span",{slot:"title",class:"ts-14"},[d("i",{class:"xyicon xyicon-help-o m-r-xs text-primary"}),d("span",null,"没收到短信验证码？")],-1))),S=y((()=>d("div",{class:"lh-2 ts-12"},[i(" 1、网络通讯异常可能会造成短信丢失，请重新获取或稍后再试。"),d("br"),i(" 2、请核实手机是否已欠费停机，或者屏蔽了系统短信。"),d("br"),i(" 3、如果手机已丢失或停用， 请选择其他验证方式 。"),d("br"),i(" 4、您也可以尝试将SIM卡移动到另一部手机，然后重试。"),d("br")],-1)));const L=l(o,[["render",function(e,l,t,o,f,p){const y=a("el-breadcrumb-item"),L=a("el-breadcrumb"),N=a("el-step"),P=a("el-steps"),U=a("el-input"),$=a("el-form-item"),q=a("el-button"),E=a("el-link"),O=a("el-form"),B=a("xy-country-select"),I=a("xy-send-verify"),A=a("router-link"),D=a("el-alert");return n(),m("div",null,[d("div",h,[d("div",v,[r(L,{"separator-class":"el-icon-arrow-right",class:"p-l m-b"},{default:s((()=>[r(y,{to:{path:"/user/center"}},{default:s((()=>[i("个人设置")])),_:1}),r(y,null,{default:s((()=>[i("绑定手机号")])),_:1})])),_:1})]),d("div",w,[r(P,{active:f.active,simple:"","align-left":""},{default:s((()=>[r(N,{title:"验证登录密码",description:""}),r(N,{title:"验证新手机",description:""}),r(N,{title:"绑定成功",description:""})])),_:1},8,["active"]),d("div",V,[1==f.active?(n(),u(O,{key:0,ref:"formVerifyPassword","label-position":"left","label-width":"0px"},{default:s((()=>[b,r($,{prop:"password"},{default:s((()=>[r(U,{size:"default",type:"password",prefix:"ios-lock-outline",modelValue:e.password,"onUpdate:modelValue":l[0]||(l[0]=l=>e.password=l),placeholder:"请输入登录密码"},null,8,["modelValue"])])),_:1}),d("div",g,[r(q,{class:"submit-btn primary-linear m-r",size:"default",loading:f.loading,type:"primary",onClick:p.verifyPassword},{default:s((()=>[i(" 下一步 ")])),_:1},8,["loading","onClick"]),r(E,{class:"back ts-14",onClick:l[1]||(l[1]=l=>e.$router.back())},{default:s((()=>[i("取消绑定")])),_:1})])])),_:1},512)):c("",!0),2==f.active?(n(),u(O,{key:1,ref:"form","label-position":"left","label-width":"140px",model:f.form,rules:f.rule},{default:s((()=>[r($,{prop:"mobile",label:"请输入手机号"},{default:s((()=>[r(U,{size:"default",type:"text",prefix:"ios-at-outline",modelValue:f.form.mobile,"onUpdate:modelValue":l[2]||(l[2]=e=>f.form.mobile=e),placeholder:"请输入手机号"},{prepend:s((()=>[r(B,{defaultCountry:"CN",enabledCountryCode:"",onOnSelect:p.onCountrySelect},null,8,["onOnSelect"])])),_:1},8,["modelValue"])])),_:1}),r($,{prop:"verify",label:"验证码"},{default:s((()=>[d("div",k,[r(U,{class:"m-r",size:"default",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:f.form.verify,"onUpdate:modelValue":l[3]||(l[3]=e=>f.form.verify=e),placeholder:"请输入手机验证码"},null,8,["modelValue"]),r(q,{type:"primary",size:"default"},{default:s((()=>[r(I,{onVerifysuccess:p.getVerifyToken,url:"/v1/sms/verify/send",type:"手机号",account:f.form.mobile,title:"手机绑定"},null,8,["onVerifysuccess","account"])])),_:1})])])),_:1}),f.verifyList.indexOf("email")>=0?(n(),u($,{key:0,prop:"emailVerify"},{default:s((()=>[r(U,{size:"default",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:f.form.emailVerify,"onUpdate:modelValue":l[4]||(l[4]=e=>f.form.emailVerify=e),placeholder:"请输入邮箱验证码"},{append:s((()=>[r(I,{onVerifysuccess:p.getEmailVerifyToken,url:"/v1/email/verify/send",type:"邮箱",noNeedAccount:!0,title:"手机绑定"},null,8,["onVerifysuccess"])])),_:1},8,["modelValue"])])),_:1})):c("",!0),f.verifyList.indexOf("gauth")>=0?(n(),u($,{key:1,prop:"gauth"},{default:s((()=>[r(U,{size:"large",type:"password",prefix:"ios-lock-outline",modelValue:f.form.gauth,"onUpdate:modelValue":l[5]||(l[5]=e=>f.form.gauth=e),placeholder:"请输入谷歌验证码"},null,8,["modelValue"])])),_:1})):c("",!0),f.verifyList.indexOf("password")>=0?(n(),u($,{key:2,prop:"password"},{default:s((()=>[r(U,{size:"default",type:"password",prefix:"ios-lock-outline",modelValue:f.form.password,"onUpdate:modelValue":l[6]||(l[6]=e=>f.form.password=e),placeholder:"请输入登录密码"},null,8,["modelValue"])])),_:1})):c("",!0),d("div",x,[r(q,{class:"submit-btn primary-linear m-r",size:"default",loading:f.loading,type:"primary",onClick:l[7]||(l[7]=e=>p.handleSubmit("form"))},{default:s((()=>[i(" 确定 ")])),_:1},8,["loading"]),r(E,{class:"back ts-14",onClick:l[8]||(l[8]=e=>f.active--)},{default:s((()=>[i("返回上一步")])),_:1})])])),_:1},8,["model","rules"])):c("",!0),3==f.active?(n(),m("div",_,[C,d("div",T,[r(A,{to:"/user/login"},{default:s((()=>[r(q,{class:"primary-linear",size:"small",type:"primary",round:""},{default:s((()=>[i("重新登录")])),_:1})])),_:1})])])):c("",!0)])]),r(D,{class:"p-l-md p-b",type:"primary"},{default:s((()=>[z,S])),_:1})])])}],["__scopeId","data-v-992b72dc"]]);export{L as default};
