var e=(e,t,s)=>new Promise(((i,a)=>{var l=e=>{try{r(s.next(e))}catch(t){a(t)}},o=e=>{try{r(s.throw(e))}catch(t){a(t)}},r=e=>e.done?i(e.value):Promise.resolve(e.value).then(l,o);r((s=s.apply(e,t)).next())}));import{_ as t,b as s}from"../../index.js";import{c as i}from"./lists-63b7875b.js";const a=window.Vue.defineAsyncComponent;window.Vue.nextTick;const l={components:{"xy-video-play":a((()=>new Promise(((e,t)=>{s((()=>import("./index.es-f536119f.js")),[]).then((t=>{e(t.videoPlay)}))})))),"comment-lists":i},data(){return{id:0,info:{title:""},activeTab:"chapters",chapterList:[],recommendList:[],chapterIndex:-1,loading:!1,showReplyForm:!0,loadedScript:!1,courseType:"video",defaultVideo:"",playerOptions:{width:"100%",height:"500px",color:"#409eff",title:"",src:this.defaultVideo,poster:"",muted:!1,webFullScreen:!1,speedRate:["0.75","1.0","1.25","1.5","2.0"],autoPlay:!1,loop:!1,mirror:!1,ligthOff:!1,volume:.8,control:!0,controlBtns:["audioTrack","quality","speedRate","volume","setting","pip","pageFullScreen","fullScreen"]},fileUrl:"",pageNum:1,pageTotalNum:1,loadedRatio:0}},computed:{player(){var e,t;return null==(t=null==(e=this.$refs)?void 0:e.videoPlayer)?void 0:t.player}},created(){return e(this,null,(function*(){this.id=this.$route.params.id,this.loadData(),this.$route.query.chapter>=0&&(this.chapterIndex=this.$route.query.chapter),yield this.loadScript(),this.loadedScript=!0}))},watch:{chapterIndex(e){this.updateChapter()},$route(e,t){this.id=this.$route.params.id,this.courseType,this.loadData(),this.$route.query.chapter>=0&&(this.chapterIndex=this.$route.query.chapter)}},methods:{loadScript:()=>new Promise(((e,t)=>{e()})),prePage(){let e=this.pageNum;e=e>1?e-1:this.pageTotalNum,this.pageNum=e},nextPage(){let e=this.pageNum;e=e<this.pageTotalNum?e+1:1,this.pageNum=e},updateChapter(){var e,t;if(this.chapterIndex>=0&&this.chapterList.length>0){if(this.chapterList[this.chapterIndex].playFile.length>0){let e=this.chapterList[this.chapterIndex].playFile[0].url;var s=e.lastIndexOf(".");switch(e.substring(s+1)){case"mp4":this.courseType="video",this.playerOptions.src=e,this.playerOptions.title=this.chapterList[this.chapterIndex].title,this.playerOptions.poster=this.chapterList[this.chapterIndex].cover,this.loadChapter(this.chapterList[this.chapterIndex].id);break;case"pdf":this.courseType="pdf",this.fileUrl=e;break;case"pptx":case"docx":case"xlsx":case"ppt":case"doc":case"xls":this.courseType="office",this.fileUrl=e;break;default:alert("暂不支持的格式")}}else this.courseType="video",this.playerOptions.poster="",this.playerOptions.src=this.defaultVideo;null==(t=null==(e=this.chapterList[this.chapterIndex])?void 0:e.files)||t.length}else this.courseType="video",this.playerOptions.poster=this.defaultPoster,this.playerOptions.src=""},loadData(){return e(this,null,(function*(){this.loading=!0;let e=yield this.$xyutil.request({url:"/v1/course/item/info/"+this.id,data:{recommend:1},method:"get"});200==e.code?(this.info=e.data.info,this.chapterList=e.data.chapterList,this.recommendList=e.data.recommendList,this.chapterList.length>0&&!(this.$route.query.chapter>=0)?this.chapterIndex=0:this.chapterIndex=this.$route.query.chapter,this.updateChapter()):this.$xyutil.showToast({title:e.msg,icon:"loading",duration:3e3}),this.loading=!1}))},loadChapter(t){return e(this,null,(function*(){let e=yield this.$xyutil.request({url:"/v1/course/chapter/info/"+t,method:"get"});200==e.code||this.$xyutil.showToast({title:e.msg,icon:"loading",duration:3e3})}))}}},o=window.Vue.createTextVNode,r=window.Vue.resolveComponent,d=window.Vue.withCtx,c=window.Vue.createVNode,n=window.Vue.toDisplayString,p=window.Vue.createElementVNode,h=window.Vue.mergeProps,u=window.Vue.openBlock,m=window.Vue.createBlock,f=window.Vue.createCommentVNode,y=window.Vue.createElementBlock,x=window.Vue.renderList,v=window.Vue.Fragment,w=window.Vue.pushScopeId,g=window.Vue.popScopeId,b=e=>(w("data-v-08487df5"),e=e(),g(),e),_={class:"main-banner"},I={class:"container"},V=b((()=>p("div",{class:"course-title m-b-sm"},null,-1))),L={class:"player-wrap m-b"},T={key:1,class:"pdf-box"},k=["src"],F={class:"player-bottom flex space-between p-l p-r p-b-sm"},$={class:"text-left"},P=["href"],S=b((()=>p("i",{class:"xyicon xyicon-download1"},null,-1))),C={key:0,class:"text-left"},N={class:"ts-14"},O={class:"right-col p-t text-left p-l"},R={class:"chapter-list flex m-b-sm cursor-pointer"},q=b((()=>p("div",null,null,-1))),U={class:"flex-1 m-l-sm"},D={class:"flex space-between"},j={class:"title ts-16",style:{color:"#b4b4b4","line-height":"16px","font-size":"16px !important"}},B=b((()=>p("div",null,[p("i",{class:"xyicon xyicon-right2 text-gray"})],-1))),E={class:"m-t-sm ts-12 text-666"},z={class:"container p-t"},A=b((()=>p("div",{class:"tw4 m-b ts-32 m-t text-center"}," 推荐课程 Hot ",-1))),H=b((()=>p("div",{class:"text-center ts-16",style:{color:"#51656F","margin-bottom":"104px"}}," 优质受欢迎的课程助您更好与运营 ",-1))),M={class:"cate-item"},G={class:"cate-item"},J=["src"],K={class:"bottom hidden"},Q={class:"p-a"},W={class:"ts-20 m-b"},X={class:"m-b-md ts-16",style:{color:"#51656F"}},Y={class:"flex space-between items-end"},Z={class:"ts-14",style:{color:"#51656F"}};const ee=t(l,[["render",function(e,t,s,i,a,l){const w=r("el-breadcrumb-item"),g=r("el-breadcrumb"),b=r("xy-video-play"),ee=r("vue-pdf-app"),te=r("el-col"),se=r("router-link"),ie=r("el-tab-pane"),ae=r("comment-lists"),le=r("el-tabs"),oe=r("el-row"),re=r("el-button"),de=r("el-empty");return u(),y("div",null,[p("div",_,[p("div",I,[c(g,{separator:"/"},{default:d((()=>[c(w,{to:{path:"/"}},{default:d((()=>[o("首页")])),_:1}),c(w,null,{default:d((()=>[o(n(a.info.title),1)])),_:1}),c(w,null,{default:d((()=>[o(n(a.chapterList[a.chapterIndex]?a.chapterList[a.chapterIndex].title:""),1)])),_:1})])),_:1}),V,c(oe,{gutter:40,class:"course-content"},{default:d((()=>[c(te,{xs:24,sm:24,md:17,lg:16,offset:0},{default:d((()=>[p("div",L,[a.loadedScript&&"video"==a.courseType?(u(),m(b,h({key:0,class:"vjs-custom-skin"},a.playerOptions,{ref:"videoPlayer"}),null,16)):"pdf"==a.courseType?(u(),y("div",T,[c(ee,{style:{height:"1000px"},pdf:a.fileUrl},null,8,["pdf"])])):"office"==a.courseType?(u(),y("iframe",{key:2,width:"100%",height:"1000px",src:"https://view.officeapps.live.com/op/view.aspx?src="+a.fileUrl},"\n                            ",8,k)):f("",!0)]),p("div",F,[p("div",$,[a.chapterIndex>=0&&a.chapterList[a.chapterIndex]?(u(),y("a",{key:0,class:"ts-13",target:"_blank",href:e.$xyutil.config.baseDomain()+"/api/v1/course/chapter/download/"+a.chapterList[a.chapterIndex].id,rel:"noopener noreferrer"},[S,o(" 下载 ")],8,P)):f("",!0)]),a.chapterList[a.chapterIndex]?(u(),y("div",C,[p("span",N,n(a.chapterIndex>=0?a.chapterList[a.chapterIndex].viewCountShow:0)+"次播放 ",1)])):f("",!0)])])),_:1}),c(te,{xs:24,sm:24,md:7,lg:8,offset:0},{default:d((()=>[p("div",O,[c(le,{modelValue:a.activeTab,"onUpdate:modelValue":t[1]||(t[1]=e=>a.activeTab=e),"tab-position":"top"},{default:d((()=>[c(ie,{label:"章节("+a.chapterList.length+")",name:"chapters"},{default:d((()=>[(u(!0),y(v,null,x(a.chapterList,((e,t)=>(u(),m(se,{to:"/course/item/info/"+a.id+"?chapter="+t,key:t},{default:d((()=>[p("div",R,[q,p("div",U,[p("div",D,[p("h4",j,n(e.title),1),B]),p("div",E,n(e.viewCountShow)+"播放",1)])])])),_:2},1032,["to"])))),128))])),_:1},8,["label"]),c(ie,{label:"讨论",name:"chats"},{default:d((()=>[c(ae,{title:"全部评论",urlPrefix:"/course",showReplyForm:a.showReplyForm,"onUpdate:showReplyForm":t[0]||(t[0]=e=>a.showReplyForm=e),dataId:a.id,dataModel:"course_item"},null,8,["showReplyForm","dataId"])])),_:1}),c(ie,{label:"笔记",name:"notes"},{default:d((()=>[o(" 暂无笔记 ")])),_:1}),c(ie,{label:"评价",name:"comments"},{default:d((()=>[o(" 暂无评价 ")])),_:1})])),_:1},8,["modelValue"])])])),_:1})])),_:1})])]),p("div",z,[A,H,c(oe,{gutter:30,class:"cate-list flex-wrap"},{default:d((()=>[(u(!0),y(v,null,x(a.recommendList,((t,s)=>(u(),m(te,{xs:24,sm:12,md:8,lg:8,key:s},{default:d((()=>[p("div",M,[c(se,{to:"/course/item/info/"+t.id},{default:d((()=>[p("div",G,[p("img",{class:"cover",src:t.cover,alt:""},null,8,J),p("div",K,n(t.title),1)])])),_:2},1032,["to"]),p("div",Q,[p("h4",W,[c(se,{style:{color:"#51656F"},to:"/course/item/info/"+t.id},{default:d((()=>[o(n(t.title),1)])),_:2},1032,["to"])]),p("div",X,n(e.$xyutil.timeFormat(t.createTime)),1),p("div",Y,[c(se,{to:"/course/item/info/"+t.id},{default:d((()=>[c(re,{type:"primary",size:"default"},{default:d((()=>[o("立即学习")])),_:1})])),_:2},1032,["to"]),p("div",Z," 观看次数"+n(t.viewCount),1)])])])])),_:2},1024)))),128))])),_:1}),0==a.recommendList.length?(u(),m(de,{key:0,description:"暂无课程"})):f("",!0)])])}],["__scopeId","data-v-08487df5"]]);export{ee as default};
