var e=(e,t,a)=>new Promise(((i,o)=>{var s=e=>{try{n(a.next(e))}catch(t){o(t)}},l=e=>{try{n(a.throw(e))}catch(t){o(t)}},n=e=>e.done?i(e.value):Promise.resolve(e.value).then(s,l);n((a=a.apply(e,t)).next())}));import{_ as t}from"../../index.js";const a=(0,window.Vue.defineComponent)({setup:()=>({}),data:()=>({actionLoading:!1,tabCurrentIndex:0,navList:[{state:"all",title:"全部",loadingType:"more",loaded:!1,orderList:[],dataPage:{page:1,limit:10,total:0}},{state:"waitpay",title:"待付款",loadingType:"more",loaded:!1,orderList:[],dataPage:{page:1,limit:10,total:0}},{state:"waitdeliver,waitpick,waitconfirm",title:"待收货",loadingType:"more",loaded:!1,orderList:[],dataPage:{page:1,limit:10,total:0}},{state:"waitcomment",title:"待评价",loadingType:"more",loaded:!1,orderList:[],dataPage:{page:1,limit:10,total:0}},{state:"return,service",title:"退款/售后",loadingType:"more",loaded:!1,orderList:[],dataPage:{page:1,limit:10,total:0}}]}),created:function(){var e,t,a,i;(null==(t=null==(e=this.$router)?void 0:e.query)?void 0:t.tab)&&(this.tabCurrentIndex=parseInt(null==(i=null==(a=this.$router)?void 0:a.query)?void 0:i.tab)),this.loadData()},watch:{tabCurrentIndex(){this.loadData("tabChange")}},methods:{handleSizeChange(e){this.navList[this.tabCurrentIndex].dataPage.page=1,this.loadData()},handleCurrentChange(e){this.loadData()},loadData(t=""){return e(this,null,(function*(){let e=this.navList[this.tabCurrentIndex];if("tabChange"===t&&!0===e.loaded)return;if("loading"===e.loadingType)return;e.loadingType="loading";let a=yield this.$xyutil.request({url:"/v1/ishop/order/my",method:"get",data:{state:e.state,page:e.dataPage.page,limit:e.dataPage.limit}});200==a.code&&(e.orderList=a.data.dataList,e.dataPage=a.data.dataPage,e.loaded=!0,e.loadingType="done")}))},resetLoaded(){let e=this.navList;for(var t=0;t<e.length;t++)e[t].loaded=!1},navTo(e){this.$router.push({path:e})},doAction(t,a,i){return e(this,null,(function*(){this.actionLoading=!0;var o={};switch(t){case"删除订单":uni.showModal({content:"确定要删除订单？",success:t=>e(this,null,(function*(){t.confirm&&(200==(o=yield this.$xyutil.request({url:"/v1/ishop/order/delete/"+a,method:"DELETE"})).code?(this.$xyutil.showToast({title:o.msg,icon:"success",duration:1e3}),this.loadData(),this.resetLoaded()):this.$xyutil.showToast({title:o.msg,icon:"loading",duration:1500}))}))});break;case"取消订单":uni.showModal({content:"确定要取消订单？",success:t=>e(this,null,(function*(){t.confirm&&(200==(o=yield this.$xyutil.request({url:"/v1/ishop/order/cancel",method:"PUT",data:{orderNo:a}})).code?(this.$xyutil.showToast({title:o.msg,icon:"success",duration:1e3}),this.loadData(),this.resetLoaded()):this.$xyutil.showToast({title:o.msg,icon:"loading",duration:1500}))}))});break;case"立即付款":this.navTo("/ishop/order/info?orderNos="+a);break;case"确认收货":uni.showModal({content:"确定要确认收货？",success:t=>e(this,null,(function*(){t.confirm&&(200==(o=yield this.$xyutil.request({url:"/v1/ishop/order/confirm",method:"PUT",data:{orderNo:a}})).code?(this.$xyutil.showToast({title:o.msg,icon:"success",duration:1e3}),this.loadData(),this.resetLoaded()):this.$xyutil.showToast({title:o.msg,icon:"loading",duration:1500}))}))});break;case"评价":uni.setStorageSync("ishopCommmentCurrent",i),this.navTo("/ishop/comment/add?orderNo="+a);break;case"退货":this.navTo("/ishop/order_return/apply?orderNo="+a)}this.actionLoading=!1}))}}}),i=window.Vue.createTextVNode,o=window.Vue.resolveComponent,s=window.Vue.withCtx,l=window.Vue.createVNode,n=window.Vue.createElementVNode,d=window.Vue.renderList,r=window.Vue.Fragment,c=window.Vue.openBlock,u=window.Vue.createElementBlock,p=window.Vue.createBlock,m=window.Vue.createCommentVNode,h=window.Vue.toDisplayString,g=window.Vue.vShow,w=window.Vue.withDirectives,y=window.Vue.withModifiers,x=window.Vue.normalizeClass;window.Vue.pushScopeId,window.Vue.popScopeId;const v={class:"container bg-white p-b"},f={class:"p-t"},b={class:"i-top bg-gray-100 px-2 py-2 ts-13"},T={class:"title"},C={class:"m-r"},k={class:"m-r"},L={class:"m-r"},V={class:"state ts-13"},P=["src"],z=["src"],$={class:"right flex-1 flex flex-col"},_={class:"flex"},I={class:"title clamp flex-1"},D={class:"flex-1 flex justify-end"},N={key:0,class:"text-error font-sm",type:"default",size:"small"},S={key:1,class:"text-error font-sm",type:"default",size:"small"},E={class:"attr-box"},U={class:"spec"},q={class:"amount"},F={class:"deliver-info flex",style:{color:"#909399","font-size":"12px"}},M={class:"price-total flex justify-end"},j={key:0,class:"action-box b-t m-b-xs m-r"},A=["onClick"],B={class:"summary"},G={class:"num"},H={class:"price"},J={key:0,class:"flex flex-start"};const K=t(a,[["render",function(e,t,a,K,O,Q){const R=o("el-breadcrumb-item"),W=o("el-breadcrumb"),X=o("el-empty"),Y=o("scroll-view"),Z=o("el-tag"),ee=o("el-skeleton"),te=o("el-pagination"),ae=o("el-tab-pane"),ie=o("el-tabs");return c(),u("div",v,[n("div",f,[l(W,{"separator-class":"el-icon-arrow-right",class:"p-l m-b"},{default:s((()=>[l(R,{to:{path:"/user/center"}},{default:s((()=>[i("个人中心")])),_:1}),l(R,null,{default:s((()=>[i("我的订单")])),_:1})])),_:1})]),l(ie,{modelValue:e.tabCurrentIndex,"onUpdate:modelValue":t[0]||(t[0]=t=>e.tabCurrentIndex=t),type:"card","tab-position":"top"},{default:s((()=>[(c(!0),u(r,null,d(e.navList,((t,a)=>(c(),p(ae,{key:a,label:t.title,name:a},{default:s((()=>[l(ee,{loading:"loading"==t.loadingType,animated:"",rows:8},{default:s((()=>[0==t.orderList.length?(c(),p(X,{key:0,description:"暂无数据"})):m("",!0),(c(!0),u(r,null,d(t.orderList,((t,a)=>(c(),u("div",{key:a,class:"order-item"},[n("div",b,[n("text",T,[n("span",C,h(t.storeInfo.title),1),n("span",k,h(e.$xyutil.timeFormat(t.createTime)),1),n("span",L,"订单号："+h(t.orderNo),1)]),n("text",V,h(t.stateFormat.title),1)]),t.listType&&"o2o"==t.listType?(c(),p(Y,{key:0,class:"goods-box","scroll-x":""},{default:s((()=>[(c(!0),u(r,null,d(t.skuList,((e,t)=>(c(),u("div",{key:t,class:"goods-item"},[w(n("img",{width:"60",class:"goods-img",src:e.cover,mode:"aspectFill"},null,8,P),[[g,e.cover]])])))),128))])),_:2},1024)):m("",!0),(c(!0),u(r,null,d(t.skuList,((e,a)=>(c(),u("div",{class:"goods-box-single flex p-t-sm",key:a},[n("img",{width:"80",class:"goods-img",src:e.cover,mode:"aspectFill"},null,8,z),n("div",$,[n("div",_,[n("div",I,[t.promoteType?(c(),p(Z,{key:0,class:"m-r-xs",plain:!0,shape:"circle",size:"small"},{default:s((()=>[i(h(t.promoteTypeFormat.title),1)])),_:2},1024)):m("",!0),i(" "+h(e.title),1)]),n("div",D,[1==e.state?(c(),u("text",N,"退货中")):m("",!0),2==e.state?(c(),u("text",S,"已退货")):m("",!0)])]),n("div",E,[n("div",U,h(e.spec),1),n("div",q,[n("span",null,h(e.price),1),i(" x "+h(e.amount),1)])])])])))),128)),n("div",F,[t.deliverPay?(c(),p(Z,{key:0,class:"m-r-xs",plain:!0,size:"small"},{default:s((()=>[i("货到付款")])),_:1})):m("",!0)]),n("div",M,[t.stateExtend.actionTitle&&t.stateExtend.actionTitle.length>0?(c(),u("div",j,[(c(!0),u(r,null,d(t.stateExtend.actionTitle,((a,i)=>(c(),u("text",{key:i,size:"small",text:"",bg:"",class:x(["action-btn m-r text-primary","立即付款"==a||"确认收货"==a||"评价"==a?"active":""]),onClick:y((i=>e.doAction(a,t.orderNo,t)),["stop"])},h(a),11,A)))),128))])):m("",!0),n("div",B,[i(" 共 "),n("text",G,h(t.skuAmountAll),1),i(" 件商品 实付款 "),n("text",H,h(t.realMoney),1)])])])))),128))])),_:2},1032,["loading"]),0!=t.orderList.length?(c(),u("div",J,[l(te,{class:"m-t-md",size:"default",onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange,"current-page":t.dataPage.page,"onUpdate:current-page":e=>t.dataPage.page=e,background:"","page-sizes":[10,20,30,50],"page-size":t.dataPage.limit,"onUpdate:page-size":e=>t.dataPage.limit=e,layout:"total, sizes, prev, pager, next, jumper",total:t.dataPage.total},null,8,["onSizeChange","onCurrentChange","current-page","onUpdate:current-page","page-size","onUpdate:page-size","total"])])):m("",!0)])),_:2},1032,["label","name"])))),128))])),_:1},8,["modelValue"])])}],["__scopeId","data-v-b5937b82"]]);export{K as default};
