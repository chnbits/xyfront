import{_ as e}from"../../index.js";const o={components:{},data:()=>({regTab:"mobile",loading:!1,form:{countryCode:"+86",mobile:"",newPassword:"",verify:"",token:""},rule:{mobile:[{required:!0,message:"请填写手机号",trigger:"blur"}],newPassword:[{required:!0,message:"请填写新密码",trigger:"blur"},{type:"string",min:6,message:"密码至少6位",trigger:"blur"}],verify:[{required:!0,message:"请填写验证码",trigger:"blur"}],token:[{required:!0,message:"请发送验证码",trigger:"blur"}]}}),created:function(){this.$route.query.account&&(this.form.mobile=this.$route.query.account)},methods:{handleClick(){switch(this.regTab){case"mobile":this.$xyutil.navigateTo("/reg_mobile/user/resetPassword");break;case"email":this.$xyutil.navigateTo("/reg_email/user/resetPasswordSend")}},onCountrySelect({name:e,iso2:o,dialCode:t}){this.form.countryCode="+"+t},getVerifyToken(e){this.form.token=e.token},handleSubmit(){return e=this,o=null,t=function*(){this.loading=!0;let e=this;setTimeout((function(){e.loading=!1}),5e3);let o=yield this.$util.request({url:"/v1/reg_mobile/user/restPassword",data:this.form,method:"put"});"200"==o.code?(this.$util.showToast({title:o.msg,icon:"success",duration:2e3}),this.$xyutil.switchTab({url:"/user/login"})):this.$util.showToast({title:o.msg,icon:"loading",duration:3e3}),this.loading=!1},new Promise(((l,i)=>{var r=e=>{try{a(t.next(e))}catch(o){i(o)}},s=e=>{try{a(t.throw(e))}catch(o){i(o)}},a=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,s);a((t=t.apply(e,o)).next())}));var e,o,t}}},t=window.Vue.resolveComponent,l=window.Vue.createVNode,i=window.Vue.createElementVNode,r=window.Vue.withCtx,s=window.Vue.openBlock,a=window.Vue.createBlock,n=window.Vue.createCommentVNode,d=window.Vue.createTextVNode,u=window.Vue.createElementBlock,m={id:"wrap",class:"wrap"},c={class:"main"},f=i("div",{class:"main-banner hidden-md-and-up"},[i("h1",{class:"title m-t"}," 账号中心 ")],-1),p={class:"container main-content"},g=["src"],w=i("div",{class:"title"}," 忘记密码 ",-1);const h=e(o,[["render",function(e,o,h,y,b,V){const x=t("xy-header"),v=t("el-col"),k=t("el-tab-pane"),C=t("el-tabs"),_=t("xy-country-select"),T=t("el-input"),$=t("el-form-item"),P=t("xy-send-verify"),q=t("el-button"),S=t("el-form"),N=t("el-row"),z=t("xy-footer");return s(),u("div",m,[l(x),i("div",c,[f,i("div",p,[l(N,{type:"flex",justify:"space-between",align:"middle"},{default:r((()=>[l(v,{xs:1,sm:1,md:8,lg:10,class:"left-box hidden-sm-and-down"},{default:r((()=>[i("img",{src:e.$store.state.app.loginPic,width:"500"},null,8,g)])),_:1}),l(v,{xs:24,sm:{span:12,offset:6},md:{span:13,offset:0},lg:{span:9,offset:0},class:"login-box bg-white"},{default:r((()=>[w,l(C,{stretch:"",modelValue:b.regTab,"onUpdate:modelValue":o[0]||(o[0]=e=>b.regTab=e),onTabClick:V.handleClick},{default:r((()=>[e.$store.state.app.siteInfo.versionFuncsAll.indexOf("reg_mobile")>=0?(s(),a(k,{key:0,class:"p-t",label:"手机号码",name:"mobile"})):n("",!0),e.$store.state.app.siteInfo.versionFuncsAll.indexOf("reg_email")>=0?(s(),a(k,{key:1,class:"p-t",label:"",name:"email"})):n("",!0)])),_:1},8,["modelValue","onTabClick"]),l(S,{ref:"form",model:b.form,rules:b.rule},{default:r((()=>[l($,{prop:"mobile"},{default:r((()=>[l(T,{size:"large",type:"text",prefix:"ios-at-outline",modelValue:b.form.mobile,"onUpdate:modelValue":o[1]||(o[1]=e=>b.form.mobile=e),placeholder:"手机号"},{prepend:r((()=>[l(_,{defaultCountry:"CN",enabledCountryCode:"",onOnSelect:V.onCountrySelect},null,8,["onOnSelect"])])),_:1},8,["modelValue"])])),_:1}),l($,{prop:"verify"},{default:r((()=>[l(T,{size:"large",type:"text",prefix:"ios-lock-outline",modelValue:b.form.verify,"onUpdate:modelValue":o[2]||(o[2]=e=>b.form.verify=e),placeholder:"验证码"},{append:r((()=>[l(P,{onVerifysuccess:V.getVerifyToken,url:"/v1/sms/verify/send",type:"手机号",account:b.form.mobile,title:"重置密码"},null,8,["onVerifysuccess","account"])])),_:1},8,["modelValue"])])),_:1}),l($,{prop:"password"},{default:r((()=>[l(T,{size:"large",type:"password",prefix:"ios-lock-outline",modelValue:b.form.newPassword,"onUpdate:modelValue":o[3]||(o[3]=e=>b.form.newPassword=e),placeholder:"新密码"},null,8,["modelValue"])])),_:1}),l(q,{class:"full submit-btn",size:"large",loading:b.loading,type:"primary",onClick:o[4]||(o[4]=e=>V.handleSubmit("form"))},{default:r((()=>[d(" 立即重置 ")])),_:1},8,["loading"])])),_:1},8,["model","rules"])])),_:1})])),_:1})])]),l(z)])}]]);export{h as default};
