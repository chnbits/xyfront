var e=(e,t,s)=>new Promise(((l,r)=>{var o=e=>{try{n(s.next(e))}catch(t){r(t)}},a=e=>{try{n(s.throw(e))}catch(t){r(t)}},n=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,a);n((s=s.apply(e,t)).next())}));import{_ as t}from"../../index.js";const s={props:{value:{type:[Object,Array,String,Number],default:()=>({})},formValues:{type:Object,default:()=>({cloudId:0,eid:0})},header:{type:Object,default:()=>({cloudId:0,eid:0})},show:!1,predata:"",item:{type:Object,default:()=>({})},pitem:{type:Object,default:()=>({})},api:{type:String,default:()=>null},outUrl:{type:String,default:()=>null},showDev:!1},data:()=>({formValue:null,resData:null,cssId:null}),created(){this.formValue=this.value},computed:{currentView(){if(!this.resData)return{template:"<div class='remoteInfo'>正在加载中。。。</div>"};const e=this.resolveStr(this.resData);let t=new Function(`return ${e.sctipts.slice(e.sctipts.indexOf("{"),e.sctipts.lastIndexOf("}")+1)}`)();if(t.template=e.templates,this.$el.setAttribute("class",`remote css${this.cssId}`),!document.querySelector(`style[id=css${this.cssId}]`)){let t=`\n                    .css${this.cssId}{\n                        ${e.styles}\n                    }\n                `;this.resolveCss(t)}return t}},watch:{outUrl(){this.getVueComp()},formValue(){this.$emit("input",this.formValue)}},mounted(){this.getVueComp()},methods:{closeModal(e=!0){this.$emit("close",e)},getId(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var s=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?s:3&s|8).toString(16)}))},resolveCss(e){less.render(e).then(function(e){let t=document.createElement("style");if(t.setAttribute("type","text/css"),t.setAttribute("id","css"+this.cssId),t.styleSheet)t.styleSheet.cssText=e.css;else{var s=document.createTextNode(e.css);t.appendChild(s)}var l=document.getElementsByTagName("head");l.length?l[0].appendChild(t):document.documentElement.appendChild(t)}.bind(this))},resolveStr:e=>({templates:e.match(/<template>([\s\S]*)<\/template>/)[1],sctipts:e.match(/<script.*>([\s\S]*)<\/script>/)[1],styles:e.match(/<style.*>([\s\S]*)<\/style>/)[1]}),getVueComp(){return e(this,null,(function*(){if(!this.$props.outUrl)return void alert("Vue文件地址为空");let e=this.$props.outUrl;const t=yield axios.get(e);this.cssId=this.getId(),this.resData=t.data}))},loadData(){return e(this,null,(function*(){this.getVueComp()}))}}},l=window.Vue.resolveDynamicComponent,r=window.Vue.mergeProps,o=window.Vue.openBlock,a=window.Vue.createBlock,n=window.Vue.createElementBlock,i={class:"xy-builder-comp xy-builder-wrap-remote"};const u=t(s,[["render",function(e,t,s,u,c,d){return o(),n("div",i,[(o(),a(l(d.currentView),r(e.$props,{modelValue:c.formValue,"onUpdate:modelValue":t[0]||(t[0]=e=>c.formValue=e),onClose:d.closeModal}),null,16,["modelValue","onClose"]))])}]]);export{u as default};
