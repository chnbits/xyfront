var e=(e,t,o)=>new Promise(((s,l)=>{var i=e=>{try{r(o.next(e))}catch(t){l(t)}},a=e=>{try{r(o.throw(e))}catch(t){l(t)}},r=e=>e.done?s(e.value):Promise.resolve(e.value).then(i,a);r((o=o.apply(e,t)).next())}));import{_ as t}from"../../index.js";const o={data:()=>({show:"choose",type:"",form:{loading:!1,seed:"",bindType:"",account:"",password:"",verify:"",token:""},rule:{account:[{required:!0,message:"请填写账号",trigger:"blur"}]}}),created:function(){this.type=this.$route.query.type,this.form.seed=this.$route.query.seed},methods:{getVerifyToken(e){this.form.token=e},handleRegister(){return e(this,null,(function*(){this.loading=!0;let e=this;setTimeout((function(){e.loading=!1}),5e3);let t="";switch(this.type){case"wxmp":t="/v1/wxmp/user/register";break;case"wxapp":t="/v1/wxapp/user/register";break;default:return}let o=yield this.$util.request({url:t,data:this.form,method:"post"});"200"==o.code?(this.$store.commit("user/setToken",o.data.token),this.$store.commit("user/setUserInfo",o.data.userInfo),this.$util.showToast({title:o.msg,icon:"success",duration:2e3}),this.$xyutil.navigateTo("/my")):this.$util.showToast({title:o.msg,icon:"loading",duration:3e3}),this.loading=!1}))},handleBind(t){return e(this,null,(function*(){this.form.bindType=t,this.loading=!0;let e=this;switch(setTimeout((function(){e.loading=!1}),5e3),this.type){case"wxmp":case"wxapp":break;default:return}let o=yield this.$util.request({url:"/v1/third_login/user/bind",data:this.form,method:"post"});"200"==o.code?(this.$store.commit("user/setToken",o.data.token),this.$store.commit("user/setUserInfo",o.data.userInfo),this.$util.showToast({title:o.msg,icon:"success",duration:2e3}),this.$xyutil.navigateTo("/my")):this.$util.showToast({title:o.msg,icon:"loading",duration:3e3}),this.loading=!1}))}}},s=window.Vue.resolveComponent,l=window.Vue.createVNode,i=window.Vue.createElementVNode,a=window.Vue.withCtx,r=window.Vue.toDisplayString,n=window.Vue.createTextVNode,d=window.Vue.openBlock,u=window.Vue.createBlock,c=window.Vue.createCommentVNode,f=window.Vue.createElementBlock,m=window.Vue.pushScopeId,p=window.Vue.popScopeId,h=e=>(m("data-v-bee1b222"),e=e(),p(),e),w={id:"wrap",class:"wrap"},g={class:"main"},y={class:"container",style:{"padding-top":"100px","padding-bottom":"80px"}},x=h((()=>i("img",{src:"https://vkceyugu.cdn.bspapp.com/VKCEYUGU-f12e1180-fce8-465f-a4cd-9f2da88ca0e6/a5530bd3-6d32-483a-a8be-394e6016043f.png",width:"630"},null,-1))),b={class:"success-box text-center"},v=h((()=>i("h4",{class:"title"}," 账号绑定 ",-1))),V=h((()=>i("div",{class:"bottom flex space-between flex-alignCenter"},null,-1))),k=h((()=>i("div",{class:"title"}," 用户绑定并登录 ",-1))),_={class:"subtitle"},C={class:"flex flex-alignCenter"},T={class:"actions flex m-t"},$=h((()=>i("div",{class:"title"}," 用户绑定并登录 ",-1))),z={class:"actions flex m-t"};const I=t(o,[["render",function(e,t,o,m,p,h){const I=s("xy-header"),U=s("el-col"),B=s("el-button"),q=s("router-link"),N=s("el-input"),P=s("el-form-item"),E=s("xy-send-verify"),S=s("el-form"),j=s("el-row"),R=s("xy-footer");return d(),f("div",w,[l(I),i("div",g,[i("div",y,[l(j,{type:"flex",justify:"space-between",align:"middle"},{default:a((()=>[l(U,{md:10,lg:16,class:"left-box hidden-sm-and-down"},{default:a((()=>[x])),_:1}),"choose"==p.show?(d(),u(U,{key:0,xs:24,sm:{span:14,offset:5},md:15,lg:9,class:"login-box bg-white"},{default:a((()=>[i("div",b,[v,i("p",null," 您的微信未绑定"+r(e.$store.state.app.siteInfo.title)+"账户，请选择操作 ",1),l(B,{class:"full cert",size:"large",type:"primary",onClick:t[0]||(t[0]=e=>{p.show="mobileVerify"})},{default:a((()=>[n(" 绑定已有账户 ")])),_:1}),l(B,{class:"full skip",size:"large",onClick:t[1]||(t[1]=e=>h.handleRegister())},{default:a((()=>[n(" 创建新账户 ")])),_:1})]),V])),_:1})):c("",!0),"mobileVerify"==p.show?(d(),u(U,{key:1,xs:24,sm:{span:14,offset:5},md:15,lg:9,class:"login-box bg-white"},{default:a((()=>[k,i("div",_,[n(" 还没有注册吗？ "),l(q,{to:"/user/register"},{default:a((()=>[n(" 请点击这里 ")])),_:1})]),l(S,{ref:"form",model:p.form,rules:p.rule},{default:a((()=>[l(P,{prop:"account"},{default:a((()=>[l(N,{size:"large",type:"text",prefix:"ios-person-outline",modelValue:p.form.account,"onUpdate:modelValue":t[2]||(t[2]=e=>p.form.account=e),placeholder:"请输入您的手机号码"},null,8,["modelValue"])])),_:1}),i("div",C,[l(P,{prop:"verify",class:"flex-1"},{default:a((()=>[l(N,{size:"large",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:p.form.verify,"onUpdate:modelValue":t[3]||(t[3]=e=>p.form.verify=e),placeholder:"请输入验证码"},null,8,["modelValue"])])),_:1}),l(E,{class:"send-verity-button",slot1:"append",onVerifysuccess:h.getVerifyToken,url:"/v1/sms/verify/send",type:"手机号",account:p.form.account,title:"用户登录"},null,8,["onVerifysuccess","account"])]),l(B,{class:"full submit-btn",size:"large",loading:p.form.loading,type:"primary",onClick:t[4]||(t[4]=e=>h.handleBind("mobildVerify"))},{default:a((()=>[n(" 绑定 ")])),_:1},8,["loading"]),i("div",T,[i("div",{onClick:t[5]||(t[5]=e=>p.show="password")}," 使用账号密码绑定 "),i("div",null,[l(q,{to:"/user/resetPassword"},{default:a((()=>[n(" 忘记密码？ ")])),_:1})])])])),_:1},8,["model","rules"]),i("div",{class:"bottom flex space-between flex-alignCenter",onClick:t[6]||(t[6]=e=>{p.show="choose"})})])),_:1})):c("",!0),"password"==p.show?(d(),u(U,{key:2,xs:22,sm:12,md:10,lg:10,class:"login-box bg-white"},{default:a((()=>[$,l(S,{ref:"form",model:p.form,rules:p.rule},{default:a((()=>[l(P,{prop:"account"},{default:a((()=>[l(N,{size:"large",type:"text",prefix:"ios-person-outline",modelValue:p.form.account,"onUpdate:modelValue":t[7]||(t[7]=e=>p.form.account=e),placeholder:"请输入您的邮箱地址或手机号码"},null,8,["modelValue"])])),_:1}),l(P,{prop:"password"},{default:a((()=>[l(N,{size:"large",type:"password",prefix:"ios-lock-outline",modelValue:p.form.password,"onUpdate:modelValue":t[8]||(t[8]=e=>p.form.password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),l(B,{class:"full submit-btn",size:"large",loading:p.form.loading,type:"primary",onClick:t[9]||(t[9]=e=>h.handleBind("password"))},{default:a((()=>[n(" 绑定 ")])),_:1},8,["loading"]),i("div",z,[i("div",{onClick:t[10]||(t[10]=e=>p.show="mobileVerify")}," 使用手机验证码绑定 "),i("div",null,[l(q,{to:"/user/resetPassword"},{default:a((()=>[n(" 忘记密码？ ")])),_:1})])])])),_:1},8,["model","rules"]),i("div",{class:"bottom flex space-between flex-alignCenter",onClick:t[11]||(t[11]=e=>{p.show="choose"})})])),_:1})):c("",!0)])),_:1})])]),l(R)])}],["__scopeId","data-v-bee1b222"]]);export{I as default};
