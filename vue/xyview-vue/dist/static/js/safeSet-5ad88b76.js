var e=(e,s,a)=>new Promise(((t,l)=>{var i=e=>{try{r(a.next(e))}catch(s){l(s)}},o=e=>{try{r(a.throw(e))}catch(s){l(s)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,o);r((a=a.apply(e,s)).next())}));import{_ as s}from"../../index.js";const a={name:"safeSet",data:()=>({loading:!1,safeSet:{},verifyData:"",mfa:0}),created:function(){this.loadSafeSet()},methods:{close(){},handle2fa:function(s){return e(this,null,(function*(){var e;let a={action:s};this.verifyData&&(a._verify=this.verifyData);let t=yield this.$util.request({url:"/v1/user/user/loginVerifySet",data:a,method:"put"});if(200!=t.code)return 401003==t.code?(this.$refs.sv.open(t.data.verifyList),!1):(this.$util.showToast({title:t.msg,icon:"loading",duration:3e3}),!1);(null==(e=this.$refs)?void 0:e.sv)&&this.$refs.sv.close(),this.$util.showToast({title:t.msg,icon:"success",duration:2e3}),this.verifyData=""}))},loadSafeSet(){return e(this,null,(function*(){this.loading=!0;let e=yield this.$util.request({url:"/v1/user/user/safeSet",method:"get"});200==e.code?this.safeSet=e.data.dataList:this.$util.showToast({title:e.msg,icon:"loading",duration:3e3}),this.loading=!1}))}}},t=window.Vue.createElementVNode,l=window.Vue.resolveComponent,i=window.Vue.createVNode,o=window.Vue.openBlock,r=window.Vue.createElementBlock,n=window.Vue.createCommentVNode,d=window.Vue.toDisplayString,u=window.Vue.createTextVNode,c=window.Vue.withCtx,f=window.Vue.createBlock,p=window.Vue.pushScopeId,y=window.Vue.popScopeId,v=e=>(p("data-v-c4fc8f28"),e=e(),y(),e),m={slot:"header",class:"clearfix flex"},h=v((()=>t("span",{class:"title"},"账号与安全",-1))),x={key:0,class:"m-l-md"},g={class:"safety-level",style:{"padding-top":"10px"}},w={class:"flex"},$={class:"tip ts-12 m-t-xs text-gray flex flex-alignCenter"},k=v((()=>t("i",{class:"xyicon xyicon-help-o ts-13 m-r-xs"},null,-1))),S={key:0},b={key:1},V={class:"content clearfix"},_={class:"count-list"},C={key:0,class:"item clear"},E={class:"fl flex"},T=v((()=>t("span",{class:"title"},"手机绑定",-1))),I={class:"tip"},z={key:0,class:"m-t-sm"},D={class:"fr"},L={key:1,class:"item clear"},q={class:"fl flex"},N=v((()=>t("span",{class:"title"},"邮箱绑定",-1))),B={class:"tip"},P={key:0,class:"m-t-sm"},R={class:"fr"},U={class:"item clear"},j=v((()=>t("div",{class:"fl flex"},[t("span",{class:"title"},"登录密码"),t("span",{class:"tip"},"登录时使用，是您的第一道安全防线")],-1))),W={class:"fr"},A={key:2,class:"item clear"},F=v((()=>t("div",{class:"fl flex"},[t("span",{class:"title"},"支付密码"),t("span",{class:"tip"},"交易时使用，开启手机验证或者谷歌验证后方可进行设置")],-1))),G={class:"fr"},H={key:3,class:"item clear"},J=v((()=>t("div",{class:"fl"},[t("span",{class:"title"},"谷歌验证"),t("span",{class:"tip"},"为了您的账户安全，请绑定谷歌验证器")],-1))),K={class:"fr flex"},M={key:4,class:"item clear"},O=v((()=>t("div",{class:"fl flex"},[t("span",{class:"title"},"两步验证"),t("span",{class:"tip"},"开启后，每次登录均需要通过短信或谷歌验证")],-1))),Q={class:"fr"};const X=s(a,[["render",function(e,s,a,p,y,v){const X=l("xy-safety-level"),Y=l("el-button"),Z=l("el-switch"),ee=l("xy-safety-verify"),se=l("el-card");return o(),f(se,{class:"center-box safe-box m-b",shadow:"never"},{default:c((()=>[t("div",m,[h,e.$util.hasExt("user")?(o(),r("div",x,[t("div",g,[t("div",w,[i(X,{levelWidt:"80px",level:e.$store.state.user.userInfo.moduleExtend.user.safetyLevel},null,8,["level"])]),t("div",$,[k,e.$store.state.user.userInfo.moduleExtend.user.safetyLevel<3?(o(),r("span",S," 账号安全级别较低，建议完善实名认证、手机号及邮箱绑定。 ")):n("",!0),3==e.$store.state.user.userInfo.moduleExtend.user.safetyLevel?(o(),r("span",b," 当前账号很安全，建议您定期定期修改密码继续保持！ ")):n("",!0)])])])):n("",!0)]),t("div",V,[t("div",_,[e.$util.hasExt("reg_mobile")?(o(),r("div",C,[t("div",E,[T,t("span",I,[u(" 短信验证用于登录和修改安全验证 "),e.$store.state.user.userInfo.mobile?(o(),r("div",z," 您已经绑定"+d(e.$store.state.user.userInfo.mobile),1)):n("",!0)])]),t("div",D,[e.$store.state.user.userInfo.mobile?(o(),f(Y,{key:1,onClick:s[1]||(s[1]=s=>e.$xyutil.navigateTo({url:"/reg_mobile/user/change"})),type:"primary",size:"default",plain:"",class:"ghost"},{default:c((()=>[u("换绑")])),_:1})):(o(),f(Y,{key:0,onClick:s[0]||(s[0]=s=>e.$xyutil.navigateTo({url:"/reg_mobile/user/bind"})),type:"primary",size:"default",plain:"",class:""},{default:c((()=>[u("绑定")])),_:1}))])])):n("",!0),e.$util.hasExt("reg_email")?(o(),r("div",L,[t("div",q,[N,t("span",B,[u(" 为了您的账户安全，请绑定邮箱 "),e.$store.state.user.userInfo.email?(o(),r("div",P," 您已经绑定"+d(e.$store.state.user.userInfo.email),1)):n("",!0)])]),t("div",R,[e.$store.state.user.userInfo.email?(o(),f(Y,{key:1,onClick:s[3]||(s[3]=s=>e.$xyutil.navigateTo({url:"/reg_email/user/change"})),type:"primary",size:"default",plain:"",class:"ghost"},{default:c((()=>[u("换绑")])),_:1})):(o(),f(Y,{key:0,onClick:s[2]||(s[2]=s=>e.$xyutil.navigateTo({url:"/reg_email/user/bind"})),type:"primary",size:"default",plain:"",class:""},{default:c((()=>[u("绑定")])),_:1}))])])):n("",!0),t("div",U,[j,t("div",W,[y.safeSet.password&&y.safeSet.password.isset?(o(),f(Y,{key:0,onClick:s[4]||(s[4]=s=>e.$xyutil.navigateTo({url:"/user/editPassword"})),type:"primary",size:"default",plain:"",class:"ghost"},{default:c((()=>[u("修改")])),_:1})):n("",!0),y.safeSet.password&&!y.safeSet.password.isset?(o(),f(Y,{key:1,type:"primary",size:"default",plain:"",class:""},{default:c((()=>[u("设置")])),_:1})):n("",!0)])]),e.$util.hasExt("paypwd")?(o(),r("div",A,[F,t("div",G,[y.safeSet.paypwd&&y.safeSet.paypwd.isset?(o(),f(Y,{key:0,onClick:s[5]||(s[5]=s=>e.$xyutil.navigateTo({url:"/paypwd/change"})),type:"primary",size:"default",plain:"",class:"ghost"},{default:c((()=>[u("修改")])),_:1})):n("",!0),y.safeSet.paypwd&&!y.safeSet.paypwd.isset?(o(),f(Y,{key:1,onClick:s[6]||(s[6]=s=>e.$xyutil.navigateTo({url:"/paypwd/set"})),type:"primary",size:"default",plain:"",disabled:!y.safeSet.mobile&!y.safeSet.email},{default:c((()=>[u("设置")])),_:1},8,["disabled"])):n("",!0)])])):n("",!0),e.$util.hasExt("gauth")?(o(),r("div",H,[J,t("div",K,[y.safeSet.gauth?n("",!0):(o(),f(Y,{key:0,onClick:s[7]||(s[7]=s=>e.$xyutil.navigateTo({url:"/gauth/user/bind"})),type:"primary",disabled:!y.safeSet.mobile&!y.safeSet.email,size:"default",plain:"",class:""},{default:c((()=>[u("绑定")])),_:1},8,["disabled"])),y.safeSet.gauth?(o(),f(Y,{key:1,onClick:s[8]||(s[8]=s=>e.$xyutil.navigateTo({url:"/gauth/user/change"})),type:"primary",size:"default",plain:"",class:"ghost"},{default:c((()=>[u("换绑")])),_:1})):n("",!0)])])):n("",!0),e.$util.hasExt("gauth")>=0||e.$util.hasExt("reg_mobile")>=0||e.$util.hasExt("email")?(o(),r("div",M,[O,t("div",Q,[i(Z,{disabled:!y.safeSet.mobile&&!y.safeSet.email,modelValue:y.safeSet.mfa,"onUpdate:modelValue":s[9]||(s[9]=e=>y.safeSet.mfa=e),"active-value":1,"inactive-value":0,"before-change":v.handle2fa},null,8,["disabled","modelValue","before-change"])])])):n("",!0)])]),i(ee,{modelValue:y.verifyData,"onUpdate:modelValue":s[10]||(s[10]=e=>y.verifyData=e),onVerifyRequest:v.handle2fa,onCancel:v.close,ref:"sv"},null,8,["modelValue","onVerifyRequest","onCancel"])])),_:1})}],["__scopeId","data-v-c4fc8f28"]]);export{X as default};
