var e=(e,a,t)=>new Promise(((i,r)=>{var s=e=>{try{p(t.next(e))}catch(a){r(a)}},o=e=>{try{p(t.throw(e))}catch(a){r(a)}},p=e=>e.done?i(e.value):Promise.resolve(e.value).then(s,o);p((t=t.apply(e,a)).next())}));import{b as a}from"../../index.js";import{l as t}from"./index-e1b4e256.js";const i={name:"button",data:()=>({}),created:function(){},mounted:function(){return e(this,null,(function*(){}))},methods:{goPage(a,i){return e(this,null,(function*(){let r=this,s=a.extra;s.pageData.hasOwnProperty("pageType")||(s.pageData.pageType="modal");let o="";var p="",n=new Object;if(i){if(s.pageData.apiSuffix){let e=s.pageData.apiSuffix;for(let a of e)a.field?a.noSlash?p+=i.row[a.field]:p=p+"/"+i.row[a.field]:p=p+"/"+i.row[a]}else p="/"+i.row.id;if(s.pageData.apiParams&&(p=s.pageData.apiParams+p),s.pageData.querySuffix){let e=s.pageData.querySuffix;for(let a of e)1==a[2]?n[a[0]]=a[1]:n[a[0]]=i.row[a[1]]}o=p;let e="";e="string"!=typeof s.pageData.queryParams?t.stringify(s.pageData.queryParams):0==s.pageData.queryParams.indexOf("?")?s.pageData.queryParams.substr(1):s.pageData.queryParams,e?(o=o+"?"+e,t.stringify(n)&&(o=o+"&"+t.stringify(n))):t.stringify(n)&&(o=o+"?"+t.stringify(n)),s.pageData.querySuffixParse=n}switch(this.currentItem.pageData.modalType=s.pageData.modalType,s.pageData.title&&(this.currentItem.pageData.title=s.pageData.title),s.pageData.modalType){case"table":case"html":case"htmls":this.currentItem.pageData.width=s.pageData.width,this.currentItem.pageData.apiBlank=s.pageData.api+o,this.currentItem.pageData.predata=s.pageData.predata,this.currentItem.pageData.show=!0;break;case"url":window.open(s.pageData.url+o);break;case"confirm":if(this.$store.state.app.uiAudio){let e=new Audio;e.src={NODE_ENV:"production",VUE_APP_I18N_LOCALE:"zh",VUE_APP_I18N_FALLBACK_LOCALE:"zh",VUE_APP_IS_DEMO:"false",VUE_APP_BASE_DOMAIN:"https://uiadmin.net",VUE_APP_PUBLIC_PATH:"./",VUE_APP_CDN_DOMAIN:"https://cdn.jiangruyi.com",VUE_APP_DEPLOY_ALONE:"false",VUE_APP_BASE:"https://cdn.jiangruyi.com/vue/xyview-vue/dist/"}.VUE_APP_AUDIO_OPEN,e.play()}this.$confirm(s.pageData.content,s.pageData.title,{confirmButtonText:s.pageData.okText,cancelButtonText:s.pageData.cancelText,dangerouslyUseHTMLString:!0,closeOnClickModal:!1,type:"warning"}).then((()=>e(this,null,(function*(){let e=s.pageData.api+p;""!=t.stringify(n)&&(e=e+"?"+t.stringify(n));let a=yield r.$xyutil.request({url:e,method:s.pageData.formMethod,header:r.header});if("200"==a.code){if(r.$xyutil.showToast({title:a.msg,icon:"success",duration:1e3}),this.$store.state.app.uiAudio){let e=new Audio;e.src="https://cdn.jsdelivr.net/gh/starideas/xyfront/audio/delete.mp3",e.play()}s.pageData.noRefresh||r.loadData()}else r.$xyutil.showToast({title:a.msg,icon:"loading",duration:3e3})})))).catch((()=>{if(this.$store.state.app.uiAudio){let e=new Audio;e.src={NODE_ENV:"production",VUE_APP_I18N_LOCALE:"zh",VUE_APP_I18N_FALLBACK_LOCALE:"zh",VUE_APP_IS_DEMO:"false",VUE_APP_BASE_DOMAIN:"https://uiadmin.net",VUE_APP_PUBLIC_PATH:"./",VUE_APP_CDN_DOMAIN:"https://cdn.jiangruyi.com",VUE_APP_DEPLOY_ALONE:"false",VUE_APP_BASE:"https://cdn.jiangruyi.com/vue/xyview-vue/dist/"}.VUE_APP_AUDIO_CLOSE,e.play()}}));break;default:switch(this.pitem.pageData&&"modal"==this.pitem.pageData.pageType&&(s.pageData.pageType=this.pitem.pageData.pageType),s.pageData.pageType){case"replace":this.$router.replace({path:s.pageData.route+"/"+i.row.name});break;case"page":let e="";this.$store.state.menu.menuList.menuTree[this.$store.state.menu.currentSite].routePrefix&&(e=this.$store.state.menu.menuList.menuTree[this.$store.state.menu.currentSite].routePrefix),this.$router.push({path:e+"/pages"+s.pageData.api+p,query:n});break;case"drawer":case"modal":this.currentItem.pageData.width=s.pageData.width,this.currentItem.pageData.apiBlank=s.pageData.api+o,this.currentItem.pageData.show=!0;break;default:alert("未指定按钮pageType")}}}))},topButtonModal(a){var i;let r=this,s=this.listData.topButtonList[a],o={};if(s.pageData.querySuffix){let e=s.pageData.querySuffix;for(let a of e)1==a[2]?o[a[0]]=a[1]:"id"==a[1]&&(this.currentSelecteds?o[a[0]]=this.currentSelecteds.join(","):alert("请勾选操作项目"))}let p=s.pageData.apiParams,n="";switch(n="string"!=typeof s.pageData.queryParams?t.stringify(s.pageData.queryParams):0==s.pageData.queryParams.indexOf("?")?s.pageData.queryParams.substr(1):s.pageData.queryParams,n?(p=p+"?"+n,t.stringify(o)&&(p=p+"&"+t.stringify(o))):t.stringify(o)&&(p=p+"?"+t.stringify(o)),s.pageData.querySuffixParse=o,s.pageData.modalType){case"url":window.open(s.pageData.url+p);break;case"confirm":if(this.$store.state.app.uiAudio){let e=new Audio;e.src={NODE_ENV:"production",VUE_APP_I18N_LOCALE:"zh",VUE_APP_I18N_FALLBACK_LOCALE:"zh",VUE_APP_IS_DEMO:"false",VUE_APP_BASE_DOMAIN:"https://uiadmin.net",VUE_APP_PUBLIC_PATH:"./",VUE_APP_CDN_DOMAIN:"https://cdn.jiangruyi.com",VUE_APP_DEPLOY_ALONE:"false",VUE_APP_BASE:"https://cdn.jiangruyi.com/vue/xyview-vue/dist/"}.VUE_APP_AUDIO_OPEN,e.play()}let a=this,t={};1==(null==(i=s.pageData)?void 0:i.postData)&&"get"!=s.pageData.formMethod&&(p=s.pageData.apiParams,t=o),this.$confirm(s.pageData.content,s.pageData.title,{confirmButtonText:s.pageData.okText,cancelButtonText:s.pageData.cancelText,dangerouslyUseHTMLString:!0,closeOnClickModal:!1,type:"warning"}).then((()=>e(this,null,(function*(){var e,i;let r=yield a.$xyutil.request({url:s.pageData.api+p,method:s.pageData.formMethod,data:t,header:{CloudId:a.cloudId,Eid:a.eid}});if("200"==r.code){if((null==(e=r.data)?void 0:e.url)?window.open(null==(i=r.data)?void 0:i.url):a.$Message.success(r.msg),this.$store.state.app.uiAudio){let e=new Audio;e.src="https://cdn.jsdelivr.net/gh/starideas/xyfront/audio/delete.mp3",e.play()}s.pageData.noRefresh||a.loadData()}else a.$xyutil.showToast({title:r.msg,icon:"error",duration:2e3})})))).catch((()=>{if(this.$store.state.app.uiAudio){let e=new Audio;e.src={NODE_ENV:"production",VUE_APP_I18N_LOCALE:"zh",VUE_APP_I18N_FALLBACK_LOCALE:"zh",VUE_APP_IS_DEMO:"false",VUE_APP_BASE_DOMAIN:"https://uiadmin.net",VUE_APP_PUBLIC_PATH:"./",VUE_APP_CDN_DOMAIN:"https://cdn.jiangruyi.com",VUE_APP_DEPLOY_ALONE:"false",VUE_APP_BASE:"https://cdn.jiangruyi.com/vue/xyview-vue/dist/"}.VUE_APP_AUDIO_CLOSE,e.play()}}));break;default:switch(this.pitem.pageData&&"modal"==this.pitem.pageData.pageType&&(s.pageData.pageType=this.pitem.pageData.pageType),s.pageData.pageType){case"page":let e="";this.$store.state.menu.menuList.menuTree[this.$store.state.menu.currentSite].routePrefix&&(e=this.$store.state.menu.menuList.menuTree[this.$store.state.menu.currentSite].routePrefix),this.$router.push({path:e+"/pages"+s.pageData.api+p});break;case"drawer":case"modal":s.pageData.apiBlank=s.pageData.api+p,s.pageData.show=!0}}r.$nextTick((function(){"auto"!==s.pageData.height&&(r.$refs["top_modal_"+s.name][0].$el.querySelector(".el-dialog").querySelector(".el-dialog__body").style.overflowY="scroll",r.$refs["top_modal_"+s.name][0].$el.querySelector(".el-dialog").querySelector(".el-dialog__body").style.height=s.pageData.height)}))},rightButtonModal(a,i,r){return e(this,null,(function*(){let r=this,s=this.listData.rightButtonList[a];var o="",p=new Object;if(s.pageData.apiSuffix){let e=s.pageData.apiSuffix;for(let a of e)a.field?a.noSlash?o+=i.row[a.field]:o=o+"/"+i.row[a.field]:o=o+"/"+i.row[a]}else o="/"+i.row.id;if(s.pageData.apiParams&&(o=s.pageData.apiParams+o),s.pageData.querySuffix){let e=s.pageData.querySuffix;for(let a of e)1==a[2]?p[a[0]]=a[1]:p[a[0]]=i.row[a[1]]}let n=o,u="";if(u="string"!=typeof s.pageData.queryParams?t.stringify(s.pageData.queryParams):0==s.pageData.queryParams.indexOf("?")?s.pageData.queryParams.substr(1):s.pageData.queryParams,u?(n=n+"?"+u,t.stringify(p)&&(n=n+"&"+t.stringify(p))):t.stringify(p)&&(n=n+"?"+t.stringify(p)),s.pageData.querySuffixParse=p,"replace"==s.pageData.pageType)this.$router.replace({path:s.pageData.route+"/"+i.row.name});else switch(s.pageData.modalType){case"url":window.open(s.pageData.url+n);break;case"confirm":if(this.$store.state.app.uiAudio){let e=new Audio;e.src={NODE_ENV:"production",VUE_APP_I18N_LOCALE:"zh",VUE_APP_I18N_FALLBACK_LOCALE:"zh",VUE_APP_IS_DEMO:"false",VUE_APP_BASE_DOMAIN:"https://uiadmin.net",VUE_APP_PUBLIC_PATH:"./",VUE_APP_CDN_DOMAIN:"https://cdn.jiangruyi.com",VUE_APP_DEPLOY_ALONE:"false",VUE_APP_BASE:"https://cdn.jiangruyi.com/vue/xyview-vue/dist/"}.VUE_APP_AUDIO_OPEN,e.play()}this.$confirm(s.pageData.content,s.pageData.title,{confirmButtonText:s.pageData.okText,cancelButtonText:s.pageData.cancelText,dangerouslyUseHTMLString:!0,closeOnClickModal:!1,type:"warning"}).then((()=>e(this,null,(function*(){var e,a;let t=yield r.$xyutil.request({url:s.pageData.api+n,method:s.pageData.formMethod,header:r.header});if("200"==t.code){if((null==(e=t.data)?void 0:e.url)?window.open(null==(a=t.data)?void 0:a.url):r.$xyutil.showToast({title:t.msg,icon:"success",duration:1e3}),this.$store.state.app.uiAudio){let e=new Audio;e.src="https://cdn.jsdelivr.net/gh/starideas/xyfront/audio/delete.mp3",e.play()}t.data.updateMenu&&(yield this.getMenu([])),s.pageData.noRefresh||r.loadData()}else r.$xyutil.showToast({title:t.msg,icon:"loading",duration:3e3})})))).catch((()=>{if(this.$store.state.app.uiAudio){let e=new Audio;e.src={NODE_ENV:"production",VUE_APP_I18N_LOCALE:"zh",VUE_APP_I18N_FALLBACK_LOCALE:"zh",VUE_APP_IS_DEMO:"false",VUE_APP_BASE_DOMAIN:"https://uiadmin.net",VUE_APP_PUBLIC_PATH:"./",VUE_APP_CDN_DOMAIN:"https://cdn.jiangruyi.com",VUE_APP_DEPLOY_ALONE:"false",VUE_APP_BASE:"https://cdn.jiangruyi.com/vue/xyview-vue/dist/"}.VUE_APP_AUDIO_CLOSE,e.play()}}));break;default:switch(this.pitem.pageData&&"modal"==this.pitem.pageData.pageType&&(s.pageData.pageType=this.pitem.pageData.pageType),s.pageData.pageType){case"page":let e="";this.$store.state.menu.menuList.menuTree[this.$store.state.menu.currentSite].routePrefix&&(e=this.$store.state.menu.menuList.menuTree[this.$store.state.menu.currentSite].routePrefix),this.$router.push({path:e+"/pages"+s.pageData.api+o,query:p});break;case"drawer":case"modal":s.pageData.apiBlank=s.pageData.api+n,s.pageData.show=!0;break;default:alert("未指定按钮pageType")}}r.$nextTick((function(){"auto"!==s.pageData.height&&(r.$refs["right_modal_"+s.name][0].$el.querySelector(".el-dialog").querySelector(".el-dialog__body").style.overflowY="scroll",r.$refs["right_modal_"+s.name][0].$el.querySelector(".el-dialog").querySelector(".el-dialog__body").style.height=s.pageData.height)}))}))},getMenu(){return e(this,arguments,(function*(e=[]){const t=this.$message({message:"加载左侧导航菜单信息",duration:5e3});var i=[{path:"/",name:"root",redirect:"/home",meta:{title:"首页"},component:adminLayout,children:[{path:"/home",name:"home",meta:{title:"首页"},component:()=>a((()=>import("./home-d4efe1b3.js")),["static/js/home-d4efe1b3.js","index.js","static/css/index-fdd28e6e.css","static/js/flink-a9c943ec.js","static/css/flink-2af5a855.css","static/js/index-7e8f5191.js","static/css/index-693f2cf4.css","static/css/home-ae6427d2.css"])}]}];e.menuTree||(e={menuTree:[],menuList:[]});let r=this;if(!e.menuTree[0]){if(!this.$store.state.app.apiInfo.api.apiMenuTrees)return void alert("基础接口信息错误");let a=yield this.$xyutil.request({url:this.$store.state.app.apiInfo.api.apiBase+this.$store.state.app.apiInfo.api.apiMenuTrees,method:"get"});if("200"==a.code){let t=[];if(a.data.menu2routes)t=treeToList(a.data.listData.dataList,"children");else{treeToList(a.data.listData.dataList,"children");let e=yield this.$xyutil.request({url:this.$store.state.app.apiInfo.api.apiBase+this.$store.state.app.apiInfo.api.apiMenuLists,method:"get"});if("200"!=e.code)return alert(a.msg),!1;t=e.data.dataList}e={menuTree:a.data.listData.dataList,menuList:t},r.$store.dispatch("menu/setMenuList",e);let s=r.util.addMenuRoutes(e,this.$store.state.app.apiInfo);s&&(i[0].children=s),r.$router.addRoutes(i)}}t.close()}))}}};export{i as b};
