import{q as e}from"./qrlogin-b4eb9fbc.js";import{_ as o}from"../../index.js";const t={components:{qrlogin:e},data(){var e,o,t;return{isDemo:!1,qrloginShow:!0,qrloginType:null==(t=null==(o=null==(e=this.$store.state.app.siteInfo)?void 0:e.moduleConfig)?void 0:o.qrlogin)?void 0:t.type,verifyData:"",form:{rememberLogin:!1,loading:!1,account:"",password:""},ruleLogin:{account:[{required:!0,message:"请填写账号",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"},{type:"string",min:6,message:"密码至少6位",trigger:"blur"}]}}},created:function(){1==this.isDemo&&(this.form.account="jry",this.form.password="Windows9")},methods:{qrsuccess(){this.$xyutil.switchTab({url:"/"})},handleSubmit:function(){return e=this,o=null,t=function*(){let e=this.form;this.verifyData&&(e._verify=this.verifyData),this.form.loading=!0;let o=this;setTimeout((function(){o.form.loading=!1}),5e3);let t=yield this.$util.request({url:"/v1/core/user/login",data:e,method:"post"});if(200==t.code)this.$store.commit("user/setToken",t.data.token),this.$store.commit("user/setUserInfo",t.data.userInfo),this.verifyData&&this.$refs.sv.close(),this.$util.showToast({title:t.msg,icon:"success",duration:2e3}),this.verifyData="",this.$xyutil.switchTab({url:"/"});else{if(401003==t.code)return void this.$refs.sv.open(t.data.verifyList);this.$util.showToast({title:t.msg,icon:"loading",duration:3e3})}this.form.loading=!1},new Promise(((i,l)=>{var s=e=>{try{n(t.next(e))}catch(o){l(o)}},r=e=>{try{n(t.throw(e))}catch(o){l(o)}},n=e=>e.done?i(e.value):Promise.resolve(e.value).then(s,r);n((t=t.apply(e,o)).next())}));var e,o,t}}},i=window.Vue.resolveComponent,l=window.Vue.createVNode,s=window.Vue.createElementVNode,r=window.Vue.withCtx,n=window.Vue.withKeys,a=window.Vue.createTextVNode,d=window.Vue.vShow,u=window.Vue.withDirectives,c=window.Vue.openBlock,m=window.Vue.createElementBlock,f=window.Vue.createCommentVNode,h={id:"wrap",class:"wrap"},p={class:"main"},g=s("div",{class:"main-banner hidden-md-and-up"},[s("h1",{class:"title m-t"}," 账号中心 ")],-1),w={class:"container main-content"},y=["src"],v=s("div",{class:"title m-b-lg"}," 登录 ",-1),b={class:"agreement"},V={class:"actions flex"},x=[s("i",{class:"xyicon xyicon-qrcode"},null,-1),s("div",{class:"triangle-bottomleft"},null,-1)],q={key:0,class:"qrlogin-modal"},S={class:"flex space-between m-b"},_=s("div",{class:"ts-18"}," 登录 ",-1);const k=o(t,[["render",function(e,o,t,k,$,D){const C=i("xy-header"),T=i("el-col"),L=i("el-input"),U=i("el-form-item"),j=i("el-checkbox"),N=i("el-button"),P=i("xy-captcha"),I=i("router-link"),K=i("el-form"),z=i("qrlogin"),B=i("el-row"),E=i("xy-footer"),R=i("xy-safety-verify");return c(),m("div",h,[l(C),s("div",p,[g,s("div",w,[l(B,{type:"flex",justify:"space-between",align:"middle"},{default:r((()=>[l(T,{md:10,lg:11,class:"left-box hidden-sm-and-down"},{default:r((()=>[s("img",{src:e.$store.state.app.loginPic,width:"500"},null,8,y)])),_:1}),l(T,{xs:24,sm:{span:12,offset:5},md:{span:12,offset:2},lg:{span:9,offset:0},class:"login-box bg-white"},{default:r((()=>[v,l(K,{ref:"form",size:"large",model:$.form,rules:$.ruleLogin},{default:r((()=>[l(U,{prop:"account"},{default:r((()=>[l(L,{type:"text",prefix:"ios-person-outline",modelValue:$.form.account,"onUpdate:modelValue":o[0]||(o[0]=e=>$.form.account=e),placeholder:"请输入用户名、邮箱或手机号"},null,8,["modelValue"])])),_:1}),l(U,{prop:"password"},{default:r((()=>[l(L,{type:"password",prefix:"ios-lock-outline",modelValue:$.form.password,"onUpdate:modelValue":o[1]||(o[1]=e=>$.form.password=e),placeholder:"请输入密码",onKeyup:n(D.handleSubmit,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),s("div",b,[l(j,{modelValue:$.form.rememberLogin,"onUpdate:modelValue":o[2]||(o[2]=e=>$.form.rememberLogin=e)},{default:r((()=>[a("记住登录")])),_:1},8,["modelValue"])]),l(P,{onSuccess:D.handleSubmit},{default:r((()=>[l(N,{id:"Captcha",class:"full submit-btn",size:"large",loading:$.form.loading,type:"primary",onClick:D.handleSubmit},{default:r((()=>[a(" 登录 ")])),_:1},8,["loading","onClick"])])),_:1},8,["onSuccess"]),s("div",V,[s("div",null,[l(I,{to:"/user/resetPassword"},{default:r((()=>[a("忘记密码")])),_:1})]),s("div",null,[a(" 还没有账号？ "),l(I,{to:"/user/register"},{default:r((()=>[a("注册")])),_:1})])])])),_:1},8,["model","rules"]),u(s("div",{class:"qrlogin",onClick:o[3]||(o[3]=e=>{$.qrloginShow=!0})},x,512),[[d,!$.qrloginShow]]),$.qrloginShow?(c(),m("div",q,[s("div",S,[_,s("div",null,[s("span",{onClick:o[4]||(o[4]=e=>{$.qrloginShow=!1}),class:"cursor-pointer text-gray"},"账号密码登录")])]),l(z,{class:"text-center m-t-lg",qrloginShow:$.qrloginShow,type:$.qrloginType,onSuccess:D.qrsuccess},null,8,["qrloginShow","type","onSuccess"])])):f("",!0)])),_:1})])),_:1})])]),l(E),l(R,{modelValue:$.verifyData,"onUpdate:modelValue":o[5]||(o[5]=e=>$.verifyData=e),onVerifyRequest:D.handleSubmit,ref:"sv"},null,8,["modelValue","onVerifyRequest"])])}]]);export{k as default};
