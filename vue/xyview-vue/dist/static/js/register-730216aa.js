import{_ as e}from"../../index.js";const t={components:{},data:()=>({loading:!1,inviteSuffix:"",form:{countryCode:"+86",mobile:"",password:"",rePassword:"",verify:"",token:"",inviteCode:"",agreement:!1},rule:{mobile:[{required:!0,message:"请填写手机号",trigger:"blur"}],password:[{required:!0,message:"请填写密码",trigger:"blur"},{type:"string",min:6,message:"密码至少6位",trigger:"blur"}],verify:[{required:!0,message:"请填写验证码",trigger:"blur"}],token:[{required:!0,message:"请发送验证码",trigger:"blur"}]}}),created:function(){switch(this.$store.state.app.siteInfo.regInvite){case 1:this.inviteSuffix="（可选）";break;case 2:this.inviteSuffix="（必填）"}this.form.inviteCode=this.$store.state.app.inviteCode},methods:{onCountrySelect({name:e,iso2:t,dialCode:o}){this.form.countryCode="+"+o},getVerifyToken(e){this.form.token=e.token},handleSubmit(){return e=this,t=null,o=function*(){this.$store.commit("app/setData",{key:"inviteCode",value:this.form.inviteCode}),this.loading=!0;let e=this;setTimeout((function(){e.loading=!1}),5e3);let t=yield this.$util.request({url:"/v1/reg_mobile/user/register",data:this.form,method:"post"});"200"==t.code?(this.$util.showToast({title:t.msg,icon:"success",duration:2e3}),this.$store.commit("user/setToken",t.data.token),this.$store.commit("user/setUserInfo",t.data.userInfo),this.$emit("reg-success")):this.$util.showToast({title:t.msg,icon:"loading",duration:3e3}),this.loading=!1},new Promise(((i,r)=>{var l=e=>{try{a(o.next(e))}catch(t){r(t)}},n=e=>{try{a(o.throw(e))}catch(t){r(t)}},a=e=>e.done?i(e.value):Promise.resolve(e.value).then(l,n);a((o=o.apply(e,t)).next())}));var e,t,o}}},o=window.Vue.resolveComponent,i=window.Vue.createVNode,r=window.Vue.withCtx,l=window.Vue.openBlock,n=window.Vue.createBlock,a=window.Vue.createCommentVNode,s=window.Vue.createTextVNode,u=window.Vue.toDisplayString,d=window.Vue.createElementVNode,m={class:"agreement"},f=["href"],c=["href"],p={class:"actions flex"},g=d("div",null,null,-1);const h=e(t,[["render",function(e,t,h,y,v,V){const w=o("xy-country-select"),b=o("el-input"),k=o("el-form-item"),x=o("xy-send-verify"),C=o("el-checkbox"),_=o("el-button"),$=o("router-link"),S=o("el-form");return l(),n(S,{ref:"form",model:v.form,rules:v.rule},{default:r((()=>[i(k,{prop:"mobile"},{default:r((()=>[i(b,{size:"large",type:"text",prefix:"ios-at-outline",modelValue:v.form.mobile,"onUpdate:modelValue":t[0]||(t[0]=e=>v.form.mobile=e),placeholder:"请输入手机号"},{prepend:r((()=>[i(w,{defaultCountry:"CN",enabledCountryCode:"",onOnSelect:V.onCountrySelect},null,8,["onOnSelect"])])),_:1},8,["modelValue"])])),_:1}),i(k,{prop:"verify"},{default:r((()=>[i(b,{size:"large",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:v.form.verify,"onUpdate:modelValue":t[1]||(t[1]=e=>v.form.verify=e),placeholder:"请输入验证码"},{append:r((()=>[i(x,{onVerifysuccess:V.getVerifyToken,url:"/v1/sms/verify/send",type:"手机号",account:v.form.mobile,title:"用户注册"},null,8,["onVerifysuccess","account"])])),_:1},8,["modelValue"])])),_:1}),i(k,{prop:"password"},{default:r((()=>[i(b,{size:"large",type:"password",prefix:"ios-lock-outline",modelValue:v.form.password,"onUpdate:modelValue":t[2]||(t[2]=e=>v.form.password=e),placeholder:"请输入6-18位密码"},null,8,["modelValue"])])),_:1}),e.$store.state.app.siteInfo.regInvite>0?(l(),n(k,{key:0,prop:"inviteCode"},{default:r((()=>[i(b,{size:"large",type:"text",prefix:"ios-lock-outline",modelValue:v.form.inviteCode,"onUpdate:modelValue":t[3]||(t[3]=e=>v.form.inviteCode=e),placeholder:"请输入邀请码"+v.inviteSuffix},null,8,["modelValue","placeholder"])])),_:1})):a("",!0),d("div",m,[i(C,{modelValue:v.form.agreement,"onUpdate:modelValue":t[4]||(t[4]=e=>v.form.agreement=e)},{default:r((()=>[s("我已阅读并同意")])),_:1},8,["modelValue"]),d("a",{href:e.$util.baseDomain()+"/user_agreement/agreement/info.html?name=agreement",target:"_blacnk"}," 《"+u(e.$store.state.app.siteInfo.title)+"用户协议》 ",9,f),s(" 和 "),d("a",{href:e.$util.baseDomain()+"/user_agreement/agreement/info.html?name=privacy",target:"_blacnk"}," 《"+u(e.$store.state.app.siteInfo.title)+"隐私政策》 ",9,c)]),i(_,{class:"full submit-btn",size:"large",loading:v.loading,type:"primary",onClick:t[5]||(t[5]=e=>V.handleSubmit("form"))},{default:r((()=>[s(" 注册 ")])),_:1},8,["loading"]),d("div",p,[g,d("div",null,[s(" 已有账号？ "),i($,{to:"/user/login"},{default:r((()=>[s("登录")])),_:1})])])])),_:1},8,["model","rules"])}]]);export{h as default};
