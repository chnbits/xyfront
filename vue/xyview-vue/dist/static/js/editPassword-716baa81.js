import{_ as e}from"../../index.js";const l={data(){return{active:1,loading:!1,form:{email:this.$store.state.user.userInfo.email,verify:"",token:"",newPassword:"",rePassword:""},rule:{email:[{required:!0,message:"请填写邮箱",trigger:"blur"}],newPassword:[{required:!0,message:"请填写新密码",trigger:"blur"},{type:"string",min:6,message:"密码至少6位",trigger:"blur"}],rePassword:[{required:!0,message:"请填写新密码",trigger:"blur"},{type:"string",min:6,message:"密码至少6位",trigger:"blur"}],verify:[{required:!0,message:"请填写验证码",trigger:"blur"}],token:[{required:!0,message:"请发送验证码",trigger:"blur"}]}}},created:function(){var e;(null==(e=this.$store.state.user.userInfo.email)?void 0:e.identifier)||this.$util.showToast({title:"未绑定邮箱",icon:"loading",duration:3e3})},methods:{goStep2(){this.form.email&&this.form.verify&&this.form.token?this.active++:this.$util.showToast({title:"验证失败",icon:"loading",duration:3e3})},getVerifyToken(e){this.form.token=e},handleSubmit(){return e=this,l=null,t=function*(){this.loading=!0;let e=this;setTimeout((function(){e.loading=!1}),5e3);let l=yield this.$util.request({url:"/v1/reg_email/user/restPassword",data:this.form,method:"post"});"200"==l.code?(this.$util.showToast({title:l.msg,icon:"success",duration:2e3}),this.active++):this.$util.showToast({title:l.msg,icon:"loading",duration:3e3}),this.loading=!1},new Promise(((i,o)=>{var r=e=>{try{a(t.next(e))}catch(l){o(l)}},s=e=>{try{a(t.throw(e))}catch(l){o(l)}},a=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,s);a((t=t.apply(e,l)).next())}));var e,l,t}}},t=window.Vue.createTextVNode,i=window.Vue.resolveComponent,o=window.Vue.withCtx,r=window.Vue.createVNode,s=window.Vue.createElementVNode,a=window.Vue.openBlock,d=window.Vue.createBlock,n=window.Vue.createCommentVNode,u=window.Vue.createElementBlock,m=window.Vue.pushScopeId,c=window.Vue.popScopeId,f=e=>(m("data-v-a2b8433f"),e=e(),c(),e),p={class:"box"},w={class:"p-t"},g={class:"content p-t-md"},y={class:"step-tabs"},v=f((()=>s("div",{class:"m-b-md ts-12 tw4",style:{color:"#2A2B2E"}},"为确认您本人操作，需要您进行邮箱验证码验证身份。",-1))),h={class:"flex"},b={class:"m-t-lg"},V=f((()=>s("div",{class:"m-b-md ts-18 tw4"},"请输入您的登录密码",-1))),k={class:"m-t-lg"},x={key:2},_=f((()=>s("div",null,[s("i",{class:"xyicon xyicon-check3 ts-30 m-r-sm",style:{color:"#4AC711"}}),s("span",{class:"ts-20 tw4",style:{color:"#2A2B2E"}},"修改登录密码成功，请您牢记密码。")],-1))),P={class:"m-t-lg"},C=f((()=>s("span",{slot:"title",class:"ts-14"},[s("i",{class:"xyicon xyicon-help-o m-r-xs text-primary"}),s("span",null,"收不到验证码？")],-1))),z=f((()=>s("div",{class:"lh-2 ts-12 p-l"},[t(" 1、网络通讯异常可能会造成邮箱丢失，请重新获取或稍后再试。"),s("br"),t(" 2、请核实邮箱邮件是否被拦截，检查垃圾箱。"),s("br"),t(" 3、如果邮箱已经停用， 请选择其他验证方式 。"),s("br")],-1)));const T=e(l,[["render",function(e,l,m,c,f,T){const $=i("el-breadcrumb-item"),q=i("el-breadcrumb"),S=i("el-step"),B=i("el-steps"),I=i("el-input"),E=i("el-form-item"),N=i("xy-send-verify"),U=i("el-button"),A=i("el-link"),j=i("el-form"),D=i("router-link"),F=i("el-alert");return a(),u("div",null,[s("div",p,[s("div",w,[r(q,{"separator-class":"el-icon-arrow-right",class:"p-l m-b"},{default:o((()=>[r($,{to:{path:"/user/center"}},{default:o((()=>[t("个人设置")])),_:1}),r($,null,{default:o((()=>[t("修改密码")])),_:1})])),_:1})]),s("div",g,[r(B,{active:f.active,simple:"","align-left":""},{default:o((()=>[r(S,{title:"验证邮箱",description:""}),r(S,{title:"输入新密码",description:""}),r(S,{title:"修改成功",description:""})])),_:1},8,["active"]),s("div",y,[1==f.active?(a(),d(j,{key:0,ref:"form","label-position":"left","label-width":"140px",model:f.form,rules:f.rule},{default:o((()=>[v,r(E,{prop:"email",label:"邮箱"},{default:o((()=>[r(I,{disabled:"",size:"default",type:"text",prefix:"ios-at-outline",modelValue:f.form.email,"onUpdate:modelValue":l[0]||(l[0]=e=>f.form.email=e),placeholder:f.form.mobile?"邮箱":"未绑定邮箱"},null,8,["modelValue","placeholder"])])),_:1}),r(E,{prop:"verify",label:"验证码"},{default:o((()=>[s("div",h,[r(I,{class:"m-r",size:"default",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:f.form.verify,"onUpdate:modelValue":l[1]||(l[1]=e=>f.form.verify=e),placeholder:"请输入邮箱验证码"},null,8,["modelValue"]),r(U,{type:"primary",size:"default"},{default:o((()=>[r(N,{onVerifysuccess:T.getVerifyToken,url:"/v1/email/verify/send",type:"邮箱",account:f.form.email,title:"修改密码"},null,8,["onVerifysuccess","account"])])),_:1})])])),_:1}),s("div",b,[r(U,{class:"submit-btn primary-linear m-r",size:"default",loading:f.loading,type:"primary",onClick:T.goStep2},{default:o((()=>[t(" 下一步 ")])),_:1},8,["loading","onClick"]),r(A,{class:"back ts-14",onClick:l[2]||(l[2]=l=>e.$router.back())},{default:o((()=>[t("取消操作")])),_:1})])])),_:1},8,["model","rules"])):n("",!0),2==f.active?(a(),d(j,{key:1,ref:"formVerifyPassword","label-position":"left","label-width":"140px",model:f.form,rules:f.rule},{default:o((()=>[V,r(E,{prop:"newPassword",label:"输入新的密码"},{default:o((()=>[r(I,{size:"default",type:"password",prefix:"ios-lock-outline",modelValue:f.form.newPassword,"onUpdate:modelValue":l[3]||(l[3]=e=>f.form.newPassword=e),placeholder:"输入新的密码"},null,8,["modelValue"])])),_:1}),r(E,{prop:"rePassword",label:"再次输入"},{default:o((()=>[r(I,{size:"default",type:"password",prefix:"ios-lock-outline",modelValue:f.form.rePassword,"onUpdate:modelValue":l[4]||(l[4]=e=>f.form.rePassword=e),placeholder:"再次输入"},null,8,["modelValue"])])),_:1}),s("div",k,[r(U,{class:"submit-btn primary-linear m-r",size:"default",loading:f.loading,type:"primary",onClick:l[5]||(l[5]=e=>T.handleSubmit("form"))},{default:o((()=>[t(" 下一步 ")])),_:1},8,["loading"]),r(A,{class:"back ts-14",onClick:l[6]||(l[6]=e=>f.active--)},{default:o((()=>[t("返回上一步")])),_:1})])])),_:1},8,["model","rules"])):n("",!0),3==f.active?(a(),u("div",x,[_,s("div",P,[r(D,{to:"/user/login"},{default:o((()=>[r(U,{class:"primary-linear",size:"small",type:"primary",round:""},{default:o((()=>[t("重新登录")])),_:1})])),_:1})])])):n("",!0)])])]),s("div",null,[r(F,{type:"primary"},{default:o((()=>[C,z])),_:1})])])}],["__scopeId","data-v-a2b8433f"]]);export{T as default};
