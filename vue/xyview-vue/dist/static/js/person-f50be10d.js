var e=Object.defineProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(l,t,o)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[t]=o,r=(e,r)=>{for(var a in r||(r={}))t.call(r,a)&&i(e,a,r[a]);if(l)for(var a of l(r))o.call(r,a)&&i(e,a,r[a]);return e},a=(e,l,t)=>new Promise(((o,i)=>{var r=e=>{try{s(t.next(e))}catch(l){i(l)}},a=e=>{try{s(t.throw(e))}catch(l){i(l)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,a);s((t=t.apply(e,l)).next())}));import{_ as s}from"../../index.js";const n={name:"personcer",components:{},data(){var e,l,t,o,i,r;return{loading:!1,sizeLimit:2,options:{type:"image",drag:!0,driver:this.$store.state.app.uploadDriver,signUrl:"",icon:"",placeholder:"",action:"",format:"jpg,png",maxSize:1024*this.sizeLimit,hasUploadModule:!0},change:(null==(l=null==(e=this.$route)?void 0:e.query)?void 0:l.change)?this.$route.query.change:"",countryCode:null==(o=null==(t=this.$store.state.user.userInfo)?void 0:t.mobile)?void 0:o.identityGroup,mobile:null==(i=this.$store.state.user.userInfo)?void 0:i.mobile,email:null==(r=this.$store.state.user.userInfo)?void 0:r.email,mobileVerify:{countryCode:"+86",mobile:"",verify:"",token:""},emailVerify:{email:"",verify:"",token:""},form:{country:"+86",certCate:1,certType:1,realName:"",certNo:"",certPhoto:"",certPhotoInverse:""},mobileHelpUpload:!1,mobileHelpUploadId:"",mobileHelpUploadUrl:"",mobileHelpUploadTimer:null}},created(){this.mobile&&(this.mobileVerify.countryCode=this.countryCode,this.mobileVerify.mobile=this.mobile),this.email&&(this.emailVerify.email=this.email),this.loadData();var e=new Date;this.mobileHelpUploadId=e.getTime(),this.mobileHelpUploadUrl=this.$util.baseDomain()+"/user_cert/cert/mobileUpload?cate=1&id="+this.mobileHelpUploadId},watch:{"form.certPhoto":{handler(e){},deep:!0,immediate:!1}},methods:{test(){},getOcrInfo(e,l){return a(this,null,(function*(){if(!l)return;let t={};switch(this.form.certCate){case 1:t.side=e,t.url=l;break;case 2:t.url=l}let o=yield this.$util.request({url:"/v1/user_cert/cert/getOcrInfo",data:r({certCate:this.form.certCate},t),method:"post"});200==o.code?(this.form.realName=o.data.realName,this.form.certNo=o.data.certNo):this.$util.showToast({title:o.msg,icon:"loading",duration:3e3})}))},isChinese(e){if(""!=e&&!/^[\u0391-\uFFE5]+$/.test(e))return alert("必须输入中文！"),!1},onCountrySelect({name:e,iso2:l,dialCode:t}){this.mobileVerify.countryCode="+"+t},getMobileVerifyToken(e){this.mobileVerify.token=e.token},getEmailVerifyToken(e){this.emailVerify.token=e.token},mobileUpload(){this.mobileHelpUpload=!0,this.mobileHelpUploadTimer=setInterval(this.syncMobileUploadStatue,3e3)},syncMobileUploadStatue(){return a(this,null,(function*(){let e=yield this.$util.request({url:"/v1/core/index/cache",data:{id:this.mobileHelpUploadId},method:"get"});200==e.code&&e.data.info&&(this.form.certPhoto=e.data.info.certPhoto,this.form.certPhotoInverse=e.data.info.certPhotoInverse)}))},loadData(){return a(this,null,(function*(){if(this.change)return;this.loading=!0;let e=yield this.$util.request({url:"/v1/user_cert/cert/my",data:{},method:"get"});200==e.code?e.data.info&&(this.form=e.data.info):this.$util.showToast({title:e.msg,icon:"loading",duration:3e3}),this.loading=!1}))},cofirm(){this.$confirm('确定要使用该身份（<span style="color: var(--primary-color)">'+this.form.realName+"  "+this.form.certNo+'</span>）进行实名认证吗？请确保您是该<span style="color: var(--primary-color)">实名信息本人</span>，否则下一步无法通过验证',"确定使用该信息进行认证吗？",{distinguishCancelAndClose:!0,confirmButtonText:"我很确定",cancelButtonText:"返回修改",dangerouslyUseHTMLString:!0}).then((()=>{this.handleSubmit()})).catch((e=>{}))},handleSubmit(){return a(this,null,(function*(){var e,l;this.form.change=this.change,!this.email&&this.$xyutil.hasExt("reg_email")&&(this.form.emailVerify=this.emailVerify),!this.mobile&&this.$xyutil.hasExt("reg_mobile")&&(this.form.mobileVerify=this.mobileVerify),this.loading=!0;let t=this;setTimeout((function(){t.loading=!1}),5e3);let o=yield this.$util.request({url:(null==(e=this.form)?void 0:e.id)&&!this.change?"/v1/user_cert/cert/edit":"/v1/user_cert/cert/add",data:this.form,method:(null==(l=this.form)?void 0:l.id)&&!this.change?"put":"post"});"200"==o.code?(this.$util.showToast({title:o.msg,icon:"success",duration:2e3}),this.$router.push({path:"/user_cert/faceid/person"})):this.$util.showToast({title:o.msg,icon:"loading",duration:3e3}),this.loading=!1}))}}},d=window.Vue.createTextVNode,u=window.Vue.resolveComponent,m=window.Vue.withCtx,c=window.Vue.createVNode,p=window.Vue.createElementVNode,h=window.Vue.openBlock,f=window.Vue.createBlock,y=window.Vue.createCommentVNode,b=window.Vue.Fragment,g=window.Vue.createElementBlock,V=window.Vue.resolveDirective,v=window.Vue.withDirectives,x=window.Vue.toDisplayString,w=window.Vue.pushScopeId,_=window.Vue.popScopeId,k=e=>(w("data-v-b56992a5"),e=e(),_(),e),U={class:"bg-white p-t p-b"},C={class:"content p-a-md m-t-lg"},$=k((()=>p("h3",{class:"m-b-md ts-22 text-center"},"请填写个人信息",-1))),I=k((()=>p("div",{class:"m-b-lg text-666 text-left flex space-center"},[p("p",{class:"lh-1-6 ts-14",style:{"max-width":"500px"}}," 适用个人用户，账号使用权属于个人。个人实名认证的账号产生消费时可以开具普票，不支持开具专票； 如果此账号将会是企业使用，您应当避免使用个人实名，应返回上一页选择企业实名认证选项。 ")],-1))),N={class:"inline-flex justify-between"},P=k((()=>p("span",null,"身份证照片",-1))),T={class:"flex flex-alignCenter flex-center",style:{width:"120px",height:"120px",background:"#05B9CF"}},z=k((()=>p("span",null,"点击或拖拽",-1))),E=k((()=>p("i",{class:"xyicon xyicon-plus",style:{"font-size":"48px",color:"#E1E1E1","margin-top":"18px","margin-bottom":"20px"}},null,-1))),q=k((()=>p("span",null,"上传身份证正面照片（头像面）",-1))),S=k((()=>p("span",null,"点击或拖拽",-1))),H=k((()=>p("i",{class:"xyicon xyicon-plus",style:{"font-size":"48px",color:"#E1E1E1","margin-top":"18px","margin-bottom":"20px"}},null,-1))),O=k((()=>p("span",null,"上传身份证反面照片(国徽面)",-1))),j={class:"flex"},D={class:"flex"},B={class:"m-t-lg flex space-between"},M={class:"m-r"},F={class:"help p-l-lg p-r-lg p-t-md"},L={class:"lh-1-6 ts-14"},G=k((()=>p("li",null,"1. 手机号码的实名信息需要与上传身份证照片身份信息一致的； ",-1))),A=k((()=>p("li",null,"3. 需要对证件现场拍照，且保证文字和图片、人像团等拍摄清晰可见",-1)));const J=s(n,[["render",function(e,l,t,o,i,r){const a=u("el-breadcrumb-item"),s=u("el-breadcrumb"),n=u("xy-qrcode"),w=u("el-popover"),_=u("xy-upload"),k=u("el-form-item"),J=u("el-input"),K=u("xy-country-select"),Q=u("router-link"),R=u("xy-send-verify"),W=u("el-button"),X=u("el-form"),Y=u("el-col"),Z=u("el-row"),ee=V("loading");return h(),g("div",U,[c(s,{"separator-class":"el-icon-arrow-right",class:"p-l m-b"},{default:m((()=>[c(a,{to:{path:"/user/center"}},{default:m((()=>[d("个人设置")])),_:1}),c(a,null,{default:m((()=>[d("个人用户实名认证")])),_:1})])),_:1}),p("div",C,[$,I,v((h(),f(Z,{type:"flex",justify:"center",align:"middle"},{default:m((()=>[c(Y,{xs:22,sm:12,md:10,lg:10,class:"login-box bg-white"},{default:m((()=>[c(X,{ref:"form",model:i.form,"label-position":"top"},{default:m((()=>[c(k,{prop:"certPhoto",label:"身份证照片",required:""},{label:m((()=>[p("div",N,[P,c(w,{placement:"top-start",title:"手机辅助上传",width:"120px",trigger:"click"},{reference:m((()=>[p("span",{onClick:l[0]||(l[0]=(...e)=>r.mobileUpload&&r.mobileUpload(...e)),class:"cursor-pointer ts-14 m-l-lg hidden"},"手机辅助上传")])),default:m((()=>[p("div",T,[c(n,{class:"qrcode",style:{opacity:1},value:i.mobileHelpUploadUrl,options:{width:120}},null,8,["value"])])])),_:1})])])),default:m((()=>[p("div",null,[c(_,{options:i.options,header:{},modelValue:i.form.certPhoto,"onUpdate:modelValue":l[1]||(l[1]=e=>i.form.certPhoto=e)},{drag:m((()=>[z,E,q])),_:1},8,["options","modelValue"])])])),_:1}),c(k,{prop:"certPhotoInverse",required:""},{default:m((()=>[c(_,{options:i.options,header:{},modelValue:i.form.certPhotoInverse,"onUpdate:modelValue":l[2]||(l[2]=e=>i.form.certPhotoInverse=e)},{drag:m((()=>[S,H,O])),_:1},8,["options","modelValue"])])),_:1}),c(k,{prop:"realName",label:"真实姓名",required:""},{default:m((()=>[c(J,{size:"large",type:"text",prefix:"ios-lock-outline",modelValue:i.form.realName,"onUpdate:modelValue":l[3]||(l[3]=e=>i.form.realName=e),placeholder:"请输入身份证上的真实姓名"},null,8,["modelValue"])])),_:1}),c(k,{prop:"certNo",label:"身份证号码",required:""},{default:m((()=>[c(J,{size:"large",type:"text",prefix:"ios-lock-outline",modelValue:i.form.certNo,"onUpdate:modelValue":l[4]||(l[4]=e=>i.form.certNo=e),placeholder:"请输入18位二代身份证号码"},null,8,["modelValue"])])),_:1}),e.$util.hasExt("reg_mobile")?(h(),g(b,{key:0},[c(k,{prop:"mobile",label:"手机号验证",required:""},{default:m((()=>[c(J,{size:"large",type:"text",prefix:"ios-person-outline",disabled:!!this.mobile,modelValue:i.mobileVerify.mobile,"onUpdate:modelValue":l[5]||(l[5]=e=>i.mobileVerify.mobile=e),placeholder:"请输入您的手机号码"},{prepend:m((()=>[c(K,{defaultCountry:"CN",enabledCountryCode:"",onOnSelect:r.onCountrySelect},null,8,["onOnSelect"])])),_:1},8,["disabled","modelValue"]),p("div",null,[this.mobile?(h(),f(Q,{key:0,to:"/reg_mobile/user/change",class:"ts-12"},{default:m((()=>[d("修改手机号")])),_:1})):y("",!0)])])),_:1}),this.mobile?y("",!0):(h(),f(k,{key:0,prop:"verify"},{default:m((()=>[p("div",null,[p("div",j,[c(J,{size:"large",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:i.mobileVerify.verify,"onUpdate:modelValue":l[6]||(l[6]=e=>i.mobileVerify.verify=e),placeholder:"请输入手机验证码"},null,8,["modelValue"]),c(W,{type:"primary",size:"large",class:"m-l-md"},{default:m((()=>[c(R,{onVerifysuccess:r.getMobileVerifyToken,url:"/v1/sms/verify/send",type:"手机号",account:"mobileVerify.mobile",title:"手机绑定"},null,8,["onVerifysuccess"])])),_:1})])])])),_:1}))],64)):y("",!0),e.$util.hasExt("reg_email")?(h(),g(b,{key:1},[c(k,{prop:"email",label:"邮箱验证",required:""},{default:m((()=>[c(J,{size:"large",type:"text",prefix:"ios-person-outline",disabled:!!this.email,modelValue:i.emailVerify.email,"onUpdate:modelValue":l[7]||(l[7]=e=>i.emailVerify.email=e),placeholder:"请输入您的邮箱账号"},null,8,["disabled","modelValue"]),p("div",null,[this.email?(h(),f(Q,{key:0,to:"/reg_email/user/change",class:"ts-12"},{default:m((()=>[d("修改邮箱")])),_:1})):y("",!0)])])),_:1}),this.email?y("",!0):(h(),f(k,{key:0,prop:"verify"},{default:m((()=>[p("div",null,[p("div",D,[c(J,{size:"large",autocomplete:"off",type:"text",prefix:"ios-lock-outline",modelValue:i.mobileVerify.verify,"onUpdate:modelValue":l[8]||(l[8]=e=>i.mobileVerify.verify=e),placeholder:"请输入邮箱验证码"},null,8,["modelValue"]),c(W,{type:"primary",size:"large",class:"m-l-md"},{default:m((()=>[c(R,{onVerifysuccess:r.getEmailVerifyToken,url:"/v1/email/verify/send",type:"邮箱",account:"emailVerify.mobile",title:"邮箱绑定"},null,8,["onVerifysuccess"])])),_:1})])])])),_:1}))],64)):y("",!0),p("div",B,[p("div",M,[c(W,{class:"full",size:"large",onClick:l[9]||(l[9]=l=>e.$router.back(-1))},{default:m((()=>[d("上一步")])),_:1})]),c(W,{class:"full submit-btn m-b-lg",size:"large",loading:i.loading,type:"primary",onClick:l[10]||(l[10]=e=>r.cofirm())},{default:m((()=>[d(" 下一步 ")])),_:1},8,["loading"])])])),_:1},8,["model"])])),_:1})])),_:1})),[[ee,i.loading]]),p("div",F,[p("ul",L,[G,p("li",null,"2. 上传单张照片大小不超过"+x(i.sizeLimit)+"MB，支持PNG、JPG格式；",1),A,p("li",null,"4. 支持对照片添加加水印，如添加水印文字：仅限"+x(e.$store.state.app.siteInfo.title)+"实名认证使用，注意不要遮挡文字和图案。",1)])])])])}],["__scopeId","data-v-b56992a5"]]);export{J as default};
