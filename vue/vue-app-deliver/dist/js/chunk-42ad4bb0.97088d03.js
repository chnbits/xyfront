(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-42ad4bb0","chunk-f350bf22"],{"11c3":function(e,t,n){},"190a":function(e,t,n){},5383:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._l(e.publicAttrCates,(function(t,a){return n("div",{key:a},[n("div",{staticClass:"title tw4 ts-16 m-b-xs m-t"},[e._v(e._s(t.title))]),n("div",{staticClass:"box bg-white"},[n("el-form",{attrs:{model:e.extendInfo[t.name],"label-width":"140px","label-suffix":":",size:"medium"}},e._l(t.attrList,(function(a,i){return n("div",{key:i},[n("el-form-item",{attrs:{label:a.title}},["text"==a.type?[n("el-input",{attrs:{size:"medium",placeholder:a.placeholder},model:{value:e.extendInfo[t.name][a.name],callback:function(n){e.$set(e.extendInfo[t.name],a.name,n)},expression:"extendInfo[item.name][item1.name]"}})]:"select"==a.type?[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.extendInfo[t.name][a.name],callback:function(n){e.$set(e.extendInfo[t.name],a.name,n)},expression:"extendInfo[item.name][item1.name]"}},e._l(a.options,(function(t,a){return n("el-option",{key:a,attrs:{label:t.title,value:e.getOptionValue(t)}})})),1)]:"cascader2"==a.type?[n("XyCascader2",{attrs:{options:a.options},model:{value:e.extendInfo[t.name][a.name],callback:function(n){e.$set(e.extendInfo[t.name],a.name,n)},expression:"extendInfo[item.name][item1.name]"}})]:"radio"==a.type?[n("el-radio-group",{model:{value:e.extendInfo[t.name][a.name],callback:function(n){e.$set(e.extendInfo[t.name],a.name,n)},expression:"extendInfo[item.name][item1.name]"}},e._l(a.options,(function(t,a){return n("el-radio",{key:a,attrs:{label:e.getOptionValue(t)}},[e._v(" "+e._s(t.title)+" ")])})),1)]:"checkbox"==a.type?[n("el-checkbox-group",{model:{value:e.extendInfo[t.name][a.name],callback:function(n){e.$set(e.extendInfo[t.name],a.name,n)},expression:"extendInfo[item.name][item1.name]"}},e._l(a.options,(function(t,a){return n("el-checkbox",{key:a,attrs:{label:e.getOptionValue(t)}},[e._v(" "+e._s(t.title)+" ")])})),1)]:e._e()],2),a.tip?n("div",{staticClass:"text-gray ts-12 m-l-md"},[n("i",{staticClass:"xyicon xyicon-help-o m-r-xs"}),n("span",[e._v(e._s(a.tip))])]):e._e()],1)})),0),n("div",{staticClass:"p-b",staticStyle:{width:"100%"}},[n("el-button",{staticClass:"fr",attrs:{size:"medium",type:"primary"},on:{click:function(n){return e.saveInfo(t.name)}}},[e._v("保存设置")])],1)],1)])})),e.userTypeList.length>0?n("div",[n("div",{staticClass:"title tw4 ts-16 m-b-xs m-t"},[e._v("联系信息")]),n("div",{staticClass:"box bg-white"},[n("div",[n("el-form",{attrs:{"label-width":"140px","label-suffix":":"}},[n("el-form-item",{attrs:{label:"身份"}},[n("el-radio-group",{model:{value:e.userType,callback:function(t){e.userType=t},expression:"userType"}},e._l(e.userTypeList,(function(t,a){return n("el-radio",{key:a,attrs:{label:t.id}},[e._v(" "+e._s(t.title)+" ")])})),1)],1)],1)],1),e._l(e.userTypeList,(function(t,a){return n("div",{key:a},[t.id==e.userType?[e._l(t.attrCates,(function(t,a){return n("div",{key:a},[n("el-form",{attrs:{model:e.extendInfo[t.name],"label-width":"140px","label-suffix":":"}},e._l(t.attrList,(function(a,i){return n("div",{key:i},[n("el-form-item",{attrs:{label:a.title}},["text"==a.type?[n("el-input",{attrs:{size:"medium",placeholder:a.placeholder},model:{value:e.extendInfo[t.name][a.name],callback:function(n){e.$set(e.extendInfo[t.name],a.name,n)},expression:"extendInfo[item.name][item1.name]"}})]:"select"==a.type?[n("el-select",{attrs:{placeholder:"请选择"},model:{value:e.extendInfo[t.name][a.name],callback:function(n){e.$set(e.extendInfo[t.name],a.name,n)},expression:"extendInfo[item.name][item1.name]"}},e._l(a.options,(function(t,a){return n("el-option",{key:a,attrs:{label:t.title,value:e.getOptionValue(t)}})})),1)]:"radio"==a.type?[n("el-radio-group",{model:{value:e.extendInfo[t.name][a.name],callback:function(n){e.$set(e.extendInfo[t.name],a.name,n)},expression:"extendInfo[item.name][item1.name]"}},e._l(a.options,(function(t,a){return n("el-radio",{key:a,attrs:{label:e.getOptionValue(t)}},[e._v(" "+e._s(t.title)+" ")])})),1)]:"checkbox"==a.type?[n("el-checkbox-group",{model:{value:e.extendInfo[t.name][a.name],callback:function(n){e.$set(e.extendInfo[t.name],a.name,n)},expression:"extendInfo[item.name][item1.name]"}},e._l(a.options,(function(t,a){return n("el-checkbox",{key:a,attrs:{label:e.getOptionValue(t)}},[e._v(" "+e._s(t.title)+" ")])})),1)]:"region"==a.type?[n("XyCascader",{attrs:{init:e.regionInit},model:{value:e.extendInfo[t.name][a.name],callback:function(n){e.$set(e.extendInfo[t.name],a.name,n)},expression:"extendInfo[item.name][item1.name]"}})]:e._e(),a.tip?n("div",{staticClass:"text-gray ts-12"},[n("i",{staticClass:"xyicon xyicon-help-o m-r-xs"}),n("span",[e._v(e._s(a.tip))])]):e._e()],2)],1)})),0)],1)})),n("div",{staticClass:"p-b m-r-lg",staticStyle:{width:"100%"}},[n("el-button",{staticClass:"fr",attrs:{size:"medium",type:"primary"},on:{click:function(n){return e.saveTypeInfo(t.attrCateNames)}}},[e._v("保存设置")])],1)]:e._e()],2)}))],2)]):e._e()],2)},i=[],s=n("1da1"),r=(n("96cf"),n("ac1f"),n("1276"),n("159b"),n("8daf")),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("el-select",{staticClass:"block",attrs:{placeholder:"请选择"},on:{change:e.onSelectChange},model:{value:e.content[0],callback:function(t){e.$set(e.content,0,t)},expression:"content[0]"}},e._l(e.options,(function(e,t){return n("el-option",{key:t,attrs:{label:e.title,value:e.value}})})),1)],1),n("el-radio-group",{staticClass:"m-t",on:{change:e.onChange},model:{value:e.content[1],callback:function(t){e.$set(e.content,1,t)},expression:"content[1]"}},e._l(e.optionsLevel2,(function(t,a){return n("el-radio",{key:a,attrs:{label:t.value,border:""}},[e._v(" "+e._s(t.title)+" ")])})),1)],1)},l=[],c=n("ade3"),u=(n("c740"),Object(c["a"])({name:"XyCascader2",props:{value:{type:[],default:""},options:Array,header:{type:Object,default:function(){return{cloudId:0,eid:0}}}},data:function(){return{content:[],optionsLevel2:[]}},created:function(){var e,t=this,n="";0!=this.value.length&&Array.isArray(this.value)?this.content=this.value:this.value=["",""],this.content[0]&&(n=this.options.findIndex((function(e){return e.value===t.content[0]}))),this.options[n]&&null!==(e=this.options[n])&&void 0!==e&&e.children?this.optionsLevel2=this.options[n].children:this.optionsLevel2=[]},watch:{value:function(e){var t=this;0!=this.value.length&&Array.isArray(this.value)?this.content=this.value:this.value=["",""],this.content[0]&&(index=this.options.findIndex((function(e){return e.value===t.content[0]}))),this.options[index].children?this.optionsLevel2=this.options[index].children:this.optionsLevel2=[]}},methods:{onSelectChange:function(){var e=this,t=this.options.findIndex((function(t){return t.value===e.content[0]}));this.options[t].children?this.optionsLevel2=this.options[t].children:this.optionsLevel2=[],this.content[1]=""},onChange:function(){this.$emit("input",this.content)}}},"watch",{})),d=u,p=n("2877"),f=Object(p["a"])(d,o,l,!1,null,"17238126",null),m=f.exports,v={name:"editExtendInfo",components:{XyCascader:r["a"],XyCascader2:m},data:function(){return{loading:!1,extendInfo:{},publicAttrCates:[],userTypeList:[],userType:1,regionInit:{showInput:!1,labelField:"name",valueField:"name",deep:1,maxLevel:3,nodeKey:"id",lazy:!0,action:"/v1/region/region/lists"}}},created:function(){this.loadData()},watch:{"extendInfo.own.country":{handler:function(e){this.regionInit.showInput="中国"!=e},deep:!0,immediate:!0},"extendInfo.org.country":{handler:function(e){this.regionInit.showInput="中国"!=e},deep:!0,immediate:!0}},methods:{getOptionValue:function(e){return null!==e&&void 0!==e&&e.value?null===e||void 0===e?void 0:e.value:null===e||void 0===e?void 0:e.title},saveTypeInfo:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e=e.split(","),a={},e.forEach((function(e){a[e]=t.extendInfo[e]})),n.next=5,t.util.request({url:"/v1/user/user/extendInfo",data:{userType:t.usertype,extendInfo:a},method:"put"});case 5:i=n.sent,200==i.code?t.util.showToast({title:i.msg,icon:"loading",duration:2e3}):t.util.showToast({title:i.msg,icon:"loading",duration:3e3});case 7:case"end":return n.stop()}}),n)})))()},saveInfo:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a={},a[e]=t.extendInfo[e],n.next=4,t.util.request({url:"/v1/user/user/extendInfo",data:{extendInfo:a},method:"put"});case 4:i=n.sent,200==i.code?t.util.showToast({title:i.msg,icon:"loading",duration:2e3}):t.util.showToast({title:i.msg,icon:"loading",duration:3e3});case 6:case"end":return n.stop()}}),n)})))()},loadData:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.util.request({url:"/v1/user/user/extendInfo",data:{},method:"get"});case 2:n=e.sent,200==n.code?(t.userTypeList=n.data.userTypeList,t.publicAttrCates=n.data.publicAttrCates,t.extendInfo=n.data.extendInfo):t.util.showToast({title:n.msg,icon:"loading",duration:3e3});case 4:case"end":return e.stop()}}),e)})))()}}},h=v,x=(n("fa03"),Object(p["a"])(h,a,i,!1,null,"65559fd2",null));t["default"]=x.exports},"5e96":function(e,t,n){"use strict";n("11c3")},6814:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("div",{staticClass:"m-b-sm"},[n("el-button",{staticClass:"m-r",attrs:{type:"primary",size:"small"}},[e._v("个人资料设置")]),n("router-link",{attrs:{to:"/user_cert/cert/index"}},[n("el-button",{attrs:{type:"primary",size:"small",plain:""}},[e._v("实名认证")])],1)],1),n("div",{staticClass:"box profile-box"},[n("div",{staticClass:"content flex flex-alignCenter"},[n("div",{staticClass:"avatar-box text-center"},[n("el-avatar",{attrs:{size:118,src:e.$store.state.user.userInfo.avatar}}),n("div",[n("el-link",{on:{click:function(t){e.showEditAvatar=!0}}},[e._v("修改")])],1)],1),n("div",{staticClass:"profile"},[n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v("用户名(账户ID）:")]),n("span",[e._v(e._s(e.$store.state.user.userInfo.id))]),n("span",{staticClass:"title m-l-lg"},[e._v("注册时间：")]),n("span",[e._v(e._s(e._f("formatTime")(e.$store.state.user.userInfo.registerTime)))])]),n("div",{staticClass:"item"},[n("span",[e._v("实名认证：")]),e.$store.state.user.userInfo.moduleExtend.user_cert?[1==e.$store.state.user.userInfo.moduleExtend.user_cert.certCate?n("el-tag",{staticClass:"m-r",attrs:{type:"success",effect:"light",size:"small"}},[e._v("个人实名认证")]):e._e(),2==e.$store.state.user.userInfo.moduleExtend.user_cert.certCate?n("el-tag",{staticClass:"m-r",attrs:{type:"success",effect:"light",size:"small"}},[e._v("企业实名认证")]):e._e()]:n("el-tag",{staticClass:"m-r",attrs:{type:"warning",effect:"light",size:"small"}},[e._v("未认证")]),n("router-link",{staticClass:"ts-14",attrs:{to:"/user_cert/cert/index"}},[e._v("详情")])],2),n("div",{staticClass:"item flex flex-alignCenter"},[n("span",{staticClass:"title"},[e._v("当前账户安全级别：")]),n("xy-safety-level",{attrs:{level:e.$store.state.user.userInfo.moduleExtend.user.safetyLevel}})],1),n("div",{staticClass:"tip"},[n("i",{staticClass:"xyicon xyicon-help-o m-r-xs"}),e.$store.state.user.userInfo.moduleExtend.user.safetyLevel<3?n("span",[e._v(" 当前安全级别较低，建议完善个人资料或者修改登录密码 ")]):e._e(),3==e.$store.state.user.userInfo.moduleExtend.user.safetyLevel?n("span",[e._v(" 当前账号很安全，建议完善个人资料或者定期修改登录密码 ")]):e._e()])])]),n("el-divider",{staticClass:"m-a-0",staticStyle:{background:"#EEEEEE"}}),n("div",{staticClass:"content identity-list"},[n("el-form",{ref:"form",staticStyle:{"max-width":"570px"},attrs:{"label-width":"100px"}},[n("el-form-item",{attrs:{label:"登录密码:"}},[n("div",{staticClass:"flex space-between"},[n("el-input",{attrs:{size:"medium",value:"***********"}}),n("div",{staticClass:"actions"},[n("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.$router.push({name:"/user/editPassword"})}}},[e._v("修改")])],1)],1)]),n("el-form-item",{attrs:{label:"绑定手机号:"}},[e.$store.state.user.userInfo.mobile?n("div",{staticClass:"flex space-between"},[n("el-input",{attrs:{size:"medium",value:e.$store.state.user.userInfo.mobile.identifier}}),n("div",{staticClass:"actions"},[n("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.$router.push({name:"/reg_mobile/user/change"})}}},[e._v("修改")])],1)],1):n("div",{staticClass:"flex space-between"},[n("div",{staticClass:"label"},[e._v("未绑定手机号")]),n("div",{staticClass:"actions"},[n("el-button",{attrs:{size:"medium",type:"primary",plain:""},on:{click:function(t){return e.$router.push({name:"/reg_mobile/user/bind"})}}},[e._v("去绑定")])],1),n("div",{staticClass:"p-r-md"},[n("i",{staticClass:"xyicon xyicon-help-o"})])])]),n("el-form-item",{attrs:{label:"绑定邮箱:"}},[e.$store.state.user.userInfo.email?n("div",{staticClass:"flex space-between"},[n("el-input",{attrs:{size:"medium",value:e.$store.state.user.userInfo.email.identifier}}),n("div",{staticClass:"actions"},[n("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.$router.push({name:"/reg_email/user/change"})}}},[e._v("修改")])],1)],1):n("div",{staticClass:"flex space-between"},[n("div",{staticClass:"label"},[e._v("未绑定邮箱")]),n("div",{staticClass:"actions"},[n("el-button",{attrs:{size:"medium",type:"primary",plain:""},on:{click:function(t){return e.$router.push({name:"/reg_email/user/bind"})}}},[e._v("去绑定")])],1),n("div",{staticClass:"p-r-md"},[n("i",{staticClass:"xyicon xyicon-help-o"})])]),n("div",{staticClass:"text-gray ts-12 m-l-md"},[n("i",{staticClass:"xyicon xyicon-help-o m-r-xs"}),n("span",[e._v("手机号和邮箱绑定之后，都可作为登录账号")])])]),n("el-form-item",{staticClass:"m-t-md",attrs:{label:"第三方账号："}},[n("third-login-bind",{on:{success:e.bindSuccess}})],1)],1),n("div",{staticClass:"p-b",staticStyle:{width:"100%"}},[n("el-button",{staticClass:"fr",attrs:{size:"medium",type:"primary"}},[e._v("保存设置")])],1)],1)],1),n("div",[n("div",{staticClass:"content"},[n("edit-extend-info")],1)]),n("el-dialog",{attrs:{title:"修改头像",visible:e.showEditAvatar,width:"800px"},on:{"update:visible":function(t){e.showEditAvatar=t}}},[n("edit-avatar",{attrs:{"show-popup":e.showEditAvatar}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"})],1)],1)},i=[],s=n("1da1"),r=(n("96cf"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"xy-safety-level",class:"level-"+e.level},[n("div",{staticClass:"level-box flex space-between p-t"},[n("div",{staticClass:"level",style:{width:e.levelWidth,height:e.levelHeight}}),n("div",{staticClass:"level",style:{width:e.levelWidth,height:e.levelHeight}}),n("div",{staticClass:"level",style:{width:e.levelWidth,height:e.levelHeight}})]),n("div",{staticClass:"level-tip flex space-betwe"},[n("div",{staticClass:"text-center",style:{width:e.levelWidth}},[1==e.level?n("span",[e._v("低")]):e._e()]),n("div",[2==e.level?n("span",[e._v("中")]):e._e()]),n("div",[3==e.level?n("span",[e._v("高")]):e._e()])])])}),o=[],l=(n("a9e3"),{name:"xySafetyLevel",props:{showType:{type:String,default:"level"},level:{type:Number,default:0},levelWidth:{type:String,default:"80px"},levelHeight:{type:String,default:"6px"},percent:{type:Number,default:5}},data:function(){return{}},created:function(){},methods:{}}),c=l,u=(n("5e96"),n("2877")),d=Object(u["a"])(c,r,o,!1,null,"055a2cca",null),p=d.exports,f=n("bc88"),m=n("5383"),v=n("b593"),h={components:{"xy-safety-level":p,"third-login-bind":f["default"],"edit-extend-info":m["default"],"edit-avatar":v["default"]},data:function(){return{showEditAvatar:!1}},created:function(){},watch:{},methods:{bindSuccess:function(){},loadData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.request({url:"/v1/api",data:{},method:"get"});case 2:n=t.sent,200==n.code||e.util.showToast({title:n.msg,icon:"loading",duration:3e3});case 4:case"end":return t.stop()}}),t)})))()}}},x=h,b=(n("c9c2"),Object(u["a"])(x,a,i,!1,null,"0ff30850",null));t["default"]=b.exports},"8daf":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.initData.showInput?n("el-input",{attrs:{placeholder:"请输入"},on:{change:e.onChange},model:{value:e.content2,callback:function(t){e.content2=t},expression:"content2"}}):n("el-cascader",{attrs:{disabled:e.initData.disabled,options:e.initData.options,props:e.myprops},on:{change:e.onChange},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)},i=[],s=n("5530"),r=n("1da1"),o=(n("96cf"),n("159b"),{name:"XyCascader",props:{item:{type:Object,default:function(){return{extra:{}}}},value:{type:[Array,String],default:[]},init:{type:Object,default:function(){return{}}},header:{type:Object,default:function(){return{cloudId:0,eid:0}}}},data:function(){return{initData:{disabled:!1,options:[],action:"",lazy:!1,multiple:!1,labelField:"label",valueField:"value",nodeKey:"value",deep:1,showInput:!1,leaf:"leaf",maxLevel:3},content:"",content2:"",myprops:{}}},watch:{"init.showInput":{handler:function(e){this.initData=Object.assign(this.initData,this.init)},deep:!0},value:function(e){0!=this.value.length&&Array.isArray(this.value)?this.content=this.value:this.content=[]}},created:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.initData=Object.assign(this.initData,this.init,this.item.extra),0!=this.value.length&&Array.isArray(this.value)?this.content=this.value:this.content=[],0!=this.initData.options.length||!this.initData.lazy){e.next=7;break}return e.next=5,this.getNode({});case 5:t=e.sent,this.initData.options=t;case 7:n=this,this.myprops={leaf:n.initData.leaf,multiple:n.initData.multiple,label:n.initData.labelField,value:n.initData.valueField,lazy:n.initData.lazy,lazyLoad:function(e,t){e.level;setTimeout(Object(r["a"])(regeneratorRuntime.mark((function a(){var i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={},i[n.initData.nodeKey]=e.data[n.initData.nodeKey],a.next=4,n.getNode(i);case 4:s=a.sent,e.level==n.initData.maxLevel-1&&s.forEach((function(e){e[n.initData.leaf]=!0})),t(s);case 7:case"end":return a.stop()}}),a)}))),2e3)}};case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{onChange:function(){this.initData.showInput?this.$emit("input",this.content2):this.$emit("input",this.content)},getNode:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.util.request({url:t.initData.action,data:Object(s["a"])({deep:t.initData.deep},e),method:"get"});case 2:if(a=n.sent,200!=a.code){n.next=7;break}return n.abrupt("return",a.data.dataList);case 7:self.util.showToast({title:a.msg,icon:"loading",duration:3e3});case 8:case"end":return n.stop()}}),n)})))()}}}),l=o,c=n("2877"),u=Object(c["a"])(l,a,i,!1,null,"7e8aab80",null);t["a"]=u.exports},b593:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",{attrs:{type:"flex",justify:"space-around"}},[n("div",{staticClass:"cropper text-center"},[e.loadedScript?n("vue-cropper",{ref:"cropper",staticClass:"m-b",attrs:{img:e.option.img,outputSize:e.option.size,outputType:e.option.outputType,info:e.option.info,full:e.option.full,canMove:e.option.canMove,canMoveBox:e.option.canMoveBox,original:e.option.original,autoCrop:e.option.autoCrop,autoCropWidth:e.option.autoCropWidth,autoCropHeight:e.option.autoCropHeight,fixedBox:e.option.fixedBox},on:{realTime:e.realTime}}):e._e(),n("span",{staticClass:"text-gray ts-14"},[n("i",{staticClass:"xyicon xyicon-help-o ts-14"}),e._v(" 滚动鼠标滚轮来缩放图片 ")])],1),n("div",{staticClass:"previewBox"},[n("div",{staticClass:"preview-wrap"},[n("div",{staticClass:"preview",style:e.previews.div},[n("img",{style:e.previews.img,attrs:{src:e.previews.url}})])]),n("el-row",{staticClass:"m-t-md m-b",attrs:{type:"flex",justify:"center"}},[n("el-upload",{attrs:{action:"","show-file-list":!1,"auto-upload":!1,"on-change":e.uploadImg}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v(" 更换头像 ")])],1)],1),n("br"),n("el-row",[n("el-button",{attrs:{icon:"el-icon-plus",circle:"",size:"mini"},on:{click:function(t){return e.changeScale(1)}}}),n("el-button",{attrs:{icon:"el-icon-minus",circle:"",size:"mini"},on:{click:function(t){return e.changeScale(-1)}}}),n("el-button",{attrs:{icon:"el-icon-download",circle:"",size:"mini"},on:{click:function(t){return e.down("blob")}}}),n("el-button",{attrs:{icon:"el-icon-refresh-left",circle:"",size:"mini"},on:{click:e.rotateLeft}}),n("el-button",{attrs:{icon:"el-icon-refresh-right",circle:"",size:"mini"},on:{click:e.rotateRight}})],1)],1)]),n("div",{staticClass:"m-t-md flex flex-end p-r-md"},[n("el-button",{attrs:{round:""},on:{click:function(t){e.showPopup=!1}}},[e._v("取消")]),n("el-button",{attrs:{type:"primary",round:""},on:{click:e.saveEditAvatar}},[e._v("保存")])],1)],1)},i=[],s=n("53ca"),r=n("1da1"),o=(n("ac1f"),n("5319"),n("d3b7"),n("25f0"),n("3ca3"),n("ddb0"),n("2b3d"),n("b0c0"),n("96cf"),{name:"editAvatar",props:{showPopup:!1},data:function(){return{loadedScript:!1,filename:"",avatarURL:"",previews:{},option:{img:"",info:!0,outputSize:1,full:!0,outputType:"png",canMove:!0,original:!1,canMoveBox:!0,autoCrop:!0,autoCropWidth:150,autoCropHeight:150,fixed:!0,fixedBox:!0}}},created:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.loadScript();case 2:Vue.use(window["vue-cropper"].default),this.loadedScript=!0,this.option.img=this.$store.state.user.userInfo.avatar,this.filename=this.guid()+".png";case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),watch:{},methods:{guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)}))},saveEditAvatar:function(){this.finish("blob")},changeScale:function(e){e=e||1,this.$refs.cropper.changeScale(e)},rotateLeft:function(){this.$refs.cropper.rotateLeft()},rotateRight:function(){this.$refs.cropper.rotateRight()},finish:function(e){var t=this;"blob"===e?this.$refs.cropper.getCropBlob(function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(n){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=3,t.util.uploadFile({driver:t.$store.state.app.uploadDriver,signUrl:"/v1/upload_oss/index/sign",url:"/v1/core/index/upload",header:{token:t.util.getToken()},blobInfo:{blob:function(){return n},filename:function(){return this.filename}}});case 3:a=e.sent,a.data?(t.avatarURL=a.data.url,t.submit()):t.util.showToast({title:"上传失败",icon:"loading",duration:3e3});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):this.$refs.cropper.getCropData((function(e){}))},realTime:function(e){this.previews=e},down:function(e){var t=document.createElement("a");t.download="author-img","blob"===e?this.$refs.cropper.getCropBlob((function(e){t.href=window.URL.createObjectURL(e),t.click()})):this.$refs.cropper.getCropData((function(e){t.href=e,t.click()}))},uploadImg:function(e){var t=this;this.filename=e.name;var n=new FileReader;n.onload=function(e){var n;n="object"===Object(s["a"])(e.target.result)?window.URL.createObjectURL(new Blob([e.target.result])):e.target.result,t.option.img=n},n.readAsArrayBuffer(e.raw)},submit:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.avatarURL){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.util.request({url:"/v1/core/user/avatar",data:{avatar:e.avatarURL},method:"put"});case 4:n=t.sent,200==n.code?(e.util.showToast({title:n.msg,icon:"success",duration:2e3}),e.$store.state.user.userInfo.avatar=e.avatarURL,e.showPopup=!1):e.util.showToast({title:n.msg,icon:"loading",duration:3e3});case 6:case"end":return t.stop()}}),t)})))()},loadScript:function(){var e=this;return new Promise((function(t,n){e.VueScript2.load("https://cdn.jsdelivr.net/npm/vue-cropper@0.4.9/dist/index.js").then((function(){t()}))}))}}}),l=o,c=(n("ee7f"),n("2877")),u=Object(c["a"])(l,a,i,!1,null,"65d3b479",null);t["default"]=u.exports},c51a:function(e,t,n){},c9c2:function(e,t,n){"use strict";n("e617")},e617:function(e,t,n){},ee7f:function(e,t,n){"use strict";n("c51a")},fa03:function(e,t,n){"use strict";n("190a")}}]);