(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0ceb19"],{6119:function(t,e,i){"use strict";i.r(e),i("96cf");var n,a=i("1da1"),s={data:function(){return{id:0,info:{otcUser:{tradeCount:0,kycInfo:{realName:""}},userInfo:{avatar:""}},money:"",amount:"",alipay:0,wxpay:0,bank:0,otcUserInfo:{kycInfo:{}},coinBalance:{}}},created:(n=Object(a.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.id=this.$route.params.id,t.next=3,this.loadData(this.id);case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)}),watch:{amount:function(t){1==this.info.type&&this.coinBalance.balance<t&&(this.amount=this.coinBalance.balance,this.money=math.round(math.bignumber(this.amount)*math.bignumber(this.info.price),2))},money:function(t){t>this.info.maxMoney&&(this.money=this.info.maxMoney,this.amount=math.round(math.bignumber(this.money)/math.bignumber(this.info.price),this.info.coinInfo.decimals)),this.otcUserInfo.todayLeft<t&&(this.money=this.otcUserInfo.todayLeft,this.amount=math.round(math.bignumber(this.money)/math.bignumber(this.info.price),this.info.coinInfo.decimals))}},methods:{trade:function(t){var e=this;return Object(a.a)(regeneratorRuntime.mark((function i(){var n;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return 2==t&&(e.alipay||e.wxpay||e.bank||e.util.showToast({title:"请选择收款方式",icon:"loading",duration:3e3})),i.next=3,e.util.request({url:"/v1/coin_otc/order/add/"+e.id,data:{adId:e.id,coinId:e.info.coinId,type:t,amount:e.amount,totalPrice:e.money,alipay:e.alipay,wxpay:e.wxpay,bank:e.bank},method:"post"});case 3:200==(n=i.sent).code?e.util.navigateTo({url:"/coin_otc/order/info/"+n.data.orderId}):e.util.showToast({title:n.msg,icon:"loading",duration:3e3});case 5:case"end":return i.stop()}}),i)})))()},inputAmountSell:function(){this.amount=math.round(math.bignumber(this.amount),this.info.coinInfo.decimals),this.money=math.round(math.bignumber(this.amount)*math.bignumber(this.info.price),2)},inputMoneySell:function(){this.amount=math.round(math.bignumber(this.money)/math.bignumber(this.info.price),this.info.coinInfo.decimals)},sellAll:function(){this.amount=math.round(math.bignumber(this.coinBalance.balance),this.info.coinInfo.decimals),this.money=math.round(math.bignumber(this.coinBalance.balance)*math.bignumber(this.info.price),2)},inputMoney:function(){this.amount=math.round(math.bignumber(this.money)/math.bignumber(this.info.price),this.info.coinInfo.decimals)},inputAmount:function(){this.money=math.round(math.bignumber(this.amount)*math.bignumber(this.info.price),2)},setAllLeftAmount:function(){this.amount=math.round(math.bignumber(this.info.leftAmount),this.info.coinInfo.decimals),this.money=math.round(math.bignumber(this.info.leftAmount)*math.bignumber(this.info.price),2)},loadBalance:function(){var t=this;return Object(a.a)(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.util.request({url:"/v1/coin/balance/info/"+t.info.coinId,method:"get"});case 2:200==(i=e.sent).code?t.coinBalance=i.data.info:t.util.showToast({title:i.msg,icon:"loading",duration:3e3});case 4:case"end":return e.stop()}}),e)})))()},loadData:function(t){var e=this;return Object(a.a)(regeneratorRuntime.mark((function i(){var n,a;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.util.request({url:"/v1/coin_otc/ad/info/"+t,data:{},method:"get"});case 2:return 200==(n=i.sent).code?e.info=n.data.info:e.util.showToast({title:n.msg,icon:"loading",duration:3e3}),i.next=6,e.util.request({url:"/v1/coin_otc/user/my",data:{},method:"get"});case 6:if(200==(a=i.sent).code)return e.otcUserInfo=a.data.info,i.next=11,e.loadBalance();i.next=13;break;case 11:i.next=14;break;case 13:e.util.showToast({title:a.msg,icon:"loading",duration:3e3});case 14:case"end":return i.stop()}}),i)})))()}}},o=i("2877"),r=Object(o.a)(s,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrap"},[i("script2",{attrs:{src:"https://cdn.jsdelivr.net/npm/mathjs@6.2.5/dist/math.min.js"}}),i("xy-header"),i("div",{staticClass:"main"},[i("div",{staticClass:"container m-t"},[i("el-row",{attrs:{type:"flex",gutter:18}},[i("el-col",{attrs:{span:16}},[i("el-steps",{staticClass:"m-b",attrs:{active:1,simple:""}},[i("el-step",{attrs:{title:"待下单"}}),i("el-step",{attrs:{title:"待支付"}}),i("el-step",{attrs:{title:"待放币"}}),i("el-step",{attrs:{title:"交易完成"}})],1),i("el-card",{staticClass:"ad-info",attrs:{shadow:"never"}},[i("div",{staticClass:"flex flex-alignCenter"},[i("el-avatar",{attrs:{size:"medium",src:t.info.userInfo.avatar}}),i("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.info.userInfo.nickname))]),i("el-tag",{staticClass:"m-l-sm",attrs:{size:"mini"}},[t._v("KYC1")]),i("span",{staticClass:"m-l-md"},[t._v("交易 "),i("span",[t._v(t._s(t.info.otcUser.tradeCount))])]),i("span",{staticClass:"m-l"},[t._v("好评率 "),i("span",[t._v(t._s(t.info.otcUser.goodRate)+" %")])])],1),i("el-divider"),i("div",{staticClass:"flex",staticStyle:{"justify-content":"space-between"}},[i("div",[i("div",[t._v("单价")]),i("div",[t._v(t._s(t.info.price))])]),i("div",[i("div",[t._v("数量")]),i("div",[t._v(t._s(t.info.leftAmount)+" "+t._s(t.info.coinName))])]),i("div",[i("div",[t._v("单笔限额")]),i("div",[t._v(t._s(t.info.minMoney)+" - "+t._s(t.info.maxMoney)+" CNY")])]),i("div",[i("div",[t._v("收款方式")]),i("div",[i("i",{directives:[{name:"show",rawName:"v-show",value:t.info.alipay,expression:"info.alipay"}],staticClass:"xyicon xyicon-alipay m-r-xs",staticStyle:{color:"#4C88FE"}}),i("i",{directives:[{name:"show",rawName:"v-show",value:t.info.wxpay,expression:"info.wxpay"}],staticClass:"xyicon xyicon-wxpay m-r-xs",staticStyle:{color:"#00C901"}}),i("i",{directives:[{name:"show",rawName:"v-show",value:t.info.bank,expression:"info.bank"}],staticClass:"xyicon xyicon-card",staticStyle:{color:"#F7BA2A"}})])])])],1),i("el-card",{staticClass:"m-t trade-info",attrs:{shadow:"never"}},[i("div",{staticClass:"text-right font-sm m-b-sm"},[i("span",{staticClass:"m-r"},[t._v("当前剩余 "+t._s(t.coinBalance.balance)+" "+t._s(t.info.coinInfo.symbol))]),i("span",[t._v("当前可用交易额度 "+t._s(t._f("toThousands")(t.otcUserInfo.todayLeft))+"CNY")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:2==t.info.type,expression:"info.type == 2"}]},[i("div",{staticClass:"flex",staticStyle:{"align-items":"center"}},[i("el-input",{attrs:{placeholder:"输入想要购买的金额"},on:{input:t.inputMoney},model:{value:t.money,callback:function(e){t.money=e},expression:"money"}},[i("div",{staticClass:"text-default p-r-sm",staticStyle:{"font-weight":"500","line-height":"40px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("CNY")])]),i("i",{staticClass:"m-l m-r font-xl xyicon xyicon-exchange text-primary"}),i("el-input",{attrs:{placeholder:"输入想要购买的数量"},on:{input:t.inputAmount},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}},[i("div",{staticClass:"text-default p-r-sm",staticStyle:{"font-weight":"500","line-height":"40px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v(" "+t._s(t.info.coinInfo.symbol)+" "),i("el-divider",{attrs:{direction:"vertical"}}),i("span",{staticClass:"text-primary",on:{click:function(e){return t.setAllLeftAmount()}}},[t._v("全部")])],1)])],1),i("el-button",{staticClass:"full m-t",attrs:{size:"medium",type:"primary"},on:{click:function(e){return t.trade(1)}}},[t._v("购买")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:1==t.info.type,expression:"info.type == 1"}]},[i("div",{staticClass:"flex",staticStyle:{"align-items":"center"}},[i("el-input",{attrs:{placeholder:"输入想要出售的数量"},on:{input:t.inputAmountSell},model:{value:t.amount,callback:function(e){t.amount=e},expression:"amount"}},[i("div",{staticClass:"text-default p-r-sm",staticStyle:{"font-weight":"500","line-height":"40px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v(" "+t._s(t.info.coinInfo.symbol)+" "),i("el-divider",{attrs:{direction:"vertical"}}),i("span",{staticClass:"text-primary",on:{click:function(e){return t.sellAll()}}},[t._v("全部")])],1)]),i("i",{staticClass:"m-l m-r font-xl xyicon xyicon-exchange text-primary"}),i("el-input",{attrs:{placeholder:"输入想要出售的金额"},on:{input:t.inputMoneySell},model:{value:t.money,callback:function(e){t.money=e},expression:"money"}},[i("div",{staticClass:"text-default p-r-sm",staticStyle:{"font-weight":"500","line-height":"40px"},attrs:{slot:"suffix"},slot:"suffix"},[t._v("CNY")])])],1),i("el-button",{staticClass:"full m-t",attrs:{size:"medium",type:"success"},on:{click:function(e){return t.trade(2)}}},[t._v("出售")])],1)]),i("el-card",{staticClass:"m-t memo-info",attrs:{shadow:"never"}},[i("div",[t._v("备注：")]),i("div",[t._v(t._s(t.info.memo?t.info.memo:"沒有留言"))])])],1),i("el-col",{attrs:{span:8}},[i("el-card",{staticClass:"user-card"},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("el-avatar",{attrs:{size:"medium",src:t.info.userInfo.avatar}}),i("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.info.userInfo.nickname))])],1),i("div",{staticClass:"ts-14"},[i("div",[t._v("联系电话："+t._s(t.info.userInfo.mobile?t.info.userInfo.mobile.identifier:""))]),i("div",[t._v("姓名："+t._s(t.info.otcUser.kycInfo.realName))]),i("div",[t._v("身份证: "+t._s(t.info.otcUser.kycInfo.certNo))])])])],1)],1)],1)]),i("xy-footer")],1)}),[],!1,null,"aea5e832",null);e.default=r.exports}}]);