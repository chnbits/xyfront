"use strict";(Object("undefined"!=typeof self?self:this).webpackChunkxyui=Object("undefined"!=typeof self?self:this).webpackChunkxyui||[]).push([[789],{1789:function(e,t,n){n.r(t),n.d(t,{AuthenticationHandler:function(){return A},AuthenticationHandlerOptions:function(){return R},BatchRequestContent:function(){return i},BatchResponseContent:function(){return o},ChaosHandler:function(){return N},ChaosHandlerOptions:function(){return U},ChaosStrategy:function(){return M},Client:function(){return te},CustomAuthenticationProvider:function(){return W},FeatureUsageFlag:function(){return w},FileUpload:function(){return Q},GraphClientError:function(){return d},GraphError:function(){return Y},GraphRequest:function(){return Z},HTTPMessageHandler:function(){return T},LargeFileUploadTask:function(){return j},MiddlewareFactory:function(){return P},OneDriveLargeFileUploadTask:function(){return X},PageIterator:function(){return G},Range:function(){return B},RedirectHandler:function(){return C},RedirectHandlerOptions:function(){return D},ResponseType:function(){return q},RetryHandler:function(){return b},RetryHandlerOptions:function(){return x},StreamUpload:function(){return z},TelemetryHandler:function(){return S},TelemetryHandlerOptions:function(){return O},UploadResult:function(){return $},getValidRangeSize:function(){return V}});function s(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{d(s.next(e))}catch(e){i(e)}}function a(e){try{d(s.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}d((s=s.apply(e,t||[])).next())}))}Object.create;var r;Object.create;!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(r||(r={}));class i{constructor(e){if(this.requests=new Map,void 0!==e){const t=i.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let n=t.next();for(;!n.done;){const e=n.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const s=n.value[1];if(void 0!==s.dependsOn&&s.dependsOn.length>0)return!1;let r=n;for(n=t.next();!n.done;){const e=n.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==r.value[1].id)return!1;r=n,n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const s=n.value[1];let r;if(void 0===s.dependsOn||0===s.dependsOn.length)r=s.id;else{if(1!==s.dependsOn.length)return!1;{const t=s.dependsOn[0];if(t===s.id||!e.has(t))return!1;r=t}}for(n=t.next();!n.done;){const e=n.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&r!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===r||e.dependsOn[0]!==r))return!1;if(e.dependsOn.length>1)return!1}n=t.next()}return!0})(e)}static getRequestData(e){return s(this,void 0,void 0,(function*(){const t={url:""},n=new RegExp("^https?://");t.url=n.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const s={};return e.headers.forEach(((e,t)=>{s[t]=e})),Object.keys(s).length&&(t.headers=s),e.method!==r.PATCH&&e.method!==r.POST&&e.method!==r.PUT||(t.body=yield i.getRequestBody(e)),t}))}static getRequestBody(e){return s(this,void 0,void 0,(function*(){let t,n=!1;try{const s=e.clone();t=yield s.json(),n=!0}catch(e){}if(!n)try{if("undefined"!=typeof Blob){const n=yield e.blob(),s=new FileReader;t=yield new Promise((e=>{s.addEventListener("load",(()=>{const t=s.result,n=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(n[4])}),!1),s.readAsDataURL(n)}))}else if("undefined"!=typeof Buffer){t=(yield e.buffer()).toString("base64")}n=!0}catch(e){}return t}))}addRequest(e){const t=i.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),n=this.requests.entries();let s=n.next();for(;!s.done;){const t=s.value[1].dependsOn;if(void 0!==t){const n=t.indexOf(e);-1!==n&&t.splice(n,1),0===t.length&&delete s.value[1].dependsOn}s=n.next()}return t}getContent(){return s(this,void 0,void 0,(function*(){const e=[],t={requests:e},n=this.requests.entries();let s=n.next();if(s.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!i.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!s.done;){const t=s.value[1],r=yield i.getRequestData(t.request);if(void 0!==r.body&&(void 0===r.headers||void 0===r.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}r.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(r.dependsOn=t.dependsOn),e.push(r),s=n.next()}return t.requests=e,t}))}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const n=this.requests.get(e);if(void 0===n.dependsOn&&(n.dependsOn=[]),-1!==n.dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}n.dependsOn.push(t)}else{const n=this.requests.entries();let s,r=n.next();for(;!r.done&&r.value[1].id!==e;)s=r,r=n.next();if(void 0===s){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=s.value[0];if(void 0===r.value[1].dependsOn&&(r.value[1].dependsOn=[]),-1!==r.value[1].dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}r.value[1].dependsOn.push(t)}}}removeDependency(e,t){const n=this.requests.get(e);if(void 0===n||void 0===n.dependsOn||0===n.dependsOn.length)return!1;if(void 0!==t){const e=n.dependsOn.indexOf(t);return-1!==e&&(n.dependsOn.splice(e,1),!0)}return delete n.dependsOn,!0}}i.requestLimit=20;class o{constructor(e){this.responses=new Map,this.update(e)}createResponseObject(e){const t=e.body,n={};if(n.status=e.status,void 0!==e.statusText&&(n.statusText=e.statusText),n.headers=e.headers,void 0!==n.headers&&void 0!==n.headers["Content-Type"]&&"application/json"===n.headers["Content-Type"].split(";")[0]){const e=JSON.stringify(t);return new Response(e,n)}return new Response(t,n)}update(e){this.nextLink=e["@odata.nextLink"];const t=e.responses;for(let e=0,n=t.length;e<n;e++)this.responses.set(t[e].id,this.createResponseObject(t[e]))}getResponseById(e){return this.responses.get(e)}getResponses(){return this.responses}*getResponsesIterator(){const e=this.responses.entries();let t=e.next();for(;!t.done;)yield t.value,t=e.next()}}const a=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class d extends Error{constructor(e){super(e),Object.setPrototypeOf(this,d.prototype)}static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new d,t.customError=e),t}}const l=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],u=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e},c=e=>p(e),h=(e,t)=>(t.forEach((e=>f(e))),p(e,t)),p=(e,t=a)=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const n=(e=e.replace("https://","")).indexOf(":"),s=e.indexOf("/");let r="";if(-1!==s)return-1!==n&&n<s?(r=e.substring(0,n),t.has(r)):(r=e.substring(0,s),t.has(r))}return!1},f=e=>{if(-1!==e.indexOf("/"))throw new d("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class m{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const y=()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},g=(e,t,n)=>{let s=null;if("undefined"!=typeof Request&&e instanceof Request)s=e.headers.get(n);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)s=t.headers.get(n);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,r=e.length;t<r;t++)if(e[t][0]===n){s=e[t][1];break}}else void 0!==t.headers[n]&&(s=t.headers[n]);return s},E=(e,t,n,s)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(n,s);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[n]:s});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(n,s);else if(t.headers instanceof Array){let e=0;const r=t.headers.length;for(;e<r;e++){const r=t.headers[e];if(r[0]===n){r[1]=s;break}}e===r&&t.headers.push([n,s])}else Object.assign(t.headers,{[n]:s})},v=(e,t,n,s)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(n,s):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[n]:s}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(n,s):t.headers instanceof Array?t.headers.push([n,s]):void 0===t.headers?t.headers={[n]:s}:void 0===t.headers[n]?t.headers[n]=s:t.headers[n]+=`, ${s}`)};class R{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var w;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(w||(w={}));class O{constructor(){this.featureUsage=w.NONE}static updateFeatureUsageFlag(e,t){let n;e.middlewareControl instanceof m?n=e.middlewareControl.getMiddlewareOptions(O):e.middlewareControl=new m,void 0===n&&(n=new O,e.middlewareControl.setMiddlewareOptions(O,n)),n.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class A{constructor(e){this.authenticationProvider=e}execute(e){return s(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(c(t)||e.customHosts&&h(t,e.customHosts)){let t,n,s;e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(R)),t&&(n=t.authenticationProvider,s=t.authenticationProviderOptions),n||(n=this.authenticationProvider);const r=`Bearer ${yield n.getAccessToken(s)}`;v(e.request,e.options,A.AUTHORIZATION_HEADER,r),O.updateFeatureUsageFlag(e,w.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[A.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}A.AUTHORIZATION_HEADER="Authorization";class T{execute(e){return s(this,void 0,void 0,(function*(){e.response=yield fetch(e.request,e.options)}))}}class x{constructor(e=x.DEFAULT_DELAY,t=x.DEFAULT_MAX_RETRIES,n=x.defaultShouldRetry){if(e>x.MAX_DELAY&&t>x.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${x.MAX_DELAY} and ${x.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>x.MAX_DELAY){const e=new Error(`Delay should not be more than ${x.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>x.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${x.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,x.MAX_DELAY),this.maxRetries=Math.min(t,x.MAX_MAX_RETRIES),this.shouldRetry=n}getMaxDelay(){return x.MAX_DELAY}}x.DEFAULT_DELAY=3,x.DEFAULT_MAX_RETRIES=3,x.MAX_DELAY=180,x.MAX_MAX_RETRIES=10,x.defaultShouldRetry=()=>!0;class b{constructor(e=new x){this.options=e}isRetry(e){return-1!==b.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const n="string"==typeof e?t.method:e.method;if(n===r.PUT||n===r.PATCH||n===r.POST){if("application/octet-stream"===g(e,t,"Content-Type"))return!1}return!0}getDelay(e,t,n){const s=()=>Number(Math.random().toFixed(3)),r=void 0!==e.headers?e.headers.get(b.RETRY_AFTER_HEADER):null;let i;return i=null!==r?Number.isNaN(Number(r))?Math.round((new Date(r).getTime()-Date.now())/1e3):Number(r):t>=2?this.getExponentialBackOffTime(t)+n+s():n+s(),Math.min(i,this.options.getMaxDelay()+s())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return s(this,void 0,void 0,(function*(){const t=1e3*e;return new Promise((e=>setTimeout(e,t)))}))}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new x,this.options)),t}executeWithRetry(e,t,n){return s(this,void 0,void 0,(function*(){if(yield this.nextMiddleware.execute(e),t<n.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&n.shouldRetry(n.delay,t,e.request,e.options,e.response)){++t,E(e.request,e.options,b.RETRY_ATTEMPT_HEADER,t.toString());const s=this.getDelay(e.response,t,n.delay);return yield this.sleep(s),yield this.executeWithRetry(e,t,n)}}))}execute(e){return s(this,void 0,void 0,(function*(){const t=this.getOptions(e);return O.updateFeatureUsageFlag(e,w.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,t)}))}setNext(e){this.nextMiddleware=e}}b.RETRY_STATUS_CODES=[429,503,504],b.RETRY_ATTEMPT_HEADER="Retry-Attempt",b.RETRY_AFTER_HEADER="Retry-After";class D{constructor(e=D.DEFAULT_MAX_REDIRECTS,t=D.defaultShouldRedirect){if(e>D.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${D.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}D.DEFAULT_MAX_REDIRECTS=5,D.MAX_MAX_REDIRECTS=20,D.defaultShouldRedirect=()=>!0;class C{constructor(e=new D){this.options=e}isRedirect(e){return-1!==C.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(C.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(C.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const n=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,s=n.exec(e);let r,i;null!==s&&(r=s[0]);const o=n.exec(t);return null!==o&&(i=o[0]),void 0!==r&&void 0!==i&&r!==i}updateRequestUrl(e,t){return s(this,void 0,void 0,(function*(){var n,r;t.request="string"==typeof t.request?e:yield(n=e,r=t.request,s(void 0,void 0,void 0,(function*(){const e=r.headers.get("Content-Type")?yield r.blob():yield Promise.resolve(void 0),{method:t,headers:s,referrer:i,referrerPolicy:o,mode:a,credentials:d,cache:l,redirect:u,integrity:c,keepalive:h,signal:p}=r;return new Request(n,{method:t,headers:s,body:e,referrer:i,referrerPolicy:o,mode:a,credentials:d,cache:l,redirect:u,integrity:c,keepalive:h,signal:p})})))}))}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(D)),void 0===t&&(t=Object.assign(new D,this.options)),t}executeWithRedirect(e,t,n){return s(this,void 0,void 0,(function*(){yield this.nextMiddleware.execute(e);const s=e.response;if(t<n.maxRedirects&&this.isRedirect(s)&&this.hasLocationHeader(s)&&n.shouldRedirect(s)){if(++t,s.status===C.STATUS_CODE_SEE_OTHER)e.options.method=r.GET,delete e.options.body;else{const t=this.getLocationHeader(s);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(s.url,t)&&delete e.options.headers[C.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,n)}}))}execute(e){return s(this,void 0,void 0,(function*(){const t=this.getOptions(e);return e.options.redirect=C.MANUAL_REDIRECT,O.updateFeatureUsageFlag(e,w.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,t)}))}setNext(e){this.nextMiddleware=e}}C.REDIRECT_STATUS_CODES=[301,302,303,307,308],C.STATUS_CODE_SEE_OTHER=303,C.LOCATION_HEADER="Location",C.AUTHORIZATION_HEADER="Authorization",C.MANUAL_REDIRECT="manual";class S{execute(e){return s(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(c(t)||e.customHosts&&h(t,e.customHosts)){let t=g(e.request,e.options,S.CLIENT_REQUEST_ID_HEADER);t||(t=y(),E(e.request,e.options,S.CLIENT_REQUEST_ID_HEADER,t));let n,s=`${S.PRODUCT_NAME}/3.0.2`;if(e.middlewareControl instanceof m&&(n=e.middlewareControl.getMiddlewareOptions(O)),n){const e=n.getFeatureUsage();s+=` (${S.FEATURE_USAGE_STRING}=${e})`}v(e.request,e.options,S.SDK_VERSION_HEADER,s)}else delete e.options.headers[S.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[S.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}S.CLIENT_REQUEST_ID_HEADER="client-request-id",S.SDK_VERSION_HEADER="SdkVersion",S.PRODUCT_NAME="graph-js",S.FEATURE_USAGE_STRING="featureUsage";class P{static getDefaultMiddlewareChain(e){const t=[],n=new A(e),s=new b(new x),r=new S,i=new T;if(t.push(n),t.push(s),"object"==typeof process){const e=new C(new D);t.push(e)}return t.push(r),t.push(i),t}}var M;!function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(M||(M={}));class U{constructor(e=M.RANDOM,t="Some error Happened",n,s,r,i){if(this.chaosStrategy=e,this.statusCode=n,this.statusMessage=t,this.chaosPercentage=void 0!==s?s:10,this.responseBody=r,this.headers=i,this.chaosPercentage>100)throw new Error("Error Pecentage can not be more than 100")}}const _={GET:[429,500,502,503,504],POST:[429,500,502,503,504,507],PUT:[429,500,502,503,504,507],PATCH:[429,500,502,503,504],DELETE:[429,500,502,503,504,507]},L={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};class N{constructor(e=new U,t){this.options=e,this.manualMap=t}createResponseHeaders(e,t,n){const s=e.headers?new Headers(e.headers):new Headers;return s.append("Cache-Control","no-store"),s.append("request-id",t),s.append("client-request-id",t),s.append("x-ms-ags-diagnostic",""),s.append("Date",n),s.append("Strict-Transport-Security",""),429===e.statusCode&&s.append("retry-after","3"),s}createResponseBody(e,t,n){if(e.responseBody)return e.responseBody;let s;if(e.statusCode>=400){s={error:{code:L[e.statusCode],message:e.statusMessage,innerError:{"request-id":t,date:n}}}}else s={};return s}createResponse(e,t){const n=t.request,s=y(),r=new Date,i=this.createResponseHeaders(e,s,r.toString()),o=this.createResponseBody(e,s,r.toString()),a={url:n,status:e.statusCode,statusText:e.statusMessage,headers:i};t.response=new Response("string"==typeof o?o:JSON.stringify(o),a)}sendRequest(e,t){return s(this,void 0,void 0,(function*(){this.setStatusCode(e,t.request,t.options.method),e.chaosStrategy===M.MANUAL&&!this.nextMiddleware||Math.floor(100*Math.random())<e.chaosPercentage?this.createResponse(e,t):this.nextMiddleware&&(yield this.nextMiddleware.execute(t))}))}getRandomStatusCode(e){const t=_[e];return t[Math.floor(Math.random()*t.length)]}getRelativeURL(e){const t=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let n;return null!==t.exec(e)&&(n=t.exec(e)[1]),n}setStatusCode(e,t,n){if(e.chaosStrategy===M.MANUAL){if(void 0===e.statusCode){const s=this.getRelativeURL(t);void 0!==this.manualMap.get(s)?void 0!==this.manualMap.get(s).get(n)&&(e.statusCode=this.manualMap.get(s).get(n)):this.manualMap.forEach(((t,r)=>{new RegExp(r+"$").test(s)&&void 0!==this.manualMap.get(r).get(n)&&(e.statusCode=this.manualMap.get(r).get(n))}))}}else e.statusCode=this.getRandomStatusCode(n)}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(U)),void 0===t&&(t=Object.assign(new U,this.options)),t}execute(e){return s(this,void 0,void 0,(function*(){const t=this.getOptions(e);return yield this.sendRequest(t,e)}))}setNext(e){this.nextMiddleware=e}}var q,I,H,F;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(q||(q={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(I||(I={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(H||(H={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(F||(F={}));class k{static parseDocumentResponse(e,t){return"undefined"!=typeof DOMParser?new Promise(((n,s)=>{e.text().then((e=>{try{const s=(new DOMParser).parseFromString(e,t);n(s)}catch(e){s(e)}}))})):Promise.resolve(e.body)}static convertResponse(e,t){return s(this,void 0,void 0,(function*(){if(204===e.status)return Promise.resolve();let n;const s=e.headers.get("Content-type");switch(t){case q.ARRAYBUFFER:n=yield e.arrayBuffer();break;case q.BLOB:n=yield e.blob();break;case q.DOCUMENT:n=yield k.parseDocumentResponse(e,I.TEXT_XML);break;case q.JSON:n=yield e.json();break;case q.STREAM:n=yield Promise.resolve(e.body);break;case q.TEXT:n=yield e.text();break;default:if(null!==s){const t=s.split(";")[0];n=new RegExp(F.DOCUMENT).test(t)?yield k.parseDocumentResponse(e,t):new RegExp(F.IMAGE).test(t)?e.blob():t===H.TEXT_PLAIN?yield e.text():t===H.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else n=Promise.resolve(e.body)}return n}))}static getResponse(e,t,n){return s(this,void 0,void 0,(function*(){if(t===q.RAW)return Promise.resolve(e);{const s=yield k.convertResponse(e,t);if(!e.ok)throw s;if("function"!=typeof n)return s;n(null,s)}}))}}class B{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class ${constructor(e,t){this._location=t,this._responseBody=e}get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}static CreateUploadResult(e,t){return new $(e,t.get("location"))}}class j{constructor(e,t,n,s={}){if(this.DEFAULT_FILE_SIZE=5242880,this.client=e,!t.sliceFile)throw new d("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,this.file=t,s.rangeSize||(s.rangeSize=this.DEFAULT_FILE_SIZE),this.options=s,this.uploadSession=n,this.nextRange=new B(0,this.options.rangeSize-1)}static createUploadSession(e,t,n,r={}){return s(this,void 0,void 0,(function*(){const s=yield e.api(t).headers(r).post(n);return{url:s.uploadUrl,expiry:new Date(s.expirationDateTime),isCancelled:!1}}))}parseRange(e){const t=e[0];if(void 0===t||""===t)return new B;const n=t.split("-"),s=parseInt(n[0],10);let r=parseInt(n[1],10);return Number.isNaN(r)&&(r=this.file.size-1),new B(s,r)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new B(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new d("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return s(this,void 0,void 0,(function*(){const e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const t=this.getNextRange();if(-1===t.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const n=yield this.file.sliceFile(t),s=yield this.uploadSliceGetRawResponse(n,t,this.file.size);if(!s)throw new d("Something went wrong! Large file upload slice response is null.");const r=yield k.getResponse(s);if(201===s.status||200===s.status&&r.id){return $.CreateUploadResult(r,s.headers)}const i={expirationDateTime:r.expirationDateTime||r.ExpirationDateTime,nextExpectedRanges:r.NextExpectedRanges||r.nextExpectedRanges};this.updateTaskStatus(i),e&&e.progress&&e.progress(t,e.extraCallbackParam)}}))}uploadSlice(e,t,n){return s(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${n}`,"Content-Type":"application/octet-stream"}).put(e)}))}uploadSliceGetRawResponse(e,t,n){return s(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${n}`,"Content-Type":"application/octet-stream"}).responseType(q.RAW).put(e)}))}cancel(){return s(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).responseType(q.RAW).delete();return 204===e.status&&(this.uploadSession.isCancelled=!0),e}))}getStatus(){return s(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}))}resume(){return s(this,void 0,void 0,(function*(){return yield this.getStatus(),yield this.upload()}))}getUploadSession(){return this.uploadSession}}class Q{constructor(e,t,n){if(this.content=e,this.name=t,this.size=n,!e||!t||!n)throw new d("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}const V=(e=5242880)=>{const t=62914560;return e>t&&(e=t),(n=e)>327680&&(n=320*Math.floor(n/327680)*1024),n;var n};class X extends j{constructor(e,t,n,s){super(e,t,n,s)}static constructCreateSessionUrl(e,t=X.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map((e=>encodeURIComponent(e))).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let n,s;if("undefined"!=typeof Blob&&e instanceof Blob)n=new File([e],t),s=n.size;else if("undefined"!=typeof File&&e instanceof File)n=e,s=n.size;else if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array){const t=e;s=t.byteLength,n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{content:n,size:s}}static create(e,t,n){return s(this,void 0,void 0,(function*(){if(!e||!t||!n)throw new d("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const s=n.fileName,r=X.getFileInfo(t,s),i=new Q(r.content,s,r.size);return this.createTaskWithFileObject(e,i,n)}))}static createTaskWithFileObject(e,t,n){return s(this,void 0,void 0,(function*(){if(!e||!t||!n)throw new d("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const s=X.constructCreateSessionUrl(n.fileName,n.path),r={fileName:n.fileName,fileDescription:n.fileDescription,conflictBehavior:n.conflictBehavior},i=yield X.createUploadSession(e,s,r),o=V(n.rangeSize);return new X(e,t,i,{rangeSize:o,uploadEventHandlers:n.uploadEventHandlers})}))}static createUploadSession(e,t,n){const r=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return s(this,void 0,void 0,(function*(){const s={item:{"@microsoft.graph.conflictBehavior":(null==n?void 0:n.conflictBehavior)||"rename",name:null==n?void 0:n.fileName,description:null==n?void 0:n.fileDescription}};return r.createUploadSession.call(this,e,t,s)}))}commit(e,t="rename"){return s(this,void 0,void 0,(function*(){const n={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(n)}))}}X.DEFAULT_UPLOAD_PATH="/";class z{constructor(e,t,n){if(this.content=e,this.name=t,this.size=n,!e||!t||!n)throw new d("Please provide the Readable Stream content, name of the file and size of the file")}sliceFile(e){return s(this,void 0,void 0,(function*(){let t=e.maxValue-e.minValue+1;const n=[];if(this.previousSlice){if(e.minValue<this.previousSlice.range.minValue)throw new d("An error occurred while uploading the stream. Please restart the stream upload from the first byte of the file.");if(e.minValue<this.previousSlice.range.maxValue){const s=this.previousSlice.range.minValue,r=this.previousSlice.range.maxValue;if(e.minValue===s&&e.maxValue===r)return this.previousSlice.fileSlice;if(e.maxValue===r)return this.previousSlice.fileSlice.slice(e.minValue,e.maxValue+1);n.push(this.previousSlice.fileSlice.slice(e.minValue,r+1)),t=e.maxValue-r}}if(!this.content||!this.content.readable)throw new d("Stream is not readable.");this.content.readableLength>=t?n.push(this.content.read(t)):n.push(yield this.readNBytesFromStream(t));const s=Buffer.concat(n);return this.previousSlice={fileSlice:s,range:e},s}))}readNBytesFromStream(e){return new Promise(((t,n)=>{const s=[];let r=e,i=0;this.content.on("end",(()=>{if(r>0)return n(new d("Stream ended before reading required range size"))})),this.content.on("readable",(()=>{let o;for(;i<e&&null!==(o=this.content.read(r));)i+=o.length,s.push(o),r>0&&(r=e-i);return i===e?t(Buffer.concat(s)):this.content&&this.content.readable?void 0:n(new d("Error encountered while reading the stream during the upload"))}))}))}}class G{constructor(e,t,n,s){this.client=e,this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"],this.callback=n,this.complete=!1,this.requestOptions=s}iterationHelper(){if(void 0===this.collection)return!1;let e=!0;for(;e&&0!==this.collection.length;){const t=this.collection.shift();e=this.callback(t)}return e}fetchAndUpdateNextPageData(){return s(this,void 0,void 0,(function*(){let e=this.client.api(this.nextLink);this.requestOptions&&(this.requestOptions.headers&&(e=e.headers(this.requestOptions.headers)),this.requestOptions.middlewareOptions&&(e=e.middlewareOptions(this.requestOptions.middlewareOptions)),this.requestOptions.options&&(e=e.options(this.requestOptions.options)));const t=yield e.get();this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"]}))}getDeltaLink(){return this.deltaLink}iterate(){return s(this,void 0,void 0,(function*(){let e=this.iterationHelper();for(;e;)void 0!==this.nextLink?(yield this.fetchAndUpdateNextPageData(),e=this.iterationHelper()):e=!1;void 0===this.nextLink&&0===this.collection.length&&(this.complete=!0)}))}resume(){return s(this,void 0,void 0,(function*(){return this.iterate()}))}isComplete(){return this.complete}}class W{constructor(e){this.provider=e}getAccessToken(){return s(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.provider(((n,r)=>s(this,void 0,void 0,(function*(){if(r)e(r);else{if(!n){n=new d("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")}const e=yield d.setGraphClientError(n);t(e)}}))))}))}))}}class Y extends Error{constructor(e=-1,t,n){super(t||n&&n.message),Object.setPrototypeOf(this,Y.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=n?n.stack:this.stack}}class J{static constructError(e,t){const n=new Y(t,"",e);return void 0!==e.name&&(n.code=e.name),n.body=e.toString(),n.date=new Date,n}static constructErrorFromResponse(e,t){const n=e.error,s=new Y(t,n.message);return s.code=n.code,void 0!==n.innerError&&(s.requestId=n.innerError["request-id"],s.date=new Date(n.innerError.date)),s.body=JSON.stringify(n),s}static getError(e=null,t=-1,n){return s(this,void 0,void 0,(function*(){let s;if(e&&e.error?s=J.constructErrorFromResponse(e,t):e instanceof Error?s=J.constructError(e,t):(s=new Y(t),s.body=e),"function"!=typeof n)return s;n(s,null)}))}}class Z{constructor(e,t,n){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const n=e.indexOf("/");-1!==n&&(this.urlComponents.version=e.substring(0,n),e=e.substring(n+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const n=e.substring(t+1,e.length).split("&");for(const e of n)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(n)}addCsvQueryParameter(e,t,n){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let s=[];n.length>1&&"string"==typeof t?s=Array.prototype.slice.call(n):"string"==typeof t?s.push(t):s=s.concat(t),this.urlComponents.oDataQueryParams[e]+=s.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce(((e,n)=>{return[(s=e,s.replace(/\/+$/,"")),t(n)].join("/");var s}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const n in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,n)&&t.push(n+"="+e.oDataQueryParams[n]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const n in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,n)&&t.push(n+"="+e.otherURLQueryParams[n]);if(0!==e.otherURLQueryOptions.length)for(const n of e.otherURLQueryOptions)t.push(n);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),n=e.substring(0,t),s=e.substring(t+1);this.setURLComponentsQueryParamater(n,s)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==l.indexOf(e)){const n=this.urlComponents.oDataQueryParams[e],s=n&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=s?n+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");if(-1===t)return!1;return!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,n){var r;return s(this,void 0,void 0,(function*(){let s;const i=new m(this._middlewareOptions);this.updateRequestOptions(t);const o=null===(r=this.config)||void 0===r?void 0:r.customHosts;try{s=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:i,customHosts:o})).response;return yield k.getResponse(s,this._responseType,n)}catch(e){if(e instanceof d)throw e;let t;s&&(t=s.status);throw yield J.getError(e,t,n)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return s(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:r.GET};return yield this.send(t,n,e)}))}post(e,t){return s(this,void 0,void 0,(function*(){const n=this.buildFullUrl(),s={method:r.POST,body:u(e)};return"FormData"===(e&&e.constructor&&e.constructor.name)?s.headers={}:(this.setHeaderContentType(),s.headers=this._headers),yield this.send(n,s,t)}))}create(e,t){return s(this,void 0,void 0,(function*(){return yield this.post(e,t)}))}put(e,t){return s(this,void 0,void 0,(function*(){const n=this.buildFullUrl();this.setHeaderContentType();const s={method:r.PUT,body:u(e)};return yield this.send(n,s,t)}))}patch(e,t){return s(this,void 0,void 0,(function*(){const n=this.buildFullUrl();this.setHeaderContentType();const s={method:r.PATCH,body:u(e)};return yield this.send(n,s,t)}))}update(e,t){return s(this,void 0,void 0,(function*(){return yield this.patch(e,t)}))}delete(e){return s(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:r.DELETE};return yield this.send(t,n,e)}))}del(e){return s(this,void 0,void 0,(function*(){return yield this.delete(e)}))}getStream(e){return s(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:r.GET};return this.responseType(q.STREAM),yield this.send(t,n,e)}))}putStream(e,t){return s(this,void 0,void 0,(function*(){const n=this.buildFullUrl(),s={method:r.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(n,s,t)}))}}class K{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach(((t,n)=>{n<e.length-1&&t.setNext(e[n+1])})),this.middleware=e[0]}sendRequest(e){return s(this,void 0,void 0,(function*(){if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}))}}class ee{static createWithAuthenticationProvider(e){const t=new A(e),n=new b(new x),s=new S,r=new T;if(t.setNext(n),"object"==typeof process){const e=new C(new D);n.setNext(e),e.setNext(s)}else n.setNext(s);return s.setNext(r),ee.createWithMiddleware(t)}static createWithMiddleware(...e){return new K(...e)}}class te{constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})();for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=ee.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new K(...[].concat(e.middleware))}this.httpClient=t}static init(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]="authProvider"===n?new W(e[n]):e[n]);return te.initWithMiddleware(t)}static initWithMiddleware(e){return new te(e)}api(e){return new Z(this.httpClient,this.config,e)}}}}]);