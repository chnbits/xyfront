"use strict";(Object("undefined"!=typeof self?self:this).webpackChunkxyui=Object("undefined"!=typeof self?self:this).webpackChunkxyui||[]).push([[789],{1789:(e,t,s)=>{s.r(t),s.d(t,{AuthenticationHandler:()=>A,AuthenticationHandlerOptions:()=>R,BatchRequestContent:()=>r,BatchResponseContent:()=>o,ChaosHandler:()=>N,ChaosHandlerOptions:()=>U,ChaosStrategy:()=>M,Client:()=>te,CustomAuthenticationProvider:()=>W,FeatureUsageFlag:()=>w,FileUpload:()=>Q,GraphClientError:()=>d,GraphError:()=>Y,GraphRequest:()=>Z,HTTPMessageHandler:()=>T,LargeFileUploadTask:()=>j,MiddlewareFactory:()=>P,OneDriveLargeFileUploadTask:()=>X,PageIterator:()=>G,Range:()=>B,RedirectHandler:()=>C,RedirectHandlerOptions:()=>D,ResponseType:()=>q,RetryHandler:()=>b,RetryHandlerOptions:()=>x,StreamUpload:()=>z,TelemetryHandler:()=>S,TelemetryHandlerOptions:()=>O,UploadResult:()=>$,getValidRangeSize:()=>V});function n(e,t,s,n){return new(s||(s=Promise))((function(i,r){function o(e){try{d(n.next(e))}catch(e){r(e)}}function a(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}d((n=n.apply(e,t||[])).next())}))}Object.create;var i;Object.create;!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(i||(i={}));class r{constructor(e){if(this.requests=new Map,void 0!==e){const t=r.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let s=t.next();for(;!s.done;){const e=s.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;s=t.next()}return!0})(e)||(e=>{const t=e.entries();let s=t.next();const n=s.value[1];if(void 0!==n.dependsOn&&n.dependsOn.length>0)return!1;let i=s;for(s=t.next();!s.done;){const e=s.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==i.value[1].id)return!1;i=s,s=t.next()}return!0})(e)||(e=>{const t=e.entries();let s=t.next();const n=s.value[1];let i;if(void 0===n.dependsOn||0===n.dependsOn.length)i=n.id;else{if(1!==n.dependsOn.length)return!1;{const t=n.dependsOn[0];if(t===n.id||!e.has(t))return!1;i=t}}for(s=t.next();!s.done;){const e=s.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&i!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===i||e.dependsOn[0]!==i))return!1;if(e.dependsOn.length>1)return!1}s=t.next()}return!0})(e)}static getRequestData(e){return n(this,void 0,void 0,(function*(){const t={url:""},s=new RegExp("^https?://");t.url=s.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const n={};return e.headers.forEach(((e,t)=>{n[t]=e})),Object.keys(n).length&&(t.headers=n),e.method!==i.PATCH&&e.method!==i.POST&&e.method!==i.PUT||(t.body=yield r.getRequestBody(e)),t}))}static getRequestBody(e){return n(this,void 0,void 0,(function*(){let t,s=!1;try{const n=e.clone();t=yield n.json(),s=!0}catch(e){}if(!s)try{if("undefined"!=typeof Blob){const s=yield e.blob(),n=new FileReader;t=yield new Promise((e=>{n.addEventListener("load",(()=>{const t=n.result,s=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(s[4])}),!1),n.readAsDataURL(s)}))}else if("undefined"!=typeof Buffer){t=(yield e.buffer()).toString("base64")}s=!0}catch(e){}return t}))}addRequest(e){const t=r.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),s=this.requests.entries();let n=s.next();for(;!n.done;){const t=n.value[1].dependsOn;if(void 0!==t){const s=t.indexOf(e);-1!==s&&t.splice(s,1),0===t.length&&delete n.value[1].dependsOn}n=s.next()}return t}getContent(){return n(this,void 0,void 0,(function*(){const e=[],t={requests:e},s=this.requests.entries();let n=s.next();if(n.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!r.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!n.done;){const t=n.value[1],i=yield r.getRequestData(t.request);if(void 0!==i.body&&(void 0===i.headers||void 0===i.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}i.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(i.dependsOn=t.dependsOn),e.push(i),n=s.next()}return t.requests=e,t}))}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const s=this.requests.get(e);if(void 0===s.dependsOn&&(s.dependsOn=[]),-1!==s.dependsOn.indexOf(t)){const s=new Error(`Dependency ${t} is already added for the request ${e}`);throw s.name="Duplicate Dependency",s}s.dependsOn.push(t)}else{const s=this.requests.entries();let n,i=s.next();for(;!i.done&&i.value[1].id!==e;)n=i,i=s.next();if(void 0===n){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=n.value[0];if(void 0===i.value[1].dependsOn&&(i.value[1].dependsOn=[]),-1!==i.value[1].dependsOn.indexOf(t)){const s=new Error(`Dependency ${t} is already added for the request ${e}`);throw s.name="Duplicate Dependency",s}i.value[1].dependsOn.push(t)}}}removeDependency(e,t){const s=this.requests.get(e);if(void 0===s||void 0===s.dependsOn||0===s.dependsOn.length)return!1;if(void 0!==t){const e=s.dependsOn.indexOf(t);return-1!==e&&(s.dependsOn.splice(e,1),!0)}return delete s.dependsOn,!0}}r.requestLimit=20;class o{constructor(e){this.responses=new Map,this.update(e)}createResponseObject(e){const t=e.body,s={};if(s.status=e.status,void 0!==e.statusText&&(s.statusText=e.statusText),s.headers=e.headers,void 0!==s.headers&&void 0!==s.headers["Content-Type"]&&"application/json"===s.headers["Content-Type"].split(";")[0]){const e=JSON.stringify(t);return new Response(e,s)}return new Response(t,s)}update(e){this.nextLink=e["@odata.nextLink"];const t=e.responses;for(let e=0,s=t.length;e<s;e++)this.responses.set(t[e].id,this.createResponseObject(t[e]))}getResponseById(e){return this.responses.get(e)}getResponses(){return this.responses}*getResponsesIterator(){const e=this.responses.entries();let t=e.next();for(;!t.done;)yield t.value,t=e.next()}}const a=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class d extends Error{constructor(e){super(e),Object.setPrototypeOf(this,d.prototype)}static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new d,t.customError=e),t}}const l=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],u=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e},c=e=>p(e),h=(e,t)=>(t.forEach((e=>f(e))),p(e,t)),p=(e,t=a)=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const s=(e=e.replace("https://","")).indexOf(":"),n=e.indexOf("/");let i="";if(-1!==n)return-1!==s&&s<n?(i=e.substring(0,s),t.has(i)):(i=e.substring(0,n),t.has(i))}return!1},f=e=>{if(-1!==e.indexOf("/"))throw new d("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class m{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const y=()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},g=(e,t,s)=>{let n=null;if("undefined"!=typeof Request&&e instanceof Request)n=e.headers.get(s);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)n=t.headers.get(s);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,i=e.length;t<i;t++)if(e[t][0]===s){n=e[t][1];break}}else void 0!==t.headers[s]&&(n=t.headers[s]);return n},E=(e,t,s,n)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(s,n);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[s]:n});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(s,n);else if(t.headers instanceof Array){let e=0;const i=t.headers.length;for(;e<i;e++){const i=t.headers[e];if(i[0]===s){i[1]=n;break}}e===i&&t.headers.push([s,n])}else Object.assign(t.headers,{[s]:n})},v=(e,t,s,n)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(s,n):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[s]:n}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(s,n):t.headers instanceof Array?t.headers.push([s,n]):void 0===t.headers?t.headers={[s]:n}:void 0===t.headers[s]?t.headers[s]=n:t.headers[s]+=`, ${n}`)};class R{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var w;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(w||(w={}));class O{constructor(){this.featureUsage=w.NONE}static updateFeatureUsageFlag(e,t){let s;e.middlewareControl instanceof m?s=e.middlewareControl.getMiddlewareOptions(O):e.middlewareControl=new m,void 0===s&&(s=new O,e.middlewareControl.setMiddlewareOptions(O,s)),s.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class A{constructor(e){this.authenticationProvider=e}execute(e){return n(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(c(t)||e.customHosts&&h(t,e.customHosts)){let t,s,n;e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(R)),t&&(s=t.authenticationProvider,n=t.authenticationProviderOptions),s||(s=this.authenticationProvider);const i=`Bearer ${yield s.getAccessToken(n)}`;v(e.request,e.options,A.AUTHORIZATION_HEADER,i),O.updateFeatureUsageFlag(e,w.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[A.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}A.AUTHORIZATION_HEADER="Authorization";class T{execute(e){return n(this,void 0,void 0,(function*(){e.response=yield fetch(e.request,e.options)}))}}class x{constructor(e=x.DEFAULT_DELAY,t=x.DEFAULT_MAX_RETRIES,s=x.defaultShouldRetry){if(e>x.MAX_DELAY&&t>x.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${x.MAX_DELAY} and ${x.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>x.MAX_DELAY){const e=new Error(`Delay should not be more than ${x.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>x.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${x.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,x.MAX_DELAY),this.maxRetries=Math.min(t,x.MAX_MAX_RETRIES),this.shouldRetry=s}getMaxDelay(){return x.MAX_DELAY}}x.DEFAULT_DELAY=3,x.DEFAULT_MAX_RETRIES=3,x.MAX_DELAY=180,x.MAX_MAX_RETRIES=10,x.defaultShouldRetry=()=>!0;class b{constructor(e=new x){this.options=e}isRetry(e){return-1!==b.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const s="string"==typeof e?t.method:e.method;if(s===i.PUT||s===i.PATCH||s===i.POST){if("application/octet-stream"===g(e,t,"Content-Type"))return!1}return!0}getDelay(e,t,s){const n=()=>Number(Math.random().toFixed(3)),i=void 0!==e.headers?e.headers.get(b.RETRY_AFTER_HEADER):null;let r;return r=null!==i?Number.isNaN(Number(i))?Math.round((new Date(i).getTime()-Date.now())/1e3):Number(i):t>=2?this.getExponentialBackOffTime(t)+s+n():s+n(),Math.min(r,this.options.getMaxDelay()+n())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return n(this,void 0,void 0,(function*(){const t=1e3*e;return new Promise((e=>setTimeout(e,t)))}))}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new x,this.options)),t}executeWithRetry(e,t,s){return n(this,void 0,void 0,(function*(){if(yield this.nextMiddleware.execute(e),t<s.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&s.shouldRetry(s.delay,t,e.request,e.options,e.response)){++t,E(e.request,e.options,b.RETRY_ATTEMPT_HEADER,t.toString());const n=this.getDelay(e.response,t,s.delay);return yield this.sleep(n),yield this.executeWithRetry(e,t,s)}}))}execute(e){return n(this,void 0,void 0,(function*(){const t=this.getOptions(e);return O.updateFeatureUsageFlag(e,w.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,t)}))}setNext(e){this.nextMiddleware=e}}b.RETRY_STATUS_CODES=[429,503,504],b.RETRY_ATTEMPT_HEADER="Retry-Attempt",b.RETRY_AFTER_HEADER="Retry-After";class D{constructor(e=D.DEFAULT_MAX_REDIRECTS,t=D.defaultShouldRedirect){if(e>D.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${D.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}D.DEFAULT_MAX_REDIRECTS=5,D.MAX_MAX_REDIRECTS=20,D.defaultShouldRedirect=()=>!0;class C{constructor(e=new D){this.options=e}isRedirect(e){return-1!==C.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(C.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(C.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const s=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,n=s.exec(e);let i,r;null!==n&&(i=n[0]);const o=s.exec(t);return null!==o&&(r=o[0]),void 0!==i&&void 0!==r&&i!==r}updateRequestUrl(e,t){return n(this,void 0,void 0,(function*(){var s,i;t.request="string"==typeof t.request?e:yield(s=e,i=t.request,n(void 0,void 0,void 0,(function*(){const e=i.headers.get("Content-Type")?yield i.blob():yield Promise.resolve(void 0),{method:t,headers:n,referrer:r,referrerPolicy:o,mode:a,credentials:d,cache:l,redirect:u,integrity:c,keepalive:h,signal:p}=i;return new Request(s,{method:t,headers:n,body:e,referrer:r,referrerPolicy:o,mode:a,credentials:d,cache:l,redirect:u,integrity:c,keepalive:h,signal:p})})))}))}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(D)),void 0===t&&(t=Object.assign(new D,this.options)),t}executeWithRedirect(e,t,s){return n(this,void 0,void 0,(function*(){yield this.nextMiddleware.execute(e);const n=e.response;if(t<s.maxRedirects&&this.isRedirect(n)&&this.hasLocationHeader(n)&&s.shouldRedirect(n)){if(++t,n.status===C.STATUS_CODE_SEE_OTHER)e.options.method=i.GET,delete e.options.body;else{const t=this.getLocationHeader(n);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(n.url,t)&&delete e.options.headers[C.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,s)}}))}execute(e){return n(this,void 0,void 0,(function*(){const t=this.getOptions(e);return e.options.redirect=C.MANUAL_REDIRECT,O.updateFeatureUsageFlag(e,w.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,t)}))}setNext(e){this.nextMiddleware=e}}C.REDIRECT_STATUS_CODES=[301,302,303,307,308],C.STATUS_CODE_SEE_OTHER=303,C.LOCATION_HEADER="Location",C.AUTHORIZATION_HEADER="Authorization",C.MANUAL_REDIRECT="manual";class S{execute(e){return n(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(c(t)||e.customHosts&&h(t,e.customHosts)){let t=g(e.request,e.options,S.CLIENT_REQUEST_ID_HEADER);t||(t=y(),E(e.request,e.options,S.CLIENT_REQUEST_ID_HEADER,t));let s,n=`${S.PRODUCT_NAME}/3.0.2`;if(e.middlewareControl instanceof m&&(s=e.middlewareControl.getMiddlewareOptions(O)),s){const e=s.getFeatureUsage();n+=` (${S.FEATURE_USAGE_STRING}=${e})`}v(e.request,e.options,S.SDK_VERSION_HEADER,n)}else delete e.options.headers[S.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[S.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}S.CLIENT_REQUEST_ID_HEADER="client-request-id",S.SDK_VERSION_HEADER="SdkVersion",S.PRODUCT_NAME="graph-js",S.FEATURE_USAGE_STRING="featureUsage";class P{static getDefaultMiddlewareChain(e){const t=[],s=new A(e),n=new b(new x),i=new S,r=new T;if(t.push(s),t.push(n),"object"==typeof process){const e=new C(new D);t.push(e)}return t.push(i),t.push(r),t}}var M;!function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(M||(M={}));class U{constructor(e=M.RANDOM,t="Some error Happened",s,n,i,r){if(this.chaosStrategy=e,this.statusCode=s,this.statusMessage=t,this.chaosPercentage=void 0!==n?n:10,this.responseBody=i,this.headers=r,this.chaosPercentage>100)throw new Error("Error Pecentage can not be more than 100")}}const _={GET:[429,500,502,503,504],POST:[429,500,502,503,504,507],PUT:[429,500,502,503,504,507],PATCH:[429,500,502,503,504],DELETE:[429,500,502,503,504,507]},L={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};class N{constructor(e=new U,t){this.options=e,this.manualMap=t}createResponseHeaders(e,t,s){const n=e.headers?new Headers(e.headers):new Headers;return n.append("Cache-Control","no-store"),n.append("request-id",t),n.append("client-request-id",t),n.append("x-ms-ags-diagnostic",""),n.append("Date",s),n.append("Strict-Transport-Security",""),429===e.statusCode&&n.append("retry-after","3"),n}createResponseBody(e,t,s){if(e.responseBody)return e.responseBody;let n;if(e.statusCode>=400){n={error:{code:L[e.statusCode],message:e.statusMessage,innerError:{"request-id":t,date:s}}}}else n={};return n}createResponse(e,t){const s=t.request,n=y(),i=new Date,r=this.createResponseHeaders(e,n,i.toString()),o=this.createResponseBody(e,n,i.toString()),a={url:s,status:e.statusCode,statusText:e.statusMessage,headers:r};t.response=new Response("string"==typeof o?o:JSON.stringify(o),a)}sendRequest(e,t){return n(this,void 0,void 0,(function*(){this.setStatusCode(e,t.request,t.options.method),e.chaosStrategy===M.MANUAL&&!this.nextMiddleware||Math.floor(100*Math.random())<e.chaosPercentage?this.createResponse(e,t):this.nextMiddleware&&(yield this.nextMiddleware.execute(t))}))}getRandomStatusCode(e){const t=_[e];return t[Math.floor(Math.random()*t.length)]}getRelativeURL(e){const t=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let s;return null!==t.exec(e)&&(s=t.exec(e)[1]),s}setStatusCode(e,t,s){if(e.chaosStrategy===M.MANUAL){if(void 0===e.statusCode){const n=this.getRelativeURL(t);void 0!==this.manualMap.get(n)?void 0!==this.manualMap.get(n).get(s)&&(e.statusCode=this.manualMap.get(n).get(s)):this.manualMap.forEach(((t,i)=>{new RegExp(i+"$").test(n)&&void 0!==this.manualMap.get(i).get(s)&&(e.statusCode=this.manualMap.get(i).get(s))}))}}else e.statusCode=this.getRandomStatusCode(s)}getOptions(e){let t;return e.middlewareControl instanceof m&&(t=e.middlewareControl.getMiddlewareOptions(U)),void 0===t&&(t=Object.assign(new U,this.options)),t}execute(e){return n(this,void 0,void 0,(function*(){const t=this.getOptions(e);return yield this.sendRequest(t,e)}))}setNext(e){this.nextMiddleware=e}}var q,I,H,F;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(q||(q={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(I||(I={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(H||(H={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(F||(F={}));class k{static parseDocumentResponse(e,t){return"undefined"!=typeof DOMParser?new Promise(((s,n)=>{e.text().then((e=>{try{const n=(new DOMParser).parseFromString(e,t);s(n)}catch(e){n(e)}}))})):Promise.resolve(e.body)}static convertResponse(e,t){return n(this,void 0,void 0,(function*(){if(204===e.status)return Promise.resolve();let s;const n=e.headers.get("Content-type");switch(t){case q.ARRAYBUFFER:s=yield e.arrayBuffer();break;case q.BLOB:s=yield e.blob();break;case q.DOCUMENT:s=yield k.parseDocumentResponse(e,I.TEXT_XML);break;case q.JSON:s=yield e.json();break;case q.STREAM:s=yield Promise.resolve(e.body);break;case q.TEXT:s=yield e.text();break;default:if(null!==n){const t=n.split(";")[0];s=new RegExp(F.DOCUMENT).test(t)?yield k.parseDocumentResponse(e,t):new RegExp(F.IMAGE).test(t)?e.blob():t===H.TEXT_PLAIN?yield e.text():t===H.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else s=Promise.resolve(e.body)}return s}))}static getResponse(e,t,s){return n(this,void 0,void 0,(function*(){if(t===q.RAW)return Promise.resolve(e);{const n=yield k.convertResponse(e,t);if(!e.ok)throw n;if("function"!=typeof s)return n;s(null,n)}}))}}class B{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class ${constructor(e,t){this._location=t,this._responseBody=e}get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}static CreateUploadResult(e,t){return new $(e,t.get("location"))}}class j{constructor(e,t,s,n={}){if(this.DEFAULT_FILE_SIZE=5242880,this.client=e,!t.sliceFile)throw new d("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,this.file=t,n.rangeSize||(n.rangeSize=this.DEFAULT_FILE_SIZE),this.options=n,this.uploadSession=s,this.nextRange=new B(0,this.options.rangeSize-1)}static createUploadSession(e,t,s,i={}){return n(this,void 0,void 0,(function*(){const n=yield e.api(t).headers(i).post(s);return{url:n.uploadUrl,expiry:new Date(n.expirationDateTime),isCancelled:!1}}))}parseRange(e){const t=e[0];if(void 0===t||""===t)return new B;const s=t.split("-"),n=parseInt(s[0],10);let i=parseInt(s[1],10);return Number.isNaN(i)&&(i=this.file.size-1),new B(n,i)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new B(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new d("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return n(this,void 0,void 0,(function*(){const e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const t=this.getNextRange();if(-1===t.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const s=yield this.file.sliceFile(t),n=yield this.uploadSliceGetRawResponse(s,t,this.file.size);if(!n)throw new d("Something went wrong! Large file upload slice response is null.");const i=yield k.getResponse(n);if(201===n.status||200===n.status&&i.id){return $.CreateUploadResult(i,n.headers)}const r={expirationDateTime:i.expirationDateTime||i.ExpirationDateTime,nextExpectedRanges:i.NextExpectedRanges||i.nextExpectedRanges};this.updateTaskStatus(r),e&&e.progress&&e.progress(t,e.extraCallbackParam)}}))}uploadSlice(e,t,s){return n(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${s}`,"Content-Type":"application/octet-stream"}).put(e)}))}uploadSliceGetRawResponse(e,t,s){return n(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${s}`,"Content-Type":"application/octet-stream"}).responseType(q.RAW).put(e)}))}cancel(){return n(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).responseType(q.RAW).delete();return 204===e.status&&(this.uploadSession.isCancelled=!0),e}))}getStatus(){return n(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}))}resume(){return n(this,void 0,void 0,(function*(){return yield this.getStatus(),yield this.upload()}))}getUploadSession(){return this.uploadSession}}class Q{constructor(e,t,s){if(this.content=e,this.name=t,this.size=s,!e||!t||!s)throw new d("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}const V=(e=5242880)=>{const t=62914560;return e>t&&(e=t),(s=e)>327680&&(s=320*Math.floor(s/327680)*1024),s;var s};class X extends j{constructor(e,t,s,n){super(e,t,s,n)}static constructCreateSessionUrl(e,t=X.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map((e=>encodeURIComponent(e))).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let s,n;if("undefined"!=typeof Blob&&e instanceof Blob)s=new File([e],t),n=s.size;else if("undefined"!=typeof File&&e instanceof File)s=e,n=s.size;else if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array){const t=e;n=t.byteLength,s=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{content:s,size:n}}static create(e,t,s){return n(this,void 0,void 0,(function*(){if(!e||!t||!s)throw new d("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const n=s.fileName,i=X.getFileInfo(t,n),r=new Q(i.content,n,i.size);return this.createTaskWithFileObject(e,r,s)}))}static createTaskWithFileObject(e,t,s){return n(this,void 0,void 0,(function*(){if(!e||!t||!s)throw new d("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const n=X.constructCreateSessionUrl(s.fileName,s.path),i={fileName:s.fileName,fileDescription:s.fileDescription,conflictBehavior:s.conflictBehavior},r=yield X.createUploadSession(e,n,i),o=V(s.rangeSize);return new X(e,t,r,{rangeSize:o,uploadEventHandlers:s.uploadEventHandlers})}))}static createUploadSession(e,t,s){const i=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return n(this,void 0,void 0,(function*(){const n={item:{"@microsoft.graph.conflictBehavior":(null==s?void 0:s.conflictBehavior)||"rename",name:null==s?void 0:s.fileName,description:null==s?void 0:s.fileDescription}};return i.createUploadSession.call(this,e,t,n)}))}commit(e,t="rename"){return n(this,void 0,void 0,(function*(){const s={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(s)}))}}X.DEFAULT_UPLOAD_PATH="/";class z{constructor(e,t,s){if(this.content=e,this.name=t,this.size=s,!e||!t||!s)throw new d("Please provide the Readable Stream content, name of the file and size of the file")}sliceFile(e){return n(this,void 0,void 0,(function*(){let t=e.maxValue-e.minValue+1;const s=[];if(this.previousSlice){if(e.minValue<this.previousSlice.range.minValue)throw new d("An error occurred while uploading the stream. Please restart the stream upload from the first byte of the file.");if(e.minValue<this.previousSlice.range.maxValue){const n=this.previousSlice.range.minValue,i=this.previousSlice.range.maxValue;if(e.minValue===n&&e.maxValue===i)return this.previousSlice.fileSlice;if(e.maxValue===i)return this.previousSlice.fileSlice.slice(e.minValue,e.maxValue+1);s.push(this.previousSlice.fileSlice.slice(e.minValue,i+1)),t=e.maxValue-i}}if(!this.content||!this.content.readable)throw new d("Stream is not readable.");this.content.readableLength>=t?s.push(this.content.read(t)):s.push(yield this.readNBytesFromStream(t));const n=Buffer.concat(s);return this.previousSlice={fileSlice:n,range:e},n}))}readNBytesFromStream(e){return new Promise(((t,s)=>{const n=[];let i=e,r=0;this.content.on("end",(()=>{if(i>0)return s(new d("Stream ended before reading required range size"))})),this.content.on("readable",(()=>{let o;for(;r<e&&null!==(o=this.content.read(i));)r+=o.length,n.push(o),i>0&&(i=e-r);return r===e?t(Buffer.concat(n)):this.content&&this.content.readable?void 0:s(new d("Error encountered while reading the stream during the upload"))}))}))}}class G{constructor(e,t,s,n){this.client=e,this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"],this.callback=s,this.complete=!1,this.requestOptions=n}iterationHelper(){if(void 0===this.collection)return!1;let e=!0;for(;e&&0!==this.collection.length;){const t=this.collection.shift();e=this.callback(t)}return e}fetchAndUpdateNextPageData(){return n(this,void 0,void 0,(function*(){let e=this.client.api(this.nextLink);this.requestOptions&&(this.requestOptions.headers&&(e=e.headers(this.requestOptions.headers)),this.requestOptions.middlewareOptions&&(e=e.middlewareOptions(this.requestOptions.middlewareOptions)),this.requestOptions.options&&(e=e.options(this.requestOptions.options)));const t=yield e.get();this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"]}))}getDeltaLink(){return this.deltaLink}iterate(){return n(this,void 0,void 0,(function*(){let e=this.iterationHelper();for(;e;)void 0!==this.nextLink?(yield this.fetchAndUpdateNextPageData(),e=this.iterationHelper()):e=!1;void 0===this.nextLink&&0===this.collection.length&&(this.complete=!0)}))}resume(){return n(this,void 0,void 0,(function*(){return this.iterate()}))}isComplete(){return this.complete}}class W{constructor(e){this.provider=e}getAccessToken(){return n(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.provider(((s,i)=>n(this,void 0,void 0,(function*(){if(i)e(i);else{if(!s){s=new d("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")}const e=yield d.setGraphClientError(s);t(e)}}))))}))}))}}class Y extends Error{constructor(e=-1,t,s){super(t||s&&s.message),Object.setPrototypeOf(this,Y.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=s?s.stack:this.stack}}class J{static constructError(e,t){const s=new Y(t,"",e);return void 0!==e.name&&(s.code=e.name),s.body=e.toString(),s.date=new Date,s}static constructErrorFromResponse(e,t){const s=e.error,n=new Y(t,s.message);return n.code=s.code,void 0!==s.innerError&&(n.requestId=s.innerError["request-id"],n.date=new Date(s.innerError.date)),n.body=JSON.stringify(s),n}static getError(e=null,t=-1,s){return n(this,void 0,void 0,(function*(){let n;if(e&&e.error?n=J.constructErrorFromResponse(e,t):e instanceof Error?n=J.constructError(e,t):(n=new Y(t),n.body=e),"function"!=typeof s)return n;s(n,null)}))}}class Z{constructor(e,t,s){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const s=e.indexOf("/");-1!==s&&(this.urlComponents.version=e.substring(0,s),e=e.substring(s+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const s=e.substring(t+1,e.length).split("&");for(const e of s)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(s)}addCsvQueryParameter(e,t,s){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let n=[];s.length>1&&"string"==typeof t?n=Array.prototype.slice.call(s):"string"==typeof t?n.push(t):n=n.concat(t),this.urlComponents.oDataQueryParams[e]+=n.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce(((e,s)=>{return[(n=e,n.replace(/\/+$/,"")),t(s)].join("/");var n}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const s in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,s)&&t.push(s+"="+e.oDataQueryParams[s]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const s in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,s)&&t.push(s+"="+e.otherURLQueryParams[s]);if(0!==e.otherURLQueryOptions.length)for(const s of e.otherURLQueryOptions)t.push(s);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),s=e.substring(0,t),n=e.substring(t+1);this.setURLComponentsQueryParamater(s,n)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==l.indexOf(e)){const s=this.urlComponents.oDataQueryParams[e],n=s&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=n?s+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");if(-1===t)return!1;return!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,s){var i;return n(this,void 0,void 0,(function*(){let n;const r=new m(this._middlewareOptions);this.updateRequestOptions(t);const o=null===(i=this.config)||void 0===i?void 0:i.customHosts;try{n=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:r,customHosts:o})).response;return yield k.getResponse(n,this._responseType,s)}catch(e){if(e instanceof d)throw e;let t;n&&(t=n.status);throw yield J.getError(e,t,s)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return n(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),s={method:i.GET};return yield this.send(t,s,e)}))}post(e,t){return n(this,void 0,void 0,(function*(){const s=this.buildFullUrl(),n={method:i.POST,body:u(e)};return"FormData"===(e&&e.constructor&&e.constructor.name)?n.headers={}:(this.setHeaderContentType(),n.headers=this._headers),yield this.send(s,n,t)}))}create(e,t){return n(this,void 0,void 0,(function*(){return yield this.post(e,t)}))}put(e,t){return n(this,void 0,void 0,(function*(){const s=this.buildFullUrl();this.setHeaderContentType();const n={method:i.PUT,body:u(e)};return yield this.send(s,n,t)}))}patch(e,t){return n(this,void 0,void 0,(function*(){const s=this.buildFullUrl();this.setHeaderContentType();const n={method:i.PATCH,body:u(e)};return yield this.send(s,n,t)}))}update(e,t){return n(this,void 0,void 0,(function*(){return yield this.patch(e,t)}))}delete(e){return n(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),s={method:i.DELETE};return yield this.send(t,s,e)}))}del(e){return n(this,void 0,void 0,(function*(){return yield this.delete(e)}))}getStream(e){return n(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),s={method:i.GET};return this.responseType(q.STREAM),yield this.send(t,s,e)}))}putStream(e,t){return n(this,void 0,void 0,(function*(){const s=this.buildFullUrl(),n={method:i.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(s,n,t)}))}}class K{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach(((t,s)=>{s<e.length-1&&t.setNext(e[s+1])})),this.middleware=e[0]}sendRequest(e){return n(this,void 0,void 0,(function*(){if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}))}}class ee{static createWithAuthenticationProvider(e){const t=new A(e),s=new b(new x),n=new S,i=new T;if(t.setNext(s),"object"==typeof process){const e=new C(new D);s.setNext(e),e.setNext(n)}else s.setNext(n);return n.setNext(i),ee.createWithMiddleware(t)}static createWithMiddleware(...e){return new K(...e)}}class te{constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})();for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=ee.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new K(...[].concat(e.middleware))}this.httpClient=t}static init(e){const t={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]="authProvider"===s?new W(e[s]):e[s]);return te.initWithMiddleware(t)}static initWithMiddleware(e){return new te(e)}api(e){return new Z(this.httpClient,this.config,e)}}}}]);